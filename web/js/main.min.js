$(function(){function b(){var a,b,c=window.location;"replaceState"in history?history.replaceState("",document.title,c.pathname+c.search):(a=document.body.scrollTop,b=document.body.scrollLeft,c.hash="",document.body.scrollTop=a,document.body.scrollLeft=b)}function h(){for(var a="",b="1234ABCDEFGHIJKLMNOPQRSTUVWXY567890Zabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<6;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function l(){var a=Math.random();return Math.floor(1e5*a+200)}function n(){var a=window.location.href;return a+=a.indexOf("?")===-1?"?":"&",a+="page="+inifi_page,inifi_called||(inifi_called=!0,$(".inifi").append(htmlloading),$.ajax({url:a,type:"GET",dataType:"JSON",success:function(a){inifi_total=Math.ceil(a.total/a.PageSize),$("#loadingi").fadeOut(),$(".inifi").append(a.html),$("#loadingi").remove(),inifi_called=!1,inifi_page++}})),!1}"#_=_"!=location.hash&&"#_=_"!=location.href.slice(-1)||b(),$(".menu-category > li").on({mouseenter:function(){$(this).find(".supdropdown").addClass("submenu-active")},mouseleave:function(){$(this).find(".supdropdown").removeClass("submenu-active")}});$(".showhide").on("click",function(a){var b=$(this).data().element;$(".mainmenu").each(function(a,c){console.log(b),console.log($(c).data().element),$(c).data().element!=b&&$("#"+$(c).data().element).hide()}),$("#"+b).toggle()}),$(".changeLang").on("click",function(a){var b="userlanghangshare",c=location.pathname.split("/"),d=" path=";document.cookie=b+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT;";for(var e=0;e<c.length;e++)d+=("/"!=d.substr(-1)?"/":"")+c[e],document.cookie=b+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT;"+d+";"});var c=$("#w0").offset().top,d=$(".stiky"),e=$("#1a");if(e.length>0)var e=$("#1a").offset().top;if($(window).scroll(function(){$(window).scrollTop()>c+150?$(".scroll-header").fadeIn():$(".scroll-header").fadeOut(),e.length>0&&(d.length>0&&$(window).scrollTop()>e+92?d.attr({style:"position:fixed;top:40px;"}):d.length>0&&$(window).scrollTop()<e+85&&d.attr({style:"position:absolute;top:auto;"}))}),$.isFunction($.fn.editable)){var f={inlineMode:!1,toolbarFixed:!0,mediaManager:!1,language:$.Yii.getLang(),imageUploadURL:"/explore/upload/",minHeight:200,maxHeight:800};"ar"===$.Yii.getLang()&&(f.direction="rtl"),console.log(f),$(".froala-edit").editable(f)}input=document.getElementById("post-cover_file"),input&&(input.onchange=function(){if(textinpt=document.getElementById("uploadFile"),textinpt&&(textinpt.value=this.value),input.files&&input.files[0]){var a=new FileReader;a.onload=function(a){$("#coveri").attr("src",a.target.result)},a.readAsDataURL(input.files[0])}}),input=document.getElementById("goldtime"),input&&(input.onchange=function(){"b"===this.value?($("#planb").show(),$("#planc").hide()):"c"===this.value&&($("#planb").hide(),$("#planc").show())}),fixad=$("#fixad, .fixad"),fixad.length>0&&$(window).scroll(function(){value=fixad.attr("rel"),$(window).scrollTop()+$(window).height()>value?fixad.css({position:"fixed",top:"0"}):fixad.css({position:"inherit",top:"0"})});var g=$("#faqsearch");g.length>0&&$.getScript("https://cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.js",function(){g.ajaxForm({beforeSend:function(){},success:function(a){$("#content").html($(a).find("#content"))},complete:function(a){}})});var i=$("#uploadform");if(i.length>0){$(document).on("click","#uploadtos3",function(a){a.preventDefault(),$("#files3").click()});var j;$.ajax({url:"/explore/s3crd/",type:"POST",dataType:"JSON",data:{},success:function(a){j=a}});var k=window.URL;$("#files3").change(function(){var a,b,c,d,e=$("#type").val();if(a=this.files[0]){b=new Image,b.onload=function(){c=this.width,d=this.height},b.src=k.createObjectURL(a),folderName=h(),formData=new FormData,formData.append("key",folderName+"/"+a.name),formData.append("acl",j.inputs.acl),formData.append("success_action_status",j.inputs.success_action_status),formData.append("Content-Type",a.type),formData.append("policy",j.inputs.policy),formData.append("X-amz-credential",j.inputs.X_amz_credential),formData.append("X-amz-algorithm",j.inputs.X_amz_algorithm),formData.append("X-amz-date",j.inputs.X_amz_date),formData.append("X-amz-expires",j.inputs.X_amz_expires),formData.append("X-amz-signature",j.inputs.X_amz_signature),formData.append("file",a),$("#prev").fadeIn(),$.ajax({url:j.url,type:"POST",data:formData,crossDomain:!0,contentType:!1,processData:!1,dataType:"XML",success:function(a,b,f){var g=f.responseXML.getElementsByTagName("PostResponse")[0].childNodes[1].firstChild.nodeValue,h=f.responseXML.getElementsByTagName("PostResponse")[0].childNodes[2].firstChild.nodeValue;"success"===b&&($("#cover_input").val('{"bucket":"'+g+'", "key":"'+h+'", "width": "'+c+'", "height" : "'+d+'"}'),$.ajax({url:"/explore/resize/",method:"POST",dataType:"json",data:{bucket:g,key:h,type:e},complete:function(){$("#prev").hide()}}))}});var f=new FileReader;f.onload=function(a){$("#coveri").attr("src",a.target.result)},f.readAsDataURL(this.files[0])}})}if($("#user-country").length&&(rel_c=$("#user-country").attr("rel"),"autoload"===rel_c&&$.ajax({url:"/user/getcountry/",method:"POST",dataType:"json",success:function(a){$("#user-country").val(a.id)}})),$(document).on("click","#main-post",function(a){if(""===$("#post-ylink").val()&&""===$("#cover_input").val()&&""===$("#covercheck").val()){a.preventDefault();var b=$("html, body");b.stop().animate({scrollTop:0},"500","swing",function(){$("#cover_error").fadeIn(1e3)})}}),$(document).on("submit","#add-post",function(a){if($(".has-error").length>0);else{$(this).prop("disabled",!0);var b=$.Yii.t("Please Wait");$("body").append("<div class='black_overlay'></div><div class='white_content'>"+b+"</div>")}}),$(document).on("click",".js_passch",function(a){a.preventDefault();var b=$("#user-password_old").val(),c=$("#user-password_new").val(),d=$("#user-password_re").val(),e=$.Yii.t("Confirm password is identical to the password");return d!==c?void alert(e):void $.ajax({url:"changepass",method:"POST",dataType:"json",data:{password:c,old:b},success:function(a){a.status===!1?alert($.Yii.t("The current password is incorrect")):(alert($.Yii.t("Password has been changed successfully")),$(".modal").modal("hide"))}})}),$(document).on("click",".js-share",function(a){a.preventDefault();var b=document.title,c=document.URL,d=$(this).attr("post-url");d.length&&(c=d),$(this).hasClass("js-share-twitter")?popup_url="http://twitter.com/intent/tweet?text="+b+" @hang_share "+c:$(this).hasClass("js-share-fasebook")?popup_url="https://www.facebook.com/sharer/sharer.php?u="+c:$(this).hasClass("js-share-gpuls")&&(popup_url='https://plus.google.com/share?url="'+c+'"');var e=window.open(popup_url,"popupwindow","scrollbars=yes,width=600,height=400");e.focus()}),$(document).on("click",".showclick",function(a){a.preventDefault();var b=$(this).attr("id");$("[id$='_form']").hide(),$(".showclick").removeClass("btn-warning"),$(".showclick").addClass("btn-default"),$(this).removeClass("btn-warning"),$(this).addClass("btn-warning"),$("#"+b+"_form").show()}),$("#scroll-fixed-top").length>0&&$(window).scroll(function(){$(window).scrollTop()>150?$("#scroll-fixed-top").css({top:"60px"}):$("#scroll-fixed-top").css({top:"auto"})}),$("#slide-signup").length>0&&$(window).scroll(function(){$(window).scrollTop()>100?$("#slide-signup").css({bottom:"0px"}):$("#slide-signup").css({bottom:"-300px"})}),$("article").length>0){var m=$("article").data();$.ajax({method:"POST",url:"/explore/countcheck/?qt="+l(),data:m})}if($("#hot-posts").length>0){var m=$("article").data();$.ajax({method:"POST",url:"/explore/hot/?qt="+l(),data:m,success:function(a,b,c){$("#hot-posts").append(a)}})}if($("#related-posts").length>0){var m=$("article").data();$.ajax({method:"POST",url:"/explore/related/?qt="+l(),data:m,success:function(a,b,c){$("#related-posts").append(a)}})}inifi=$(".inifi"),inifi.length&&(inifi_page=2,inifi_total=2,inifi_called=!1,htmlloading='<div id="loadingi"><i style="display: block;font-size: 66px;left: 47%;margin: 0 auto 50px;position: relative;text-align: center;top: 18px;" class="fa fa-spinner fa-pulse"></i></div>',$(window).scroll(function(){if($(window).scrollTop()+$(window).height()>$(document).height()-200){if(inifi_page>inifi_total)return!1;n()}}));var o={setting:{startline:100,scrollto:0,scrollduration:1e3,fadeduration:[500,100]},controlHTML:'<i class="fa fa-chevron-up backtotop"></i>',controlattrs:{offsetx:5,offsety:5},anchorkeyword:"#top",state:{isvisible:!1,shouldvisible:!1},scrollup:function(){this.cssfixedsupport||this.$control.css({opacity:0});var a=isNaN(this.setting.scrollto)?this.setting.scrollto:parseInt(this.setting.scrollto);a="string"==typeof a&&1==jQuery("#"+a).length?jQuery("#"+a).offset().top:0,this.$body.animate({scrollTop:a},this.setting.scrollduration)},keepfixed:function(){var a=jQuery(window),b=a.scrollLeft()+a.width()-this.$control.width()-this.controlattrs.offsetx,c=a.scrollTop()+a.height()-this.$control.height()-this.controlattrs.offsety;this.$control.css({left:b+"px",top:c+"px"})},togglecontrol:function(){var a=jQuery(window).scrollTop();this.cssfixedsupport||this.keepfixed(),this.state.shouldvisible=a>=this.setting.startline,this.state.shouldvisible&&!this.state.isvisible?(this.$control.stop().animate({opacity:1},this.setting.fadeduration[0]),this.state.isvisible=!0):0==this.state.shouldvisible&&this.state.isvisible&&(this.$control.stop().animate({opacity:0},this.setting.fadeduration[1]),this.state.isvisible=!1)},init:function(){jQuery(document).ready(function(a){var b=o,c=document.all;b.cssfixedsupport=!c||c&&"CSS1Compat"==document.compatMode&&window.XMLHttpRequest,b.$body=a(window.opera?"CSS1Compat"==document.compatMode?"html":"body":"html,body"),b.$control=a('<div id="topcontrol">'+b.controlHTML+"</div>").css({position:b.cssfixedsupport?"fixed":"absolute",bottom:b.controlattrs.offsety,left:b.controlattrs.offsetx,opacity:0,cursor:"pointer"}).attr({title:"Scroll Back to Top"}).click(function(){return b.scrollup(),!1}).appendTo("body"),document.all&&!window.XMLHttpRequest&&""!=b.$control.text()&&b.$control.css({width:b.$control.width()}),b.togglecontrol(),a('a[href="'+b.anchorkeyword+'"]').click(function(){return b.scrollup(),!1}),a(window).bind("scroll resize",function(a){b.togglecontrol()})})}};o.init()});