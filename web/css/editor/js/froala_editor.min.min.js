/*!
 * froala_editor v1.2.4 (http://editor.froala.com)
 * Copyright 2014-2014 Froala
 */
if("undefined"==typeof jQuery){throw new Error("Froala requires jQuery")}!function(e){var d=function(b,a){this.options=e.extend({},d.DEFAULTS,e(b).data(),"object"==typeof a&&a),this.valid_nodes=e.merge([],d.VALID_NODES),this.valid_nodes=e.merge(this.valid_nodes,e.map(Object.keys(this.options.blockTags),function(c){return c.toUpperCase()})),this.browser=d.browser(),this.disabledList=[],this._id=++d.count,this._events={},this.blurred=!0,this.$window=e(window),this.$document=e(document),this.$original_element=e(b),this.init(b),e(b).on("editable.focus",e.proxy(function(){for(var c=1;c<=e.Editable.count;c++){c!=this._id&&e(window).trigger("blur."+c)}},this))};d.initializers=[],d.count=0,d.VALID_NODES=["P","DIV","LI","TD","TH"],d.LANGS=[],d.DEFAULTS={allowedAttrs:["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","width","wrap"],allowedTags:["!--","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],alwaysBlank:!1,alwaysVisible:!1,autosave:!1,autosaveInterval:10000,beautifyCode:!0,blockTags:{n:"Normal",blockquote:"Quote",pre:"Code",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},buttons:["bold","italic","underline","strikeThrough","fontSize","fontFamily","color","sep","formatBlock","blockStyle","align","insertOrderedList","insertUnorderedList","outdent","indent","sep","createLink","insertImage","insertVideo","insertHorizontalRule","undo","redo","html"],crossDomain:!0,convertMailAddresses:!0,customButtons:{},customDropdowns:{},customText:!1,direction:"ltr",disableRightClick:!1,editInPopup:!1,editorClass:"",formatTags:["p","pre","blockquote","h1","h2","h3","h4","h5","h6","div","ul","ol","li","table","tbody","thead","tfoot","tr","th","td"],headers:{},height:"auto",icons:{},inlineMode:!0,initOnClick:!1,language:"en_us",linkList:[],linkText:!1,linkClasses:{},maxHeight:"auto",minHeight:"auto",noFollow:!0,paragraphy:!0,placeholder:"Type something",plainPaste:!1,preloaderSrc:"",saveURL:null,saveParams:{},saveRequestType:"POST",simpleAmpersand:!1,shortcuts:!0,shortcutsAvailable:["show","bold","italic","underline","createLink","insertImage","selectAll","indent","outdent","html","formatBlock n","formatBlock h1","formatBlock h2","formatBlock h3","formatBlock h4","formatBlock h5","formatBlock h6","formatBlock blockquote","formatBlock pre","strikeThrough"],spellcheck:!1,theme:null,toolbarFixed:!0,trackScroll:!1,unlinkButton:!0,tabSpaces:!0,typingTimer:500,pastedImagesUploadRequestType:"POST",pastedImagesUploadURL:"http://i.froala.com/upload_base64",width:"auto",withCredentials:!1,zIndex:2000},d.prototype.destroy=function(){this.sync(),this.addFrTag(),this.hide(),this.isHTML&&this.html(),this.$bttn_wrapper&&this.$bttn_wrapper.html("").removeData().remove(),this.$editor&&this.$editor.html("").removeData().remove(),this.raiseEvent("destroy"),this.$popup_editor&&this.$popup_editor.html("").removeData().remove(),this.$placeholder&&this.$placeholder.html("").removeData().remove(),clearTimeout(this.ajaxInterval),clearTimeout(this.typingTimer),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop"),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop","**"),e(window).off("mouseup."+this._id),e(window).off("keydown."+this._id),e(window).off("keyup."+this._id),e(window).off("blur."+this._id),e(window).off("hide."+this._id),e(window).off("scroll."+this._id),e(window).off("orientationchange."+this._id),e(document).off("selectionchange."+this._id),this.$original_element.off("editable"),void 0!==this.$upload_frame&&this.$upload_frame.remove(),this.$textarea&&(this.$box.remove(),this.$textarea.removeData("fa.editable"),this.$textarea.show());for(var a in this._events){delete this._events[a]}this.$placeholder&&this.$placeholder.remove(),this.isLink?this.$element.removeData("fa.editable"):(this.$wrapper?this.$wrapper.replaceWith(this.getHTML()):this.$element.replaceWith(this.getHTML()),this.$box&&!this.editableDisabled&&(this.$box.removeClass("froala-box"),this.$box.find(".html-switch").remove(),this.$box.removeData("fa.editable"),clearTimeout(this.typingTimer)))},d.prototype.triggerEvent=function(a,j,i,h){void 0===i&&(i=!0),void 0===h&&(h=!1),i===!0&&(this.isResizing()||this.editableDisabled||this.imageMode||!h||this.cleanify(),this.sync());var g=!0;return j||(j=[]),g=this.$original_element.triggerHandler("editable."+a,e.merge([this],j)),void 0===g?!0:g},d.prototype.syncCleanHTML=function(h,g){var i;if(g){for(i=h.replace(/<span((?!class\s*=\s*["']?f-marker["']?)[^>])*?><\/span>/gi,"");h!=i;){h=i,i=h.replace(/<span((?!class\s*=\s*["']?f-marker["']?)[^>])*?><\/span>/gi,"")}}else{for(i=h.replace(/<span[^>]*?><\/span>/g,"");h!=i;){h=i,i=h.replace(/<span[^>]*?><\/span>/g,"")}}return h},d.prototype.syncClean=function(a,l){var k="span:empty";l&&(k="span:empty:not(.f-marker)");for(var j=!1,i=function(g,m){0===m.attributes.length&&(e(m).remove(),j=!1)},h=a.find(k);h.length&&j===!1;){j=!0,h.each(i),h=a.find(k)}},d.prototype.sync=function(){if(!this.isHTML){this.raiseEvent("sync"),this.disableImageResize(),this.isLink||this.isImage||this.$element.trigger("placeholderCheck");var b=this.getHTML();this.trackHTML!==b&&null!=this.trackHTML?(this.refreshImageList(),this.refreshButtons(),this.cleanupLists(),this.trackHTML=b,this.$textarea&&this.$textarea.val(this.getHTML(!1,!0)),this.doingRedo||this.saveUndoStep(),this.triggerEvent("contentChanged",[],!1)):null==this.trackHTML&&(this.trackHTML=b)}},d.prototype.emptyElement=function(a){if("IMG"==a.tagName||e(a).find("img").length>0){return !1}if(e(a).find("input, iframe").length>0){return !1}for(var h=e(a).text(),g=0;g<h.length;g++){if("\n"!==h[g]&&"\r"!==h[g]&&"	"!==h[g]){return !1}}return !0},d.prototype.initEvents=function(){this.mobile()?(this.mousedown="touchstart",this.mouseup="touchend",this.move="touchmove"):(this.mousedown="mousedown",this.mouseup="mouseup",this.move="")},d.prototype.continueInit=function(){this.initEvents(),this.browserFixes(),this.editableDisabled||(this.initUndoRedo(),this.enableTyping(),this.initShortcuts()),this.initTabs(),this.initEditor();for(var a=0;a<e.Editable.initializers.length;a++){e.Editable.initializers[a].call(this)}this.initOptions(),this.initEditorSelection(),this.initAjaxSaver(),this.setLanguage(),this.setCustomText(),this.editableDisabled||this.registerPaste(),this.refreshDisabledState(),this.initialized=!0,this.triggerEvent("initialized",[],!1,!1)},d.prototype.lateInit=function(){this.saveSelectionByMarkers(),this.continueInit(),this.restoreSelectionByMarkers(),this.$element.focus(),this.hideOtherEditors()},d.prototype.init=function(a){this.initElement(a),this.initElementStyle(),(!this.isLink||this.isImage)&&(this.initImageEvents(),this.buildImageMove()),this.options.initOnClick?(this.editableDisabled||(this.$element.attr("contenteditable",!0),this.$element.attr("spellcheck",!1)),this.$element.bind("mousedown.element",e.proxy(function(b){this.isLink||b.stopPropagation(),this.$element.unbind("mousedown.element"),this.lateInit()},this))):this.continueInit()},d.prototype.phone=function(){var b=!1;return function(a){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(b=!0)}(navigator.userAgent||navigator.vendor||window.opera),b},d.prototype.mobile=function(){return this.phone()||this.android()||this.iOS()||this.blackberry()},d.prototype.iOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},d.prototype.iOSVersion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var g=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),c=[parseInt(g[1],10),parseInt(g[2],10),parseInt(g[3]||0,10)];if(c&&c[0]){return c[0]}}return 0},d.prototype.iPad=function(){return/(iPad)/g.test(navigator.userAgent)},d.prototype.iPhone=function(){return/(iPhone)/g.test(navigator.userAgent)},d.prototype.iPod=function(){return/(iPod)/g.test(navigator.userAgent)},d.prototype.android=function(){return/(Android)/g.test(navigator.userAgent)},d.prototype.blackberry=function(){return/(Blackberry)/g.test(navigator.userAgent)},d.prototype.initOnTextarea=function(a){this.$textarea=e(a),void 0!==this.$textarea.attr("placeholder")&&"Type something"==this.options.placeholder&&(this.options.placeholder=this.$textarea.attr("placeholder")),this.$element=e("<div>").html(this.$textarea.val()),this.$textarea.before(this.$element).hide(),this.$textarea.parents("form").bind("submit",e.proxy(function(){this.isHTML?this.html():this.sync()},this))},d.prototype.initOnLink=function(a){this.isLink=!0,this.options.linkText=!0,this.selectionDisabled=!0,this.editableDisabled=!0,this.options.buttons=[],this.$element=e(a),this.options.paragraphy=!1,this.options.countCharacters=!1,this.$box=this.$element},d.prototype.initOnImage=function(a){var g=e(a).css("float");"A"==e(a).parent().get(0).tagName&&(a=e(a).parent()),this.isImage=!0,this.editableDisabled=!0,this.imageList=[],this.options.buttons=[],this.options.paragraphy=!1,this.options.imageMargin="auto",e(a).wrap("<div>"),this.$element=e(a).parent(),this.$element.css("display","inline-block"),this.$element.css("max-width","100%"),this.$element.css("margin-left","auto"),this.$element.css("margin-right","auto"),this.$element.css("float",g),this.$element.addClass("f-image"),this.$box=e(a)},d.prototype.initForPopup=function(a){this.$element=e(a),this.$box=this.$element,this.editableDisabled=!0,this.options.countCharacters=!1,this.options.buttons=[],this.$element.on("click",e.proxy(function(b){b.preventDefault()},this))},d.prototype.initOnDefault=function(a){"DIV"!=a.tagName&&this.options.buttons.indexOf("formatBlock")>=0&&this.disabledList.push("formatBlock"),this.$element=e(a)},d.prototype.initElement=function(a){"TEXTAREA"==a.tagName?this.initOnTextarea(a):"A"==a.tagName?this.initOnLink(a):"IMG"==a.tagName?this.initOnImage(a):this.options.editInPopup?this.initForPopup(a):this.initOnDefault(a),this.editableDisabled||(this.$box=this.$element.addClass("froala-box"),this.$wrapper=e('<div class="froala-wrapper">'),this.$element=e("<div>"),this.setHTML(this.$box.html(),!1),this.$box.html(this.$wrapper.html(this.$element)),this.$element.on("keyup",e.proxy(function(g){var c=g.which;13==c&&this.webkitParagraphy()},this))),this.$element.on("drop",e.proxy(function(){setTimeout(e.proxy(function(){e("html").click(),this.$element.find(".f-img-wrap").each(function(g,h){0===e(h).find("img").length&&e(h).remove()}),this.$element.find("p:empty").remove()},this),1)},this)),this.sync()},d.prototype.webkitParagraphy=function(){this.$element.find("*").each(e.proxy(function(a,h){if(this.emptyElement(h)&&"DIV"===h.tagName&&void 0===e(h).attr("class")&&this.options.paragraphy===!0){var g=e("<p><br/></p>");e(h).replaceWith(g),this.setSelection(g.get(0))}},this))},d.prototype.trim=function(b){return String(b).replace(/^\s+|\s+$/g,"")},d.prototype.unwrapText=function(){this.options.paragraphy||this.$element.find("div").each(function(a,g){void 0===e(g).attr("style")&&e(g).replaceWith(e(g).html()+"<br/>&#8203;")})},d.prototype.wrapTextInElement=function(a,p){void 0===p&&(p=!1);var o=[],n=["SPAN","A","B","I","EM","U","S","STRONG","STRIKE","FONT","IMG","SUB","SUP"],m=this;this.no_verify=!0;var l=function(){if(0===o.length){return !1}var h;h=e(m.options.paragraphy===!0?"<p>":"<div>");var r=e(o[0]);if(1==o.length&&"f-marker"==r.attr("class")){return void (o=[])}for(var q=0;q<o.length;q++){var i=e(o[q]);h.append(i.clone()),q==o.length-1?i.replaceWith(h):i.remove()}o=[]},k=!1,j=!1;a.contents().filter(function(){var c=e(this);if(c.hasClass("f-marker")||c.find(".f-marker").length){var g=c;c.find(".f-marker").length&&(g=e(c.find(".f-marker")[0])),"true"===g.attr("data-type")?(k=!0,j=!1):j=!0}this.nodeType==Node.TEXT_NODE&&c.text().trim().length>0||n.indexOf(this.tagName)>=0?o.push(this):this.nodeType==Node.TEXT_NODE&&0===c.text().trim().length&&m.options.beautifyCode?c.remove():(k||p?(l(),"BR"===this.tagName&&c.remove()):o=[],j&&(k=!1))}),(k||p)&&l(),a.find("> p").each(function(g,h){0===e(h).text().trim().length&&0===e(h).find("img").length&&0===e(h).find("br").length&&e(h).append("<br/>")}),a.find("div:empty:not([class])").remove(),a.is(":empty")&&a.append(m.options.paragraphy===!0?"<p><br/></p>":"<br/>"),this.no_verify=!1},d.prototype.wrapText=function(b){return this.isImage||this.isLink?!1:(this.webkitParagraphy(),void this.wrapTextInElement(this.$element,b))},d.prototype.setHTML=function(a,g){this.no_verify=!0,void 0===g&&(g=!0),a=this.clean(a,!0,!1),a=a.replace(/>\s+</g,"><"),this.$element.html(a),this.$element.find("pre").each(function(h,k){var j=e(k),i=e(k).html();i.indexOf("\n")>=0&&j.html(i.replace(/\n/g,"<br>"))}),this.imageList=[],this.refreshImageList(),this.options.paragraphy&&this.wrapText(!0),g&&(this.restoreSelectionByMarkers(),this.sync()),this.cleanupLists(),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1},d.prototype.beforePaste=function(){this.saveSelectionByMarkers(),this.clipboardHTML=null,this.scrollPosition=e(window).scrollTop(),this.$pasteDiv=e('<div contenteditable="true" style="position: fixed; top: 0; left: -9999px; height: 100%; width: 0; z-index: 99999;"></div>').appendTo("body"),this.$pasteDiv.focus(),window.setTimeout(e.proxy(this.processPaste,this),1)},d.prototype.processPaste=function(){var a=this.clipboardHTML;null===this.clipboardHTML&&(a=this.$pasteDiv.html(),this.restoreSelectionByMarkers(),e(window).scrollTop(this.scrollPosition));var h,g=this.triggerEvent("onPaste",[a],!1);"string"==typeof g&&(a=g),a=a.replace(/<img /gi,'<img data-fr-image-pasted="true" '),a.match(/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/gi)?(h=this.wordClean(a),h=this.clean(e("<div>").append(h).html(),!1,!0),h=this.removeEmptyTags(h)):(h=this.clean(a,!1,!0),h=this.removeEmptyTags(h)),this.options.plainPaste&&(h=this.plainPasteClean(h)),""!==h&&(this.insertHTML(h),this.$element.find("li").each(e.proxy(function(i,j){this.wrapTextInElement(e(j),!0)},this)),this.options.paragraphy&&this.wrapText(!0),this.cleanupLists()),this.afterPaste()},d.prototype.afterPaste=function(){this.focus(),this.uploadPastedImages(),this.$element.trigger("placeholderCheck"),this.pasting=!1,this.triggerEvent("afterPaste",[],!0,!0)},d.prototype.registerPaste=function(){this.$element.on("copy cut",e.proxy(function(){this.copiedText=this.text()},this)),this.$element.on("paste",e.proxy(function(a){if(!this.isHTML){if(a.originalEvent&&(a=a.originalEvent),!this.triggerEvent("beforePaste",[],!1)){return !1}if(this.clipboardPaste(a)){return !1}this.clipboardHTML="",this.pasting=!0,this.scrollPosition=e(window).scrollTop();var j=!1;if(a&&a.clipboardData&&a.clipboardData.getData){var i="",h=a.clipboardData.types;if(e.Editable.isArray(h)){for(var g=0;g<h.length;g++){i+=h[g]+";"}}else{i=h}if(/text\/html/.test(i)?this.clipboardHTML=a.clipboardData.getData("text/html"):/text\/rtf/.test(i)&&this.browser.safari?this.clipboardHTML=a.clipboardData.getData("text/rtf"):/text\/plain/.test(i)&&!this.browser.mozilla&&(this.clipboardHTML=a.clipboardData.getData("text/plain").replace(/\n/g,"<br/>")),""!==this.clipboardHTML?j=!0:this.clipboardHTML=null,j){return this.processPaste(),a.preventDefault&&(a.stopPropagation(),a.preventDefault()),!1}}this.beforePaste()}},this))},d.prototype.clipboardPaste=function(a){if(a&&a.clipboardData&&a.clipboardData.items){var h=a.clipboardData.items[0].getAsFile();if(h){var g=new FileReader;return g.onload=e.proxy(function(i){var c=i.target.result;this.insertHTML('<img data-fr-image-pasted="true" src="'+c+'" />'),this.afterPaste()},this),g.readAsDataURL(h),!0}}return !1},d.prototype.uploadPastedImages=function(){this.$element.find("img[data-fr-image-pasted]").each(e.proxy(function(a,g){this.options.pasteImage?(0===g.src.indexOf("data:")?(this.options.defaultImageWidth&&e(g).attr("width",this.options.defaultImageWidth),this.options.pastedImagesUploadURL&&(setTimeout(e.proxy(function(){this.showImageLoader(),this.$progress_bar.find("span").css("width","100%").text("Please wait!"),this.showByCoordinates(e(g).offset().left+e(g).width()/2,e(g).offset().top+e(g).height()+10),this.isDisabled=!0},this),10),e.ajax({type:this.options.pastedImagesUploadRequestType,url:this.options.pastedImagesUploadURL,data:e.extend({image:decodeURIComponent(g.src)},this.options.imageUploadParams),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers,dataType:"json"}).done(e.proxy(function(c){try{if(c.link){var i=new Image;i.onerror=e.proxy(function(){this.throwImageError(1)},this),i.onload=e.proxy(function(){g.src=c.link,this.hideImageLoader(),this.hide(),this.enable(),setTimeout(function(){e(g).trigger("touchend")},50),this.triggerEvent("afterUploadPastedImage",[e(g)])},this),i.src=c.link}else{c.error?this.throwImageErrorWithMessage(c.error):this.throwImageError(2)}}catch(h){this.throwImageError(4)}},this)).fail(e.proxy(function(){this.throwImageError(3)},this)))):0!==g.src.indexOf("http")&&e(g).remove(),e(g).removeAttr("data-fr-image-pasted")):e(g).remove()},this))},d.prototype.disable=function(){this.isDisabled=!0,this.$element.blur()},d.prototype.enable=function(){this.isDisabled=!1},d.prototype.wordClean=function(h){h.indexOf("<body")>=0&&(h=h.replace(/[.\s\S\w\W<>]*<body[^>]*>([.\s\S\w\W<>]*)<\/body>[.\s\S\w\W<>]*/g,"$1")),h=h.replace(/<p(.*?)class="?'?MsoListParagraph"?'?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li><p>$3</p></li></ul>"),h=h.replace(/<p(.*?)class="?'?MsoListParagraphCxSpFirst"?'?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li><p>$3</p></li>"),h=h.replace(/<p(.*?)class="?'?MsoListParagraphCxSpMiddle"?'?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li><p>$3</p></li>"),h=h.replace(/<p(.*?)class="?'?MsoListParagraphCxSpLast"?'?([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li><p>$3</p></li></ul>"),h=h.replace(/<span([^<]*?)style="?'?mso-list:Ignore"?'?([\s\S]*?)>([\s\S]*?)<span/gi,"<span><span"),h=h.replace(/<!--\[if \!supportLists\]-->([\s\S]*?)<!--\[endif\]-->/gi,""),h=h.replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," "),h=h.replace(/<!--[\s\S]*?-->/gi,""),h=h.replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");for(var g=["style","script","applet","embed","noframes","noscript"],k=0;k<g.length;k++){var j=new RegExp("<"+g[k]+".*?"+g[k]+"(.*?)>","gi");h=h.replace(j,"")}h=h.replace(/([\w\-]*)=("[^<>"]*"|'[^<>']*'|\w+)/gi,""),h=h.replace(/&nbsp;/gi,"");var i;do{i=h,h=h.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")}while(h!=i);return h=this.clean(h),h=h.replace(/<a>(.[^<]+)<\/a>/gi,"$1")},d.prototype.tabs=function(h){for(var g="",i=0;h>i;i++){g+="  "}return g},d.prototype.cleanTags=function(F,E){void 0===E&&(E=!1);var D,C,B,A,z=this.options.formatTags,y=[],x=[],w=!1;for(C=0;C<F.length;C++){if(D=F.charAt(C),"<"==D){var v=F.indexOf(">",C+1);if(-1!==v){var u=F.substring(C,v+1),t=this.tagName(u),s=this.isClosingTag(u);if("pre"===t&&(w=s?!1:!0),this.isSelfClosingTag(u)){x.push("br"===t&&w?"\n":u)}else{if(s){for(B=!1,A=!0;B===!1&&void 0!==A;){A=y.pop(),void 0!==A&&A.tag_name!==t?x.splice(A.i,1):(B=!0,void 0!==A&&x.push(u))}}else{x.push(u),y.push({tag_name:t,i:x.length-1})}}C=v}}else{"\n"===D&&this.options.beautifyCode?E&&w&&x.push("<br/>"):"	"!==D&&x.push(D)}}for(;y.length>0;){A=y.pop(),x.splice(A.i,1)}var r="\n";this.options.beautifyCode||(r=""),F="",y=0;var q=!0;for(C=0;C<x.length;C++){1==x[C].length?q&&" "===x[C]||(F+=x[C],q=!1):z.indexOf(this.tagName(x[C]).toLowerCase())<0?F+=x[C]:this.isSelfClosingTag(x[C])?F+=x[C]:this.isClosingTag(x[C])?(y-=1,0===y&&(q=!0),F.length>0&&F[F.length-1]==r&&(F+=this.tabs(y)),F+=x[C]+r):(F+=r+this.tabs(y)+x[C],y+=1)}return F[0]==r&&(F=F.substring(1,F.length)),F[F.length-1]==r&&(F=F.substring(0,F.length-1)),F},d.prototype.cleanupLists=function(){this.$element.find("ul, ol").each(function(i,l){var k=e(l);if(k.find(".close-ul, .open-ul, .close-ol, .open-ol, .open-li, .close-li").length>0){var j="<"+l.tagName.toLowerCase()+">"+k.html()+"</"+l.tagName.toLowerCase()+">";j=j.replace(new RegExp('<span class="close-ul" data-fr-verified="true"></span>',"g"),"</ul>"),j=j.replace(new RegExp('<span class="open-ul" data-fr-verified="true"></span>',"g"),"<ul>"),j=j.replace(new RegExp('<span class="close-ol" data-fr-verified="true"></span>',"g"),"</ol>"),j=j.replace(new RegExp('<span class="open-ol" data-fr-verified="true"></span>',"g"),"<ol>"),j=j.replace(new RegExp('<span class="close-li" data-fr-verified="true"></span>',"g"),"</li>"),j=j.replace(new RegExp('<span class="open-li" data-fr-verified="true"></span>',"g"),"<li>"),k.replaceWith(j)}});for(var a=this.$element.find("ol + ol, ul + ul"),h=0;h<a.length;h++){var g=e(a[h]);g.prev().append(g.html()),g.remove()}this.$element.find("li > td").remove(),this.$element.find("li:empty").remove(),this.$element.find("li td:empty").append("</br>"),this.$element.find("ul, ol").each(e.proxy(function(i,k){var j=e(k);0===j.find(this.valid_nodes.join(",")).length&&j.remove()},this)),this.$element.find("li > td").remove(),this.$element.find("li:empty").remove(),this.$element.find("li td:empty").append("</br>"),this.options.paragraphy&&this.$element.find("li").each(e.proxy(function(i,j){this.wrapTextInElement(e(j),!0)},this))},d.prototype.clean=function(t,s,r,q,p){p||(p=e.merge([],this.options.allowedAttrs)),q||(q=e.merge([],this.options.allowedTags)),s||p.indexOf("id")>-1&&p.splice(p.indexOf("id"),1),t=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");var o=new RegExp("<\\/?((?!(?:"+q.join(" |")+"|"+q.join(">|")+"))\\w+)[^>]*?>","gi");t=t.replace(o,"");var n=new RegExp("( (?!(?:"+p.join("|")+"))[a-zA-Z0-9-_]+)=((?:.(?!\\s+(?:\\S+)=|[>]|(\\/>)))+.)","gi");t=t.replace(/<\/?[^>]*?>/gi,function(b){return b.replace(n,"")});var m=new RegExp('<([^>]*)(src|href)=(\'[^\']*\'|""[^""]*""|[^\\s>]+)([^>]*)>',"gi");if(t=t.replace(m,e.proxy(function(h,g,k,j,i){return"<"+g+k+'="'+this.sanitizeURL(j.replace(/^["'](.*)["']\/?$/gi,"$1"))+'"'+i+">"},this)),this.pasting&&this.copiedText===e("<div>").html(t).text()&&(r=!1,s=!0),r){var l=new RegExp("style=(\"[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/'%]*\"|'[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/\"%]*')","gi");t=t.replace(l,"")}if(t=this.cleanTags(t,!0),!s){var a=e("<div>").append(t);a.find('[class]:not([class^="fr-"])').each(function(g,h){e(h).removeAttr("class")}),t=a.html()}return t},d.prototype.plainPasteClean=function(a){var h=e("<div>").html(a);h.find("h1, h2, h3, h4, h5, h6, pre, blockquote").each(function(i,j){e(j).replaceWith("<p>"+e(j).html()+"</p>")});for(var g=function(i,j){e(j).replaceWith(e(j).html())};h.find("strong, em, strike, b, u, i, sup, sub, span, a").length;){h.find("strong, em, strike, b, u, i, sup, sub, span, a").each(g)}return h.html()},d.prototype.removeEmptyTags=function(a){for(var n,m=e("<div>").html(a),l=m.find("*:empty:not(br, img, td, th)");l.length;){for(n=0;n<l.length;n++){e(l[n]).remove()}l=m.find("*:empty:not(br, img, td, th)")}m.find("> div").each(function(g,h){e(h).replaceWith(e(h).html()+"<br/>")});for(var k=m.find("div");k.length;){for(n=0;n<k.length;n++){var j=e(k[n]),i=j.html().replace(/\u0009/gi,"").trim();j.replaceWith(i)}k=m.find("div")}return m.html()},d.prototype.initElementStyle=function(){this.editableDisabled||this.$element.attr("contenteditable",!0);var b="froala-element "+this.options.editorClass;this.browser.msie&&d.getIEversion()<9&&(b+=" ie8"),this.$element.css("outline",0),this.browser.msie||(b+=" not-msie"),this.$element.addClass(b)},d.prototype.initUndoRedo=function(){this.undoStack=[],this.undoIndex=0,this.saveUndoStep(),this.disableBrowserUndo()},d.prototype.CJKclean=function(g){var c=/[\u3041-\u3096\u30A0-\u30FF\u4E00-\u9FFF\u3130-\u318F\uAC00-\uD7AF]/gi;return g.replace(c,"")},d.prototype.enableTyping=function(){this.typingTimer=null,this.$element.on("keydown cut",e.proxy(function(a){return"keydown"!==a.type||this.triggerEvent("keydown",[a.which,(a.ctrlKey||a.metaKey)&&!a.altKey],!1)?(clearTimeout(this.typingTimer),this.ajaxSave=!1,this.oldHTML=this.getHTML(!0),void (this.typingTimer=setTimeout(e.proxy(function(){var b=this.getHTML(!0);this.ime||this.CJKclean(b)===this.CJKclean(this.oldHTML)||this.CJKclean(b)!==b||this.sync()},this),Math.max(this.options.typingTimer,500)))):!1},this))},d.prototype.removeMarkersByRegex=function(b){return b.replace(/<span[^>]*? class\s*=\s*["']?f-marker["']?[^>]+>([\S\s][^\/])*<\/span>/gi,"")},d.prototype.getImageHTML=function(){return JSON.stringify({src:this.$element.find("img").attr("src"),style:this.$element.find("img").attr("style"),alt:this.$element.find("img").attr("alt"),width:this.$element.find("img").attr("width"),link:this.$element.find("a").attr("href"),link_title:this.$element.find("a").attr("title"),link_target:this.$element.find("a").attr("target")})},d.prototype.getLinkHTML=function(){return JSON.stringify({body:this.$element.html(),href:this.$element.attr("href"),title:this.$element.attr("title"),popout:this.$element.hasClass("popout"),nofollow:"nofollow"==this.$element.attr("ref"),blank:"_blank"==this.$element.attr("target"),cls:this.$element.attr("class")?this.$element.attr("class").replace(/froala-element ?|not-msie ?|/gi,"").trim():""})},d.prototype.addFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").addClass("fr-tag")},d.prototype.removeFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").removeClass("fr-tag")},d.prototype.getHTML=function(a,j,i){if(void 0===j&&(j=!1),void 0===a&&(a=!1),void 0===i&&(i=!0),this.$element.hasClass("f-placeholder")&&!a){return""}if(this.isHTML){return this.$html_area.val()}if(this.isImage){return this.getImageHTML()}if(this.isLink){return this.getLinkHTML()}this.$element.find("a").data("fr-link",!0),j&&this.addFrTag(),this.$element.find(".f-img-editor > img").each(e.proxy(function(k,l){this.addImageClass(e(l),this.getImageClass(e(l).parent().attr("class")))},this)),this.$element.find("pre").each(e.proxy(function(k,o){var n=e(o),m=n.html(),l=m.replace(/\&nbsp;/gi," ");m!=l&&(this.saveSelectionByMarkers(),n.html(l),this.restoreSelectionByMarkers())},this));var h=this.$element.html();if(this.$element.find(".f-img-editor > img").removeClass("fr-fin fr-fil fr-fir"),this.removeFrTag(),h=this.syncCleanHTML(h,a),h=h.replace(/<a[^>]*?><\/a>/g,""),a||(h=this.removeMarkersByRegex(h)),h=h.replace(/<span[^>]*? class\s*=\s*["']?f-img-handle[^>]+><\/span>/gi,""),h=h.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-editor[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),h=h.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-wrap[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),h=h.replace(/\&amp;/gi,"&"),this.options.simpleAmpersand&&(h=h.replace(/\&amp;/gi,"&")),i&&(h=h.replace(/ data-fr-verified="true"/gi,"")),this.options.beautifyCode&&(h=h.replace(/\n/gi,"")),h=h.replace(/\u200B/gi,""),j){var g=this.triggerEvent("getHTML",[h],!1);if("string"==typeof g){return g}}return h},d.prototype.getText=function(){return this.$element.text()},d.prototype.setDirty=function(b){this.dirty=b},d.prototype.initAjaxSaver=function(){this.ajaxHTML=this.getHTML(),this.ajaxSave=!0,this.ajaxInterval=setInterval(e.proxy(function(){var b=this.getHTML();(this.ajaxHTML!=b||this.dirty)&&this.ajaxSave&&(this.options.autosave&&this.save(),this.dirty=!1,this.ajaxHTML=b),this.ajaxSave=!0},this),Math.max(this.options.autosaveInterval,100))},d.prototype.disableBrowserUndo=function(){this.$element.keydown(function(h){var g=h.which,i=(h.ctrlKey||h.metaKey)&&!h.altKey;if(!this.isHTML&&i){if(75==g){return h.preventDefault(),!1}if(90==g&&h.shiftKey){return h.preventDefault(),!1}if(90==g){return h.preventDefault(),!1}}})},d.prototype.saveUndoStep=function(){if(!this.undoStack){return !1}for(;this.undoStack.length>this.undoIndex;){this.undoStack.pop()}var g=this.getHTML(!0,!1,!1);if(this.undoStack[this.undoIndex-1]&&this.removeMarkersByRegex(this.undoStack[this.undoIndex-1])==g){return !1}var c=!1;this.selectionInEditor()&&this.$element.is(":focus")&&(this.saveSelectionByMarkers(),c=!0),this.undoStack.push(this.getHTML(!0,!1,!1)),this.undoIndex++,c&&this.restoreSelectionByMarkers(!1),this.refreshUndo(),this.refreshRedo()},d.prototype.shortcutEnabled=function(b){return this.options.shortcutsAvailable.indexOf(b)>=0},d.prototype.shortcuts_map={70:{cmd:"show",params:[null],id:"show"},69:{cmd:"show",params:[null],id:"show"},66:{cmd:"exec",params:["bold"],id:"bold"},73:{cmd:"exec",params:["italic"],id:"italic"},85:{cmd:"exec",params:["underline"],id:"underline"},83:{cmd:"exec",params:["strikeThrough"],id:"strikeThrough"},75:{cmd:"exec",params:["createLink"],id:"createLink"},80:{cmd:"exec",params:["insertImage"],id:"insertImage"},65:{cmd:"exec",params:["selectAll"],id:"selectAll"},221:{cmd:"exec",params:["indent"],id:"indent"},219:{cmd:"exec",params:["outdent"],id:"outdent"},72:{cmd:"exec",params:["html"],id:"html"},48:{cmd:"exec",params:["formatBlock","n"],id:"formatBlock n"},49:{cmd:"exec",params:["formatBlock","h1"],id:"formatBlock h1"},50:{cmd:"exec",params:["formatBlock","h2"],id:"formatBlock h2"},51:{cmd:"exec",params:["formatBlock","h3"],id:"formatBlock h3"},52:{cmd:"exec",params:["formatBlock","h4"],id:"formatBlock h4"},53:{cmd:"exec",params:["formatBlock","h5"],id:"formatBlock h5"},54:{cmd:"exec",params:["formatBlock","h6"],id:"formatBlock h6"},222:{cmd:"exec",params:["formatBlock","blockquote"],id:"formatBlock blockquote"},220:{cmd:"exec",params:["formatBlock","pre"],id:"formatBlock pre"}},d.prototype.initShortcuts=function(){this.options.shortcuts&&this.$element.on("keydown",e.proxy(function(h){var g=h.which,i=(h.ctrlKey||h.metaKey)&&!h.altKey;if(!this.isHTML&&i){if(this.shortcuts_map[g]&&this.shortcutEnabled(this.shortcuts_map[g].id)){return this.execDefaultShortcut(this.shortcuts_map[g].cmd,this.shortcuts_map[g].params)}if(90==g&&h.shiftKey){return h.preventDefault(),h.stopPropagation(),this.redo(),!1}if(90==g){return h.preventDefault(),h.stopPropagation(),this.undo(),!1}}},this))},d.prototype.initTabs=function(){this.$element.on("keydown",e.proxy(function(h){var g=h.which;if(9!=g||h.shiftKey){9==g&&h.shiftKey&&(this.raiseEvent("shift+tab")?this.options.tabSpaces?h.preventDefault():this.blur():h.preventDefault())}else{if(this.raiseEvent("tab")){if(this.options.tabSpaces){h.preventDefault();var j="&nbsp;&nbsp;&nbsp;&nbsp;",i=this.getSelectionElements()[0];"PRE"===i.tagName&&(j="    "),this.insertHTML(j,!1)}else{this.blur()}}else{h.preventDefault()}}},this))},d.prototype.textEmpty=function(a){var g=e(a).text().replace(/(\r\n|\n|\r|\t)/gm,"");return(""===g||a===this.$element.get(0))&&0===e(a).find("br").length},d.prototype.inEditor=function(b){for(;b&&"BODY"!==b.tagName;){if(b===this.$element.get(0)){return !0}b=b.parentNode}return !1},d.prototype.focus=function(a){if(void 0===a&&(a=!0),""!==this.text()&&!this.$element.is(":focus")){return void (this.browser.msie||this.$element.focus())}if(!this.isHTML){!a||this.pasting||this.browser.msie||this.$element.focus(),this.pasting&&!this.$element.is(":focus")&&this.$element.focus();var j=this.getRange();if(""===this.text()&&j&&(0===j.startOffset||j.startContainer===this.$element.get(0)||!this.inEditor(j.startContainer))){var i,h,g=this.getSelectionElements();if(e.merge(["IMG","BR"],this.valid_nodes).indexOf(this.getSelectionElement().tagName)<0){return !1}if(j.startOffset>0&&this.valid_nodes.indexOf(this.getSelectionElement().tagName)>=0||j.startContainer&&3===j.startContainer.nodeType){return !1}if(g.length>=1&&g[0]!==this.$element.get(0)){for(i=0;i<g.length;i++){if(h=g[i],!this.textEmpty(h)||this.browser.msie){return void this.setSelection(h)}}}if(j.startContainer===this.$element.get(0)&&j.startOffset>0&&!this.options.paragraphy){return void this.setSelection(this.$element.get(0),j.startOffset)}for(g=this.$element.find(this.valid_nodes.join(",")),i=0;i<g.length;i++){if(h=g[i],!this.textEmpty(h)&&0===e(h).find(this.valid_nodes.join(",")).length){return void this.setSelection(h)}}this.setSelection(this.$element.get(0))}}},d.prototype.addMarkersAtEnd=function(a){var h=a.find(this.valid_nodes.join(", "));0===h.length&&h.push(a.get(0));var g=h[h.length-1];e(g).append('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>')},d.prototype.setFocusAtEnd=function(b){void 0===b&&(b=this.$element),this.addMarkersAtEnd(b),this.restoreSelectionByMarkers()},d.prototype.breakHTML=function(J){this.removeMarkers(),0===this.$element.find("break").length&&this.insertSimpleHTML("<break></break>");var I=this.$element.find("break").parents(e.merge(["UL","OL"],this.valid_nodes).join(","))[0];if(e(I).parents("ul, ol").length&&(I=e(I).parents("ul, ol")[0]),["UL","OL"].indexOf(I.tagName)>=0){var H=e("<div>").html(J);H.find("> li").wrap("<"+I.tagName+">"),J=H.html()}if(I==this.$element.get(0)){return this.$element.find("break").next().length?(this.$element.find("break").next().prepend('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),this.insertSimpleHTML(J),this.restoreSelectionByMarkers()):(this.insertSimpleHTML(J),this.setFocusAtEnd()),this.$element.find("break").remove(),this.checkPlaceholder(),!0}if("TD"===I.tagName){return this.$element.find("break").remove(),this.insertSimpleHTML(J),!0}var G=e("<div>").html(J);if(this.addMarkersAtEnd(G),J=G.html(),this.emptyElement(e(I))){return e(I).replaceWith(J),this.restoreSelectionByMarkers(),this.checkPlaceholder(),!0}this.$element.find("li").each(e.proxy(function(g,h){this.emptyElement(h)&&e(h).addClass("empty-li")},this));for(var F,E,D=e("<div></div>").append(e(I).clone()).html(),C=[],B={},A=[],z=0,y=0;y<D.length;y++){if(E=D.charAt(y),"<"==E){var x=D.indexOf(">",y+1);if(-1!==x){F=D.substring(y,x+1);var w=this.tagName(F);if(y=x,"break"==w){if(!this.isClosingTag(F)){for(var v=C.length-1;v>=0;v--){var u=this.tagName(C[v]);A.push("</"+u+">")}A.push(J);for(var t=0;t<C.length;t++){A.push(C[t])}}}else{if(A.push(F),!this.isSelfClosingTag(F)){if(this.isClosingTag(F)){var a=B[w].pop();C.splice(a,1)}else{C.push(F),void 0===B[w]&&(B[w]=[]),B[w].push(C.length-1)}}}}}else{z++,A.push(E)}}e(I).replaceWith(A.join("")),this.$element.find("li").each(e.proxy(function(g,i){var h=e(i);h.hasClass("empty-li")?h.removeClass("empty-li"):this.emptyElement(i)&&h.remove()},this)),this.cleanupLists(),this.restoreSelectionByMarkers()},d.prototype.insertSimpleHTML=function(j){var i,p;if(this.no_verify=!0,window.getSelection){if(i=window.getSelection(),i.getRangeAt&&i.rangeCount){p=i.getRangeAt(0),p.deleteContents();var o=document.createElement("div");o.innerHTML=j;for(var n,m,l=document.createDocumentFragment();n=o.firstChild;){m=l.appendChild(n)}p.insertNode(l),m&&(p=p.cloneRange(),p.setStartAfter(m),p.collapse(!0),i.removeAllRanges(),i.addRange(p))}}else{if((i=document.selection)&&"Control"!=i.type){var k=i.createRange();k.collapse(!0),i.createRange().pasteHTML(j)}}this.no_verify=!1},d.prototype.insertHTML=function(a,i){if(void 0===i&&(i=!0),!this.isHTML&&i&&this.focus(),this.removeMarkers(),this.insertSimpleHTML("<break></break>"),this.checkPlaceholder(!0),this.$element.hasClass("f-placeholder")){return this.$element.html(a),this.options.paragraphy&&this.wrapText(!0),this.setFocusAtEnd(),this.checkPlaceholder(),!1}for(var h=e("<div>").append(a).find("*"),g=0;g<h.length;g++){if(this.valid_nodes.indexOf(h[g].tagName)>=0){return this.breakHTML(a),!1}}this.$element.find("break").remove(),this.insertSimpleHTML(a)},d.prototype.execDefaultShortcut=function(g,c){return this[g].apply(this,c),!1},d.prototype.initEditor=function(){var a="froala-editor";this.mobile()&&(a+=" touch"),this.browser.msie&&d.getIEversion()<9&&(a+=" ie8"),this.$editor=e('<div class="'+a+'" style="display: none;">'),e("body").append(this.$editor),this.options.inlineMode?this.initInlineEditor():this.initBasicEditor()},d.prototype.refreshToolbarPosition=function(){e(window).scrollTop()>this.$box.offset().top&&e(window).scrollTop()<this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-e(window).scrollLeft()).width(this.$element.outerWidth()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.iOS()&&(this.$element.is(":focus")?this.$editor.css("top",e(window).scrollTop()):this.$editor.css("top",""))):e(window).scrollTop()<this.$box.offset().top?this.iOS()&&this.$element.is(":focus")?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-e(window).scrollLeft()).width(this.$element.outerWidth()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.$editor.css("top",this.$box.offset().top)):(this.$editor.removeClass("f-scroll f-scroll-abs").css("bottom","").css("top","").width(""),this.$element.css("padding-top",""),this.$placeholder.css("margin-top","")):e(window).scrollTop()>this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()&&!this.$editor.hasClass("f-scroll-abs")&&(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.removeClass("f-scroll").addClass("f-scroll-abs"),this.$editor.css("bottom",0).css("top","").css("left",""))},d.prototype.toolbarTop=function(){this.options.toolbarFixed||this.options.inlineMode||(this.$element.data("padding-top",parseInt(this.$element.css("padding-top"),10)),e(window).on("scroll resize load",e.proxy(function(){this.refreshToolbarPosition()},this)),this.iOS()&&this.$element.on("focus blur",e.proxy(function(){this.refreshToolbarPosition()},this)))},d.prototype.initBasicEditor=function(){this.$element.addClass("f-basic"),this.$wrapper.addClass("f-basic"),this.$popup_editor=this.$editor.clone(),this.$popup_editor.appendTo(e("body")).addClass("f-inline"),this.$editor.addClass("f-basic").show(),this.$editor.insertBefore(this.$wrapper),this.toolbarTop()},d.prototype.initInlineEditor=function(){this.$editor.addClass("f-inline"),this.$element.addClass("f-inline"),this.$popup_editor=this.$editor},d.prototype.initDrag=function(){this.drag_support={filereader:"undefined"!=typeof FileReader,formdata:!!window.FormData,progress:"upload" in new XMLHttpRequest}},d.prototype.initOptions=function(){this.setDimensions(),this.setSpellcheck(),this.setImageUploadURL(),this.setButtons(),this.setDirection(),this.setTextNearImage(),this.setZIndex(),this.setTheme(),this.options.editInPopup&&this.buildEditPopup(),this.editableDisabled||(this.setPlaceholder(),this.setPlaceholderEvents())},d.prototype.isTouch=function(){return WYSIWYGModernizr.touch&&void 0!==window.Touch},d.prototype.initEditorSelection=function(){this.$element.on("keyup",e.proxy(function(b){return this.triggerEvent("keyup",[b],!1)},this)),this.$element.on("focus",e.proxy(function(){this.blurred&&(this.blurred=!1,this.pasting||""!==this.text()||this.focus(!1),this.triggerEvent("focus",[],!1))},this)),this.$element.on("mousedown touchstart",e.proxy(function(){return this.isDisabled?!1:void (this.isResizing()||(this.closeImageMode(),this.hide()))},this)),this.options.disableRightClick&&this.$element.contextmenu(e.proxy(function(b){return b.preventDefault(),this.options.inlineMode&&this.$element.focus(),!1},this)),this.$element.on(this.mouseup,e.proxy(function(a){if(this.isDisabled){return !1}if(!this.isResizing()){var g=this.text();a.stopPropagation(),this.imageMode=!1,!(""!==g||this.options.alwaysVisible||this.options.editInPopup||(3==a.which||2==a.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode?this.options.inlineMode||this.refreshButtons():setTimeout(e.proxy(function(){g=this.text(),!(""!==g||this.options.alwaysVisible||this.options.editInPopup||(3==a.which||2==a.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode||(this.show(a),this.options.editInPopup&&this.showEditPopup())},this),0)}this.hideOtherEditors()},this)),this.$editor.on(this.mouseup,e.proxy(function(b){return this.isDisabled?!1:void (this.isResizing()||(b.stopPropagation(),this.options.inlineMode===!1&&this.hide()))},this)),this.$editor.on("mousedown",".fr-dropdown-menu",e.proxy(function(b){return this.isDisabled?!1:(b.stopPropagation(),void (this.noHide=!0))},this)),this.$popup_editor.on("mousedown",".fr-dropdown-menu",e.proxy(function(b){return this.isDisabled?!1:(b.stopPropagation(),void (this.noHide=!0))},this)),this.$popup_editor.on("mouseup",e.proxy(function(b){return this.isDisabled?!1:void (this.isResizing()||b.stopPropagation())},this)),this.$edit_popup_wrapper&&this.$edit_popup_wrapper.on("mouseup",e.proxy(function(b){return this.isDisabled?!1:void (this.isResizing()||b.stopPropagation())},this)),this.setDocumentSelectionChangeEvent(),this.setWindowMouseUpEvent(),this.setWindowKeyDownEvent(),this.setWindowKeyUpEvent(),this.setWindowOrientationChangeEvent(),this.setWindowHideEvent(),this.setWindowBlurEvent(),this.options.trackScroll&&this.setWindowScrollEvent()},d.prototype.blur=function(a){this.blurred||this.pasting||(this.selectionDisabled=!0,this.triggerEvent("blur",[]),a&&0===e("*:focus").length&&this.clearSelection(),this.isLink||this.isImage||(this.selectionDisabled=!1),this.blurred=!0)},d.prototype.setWindowBlurEvent=function(){this.$window.on("blur."+this._id,e.proxy(function(g,c){this.blur(c)},this))},d.prototype.setWindowHideEvent=function(){this.$window.on("hide."+this._id,e.proxy(function(){this.isResizing()?this.$element.find(".f-img-handle").trigger("moveend"):this.hide(!1)},this))},d.prototype.setWindowOrientationChangeEvent=function(){this.$window.on("orientationchange."+this._id,e.proxy(function(){setTimeout(e.proxy(function(){this.hide()},this),10)},this))},d.prototype.setDocumentSelectionChangeEvent=function(){this.$document.on("selectionchange."+this._id,e.proxy(function(a){return this.isDisabled?!1:void (this.isResizing()||this.isScrolling||(clearTimeout(this.selectionChangedTimeout),this.selectionChangedTimeout=setTimeout(e.proxy(function(){if(this.options.inlineMode&&this.selectionInEditor()&&this.link!==!0&&this.isTouch()){var b=this.text();""!==b?(this.iPod()?this.options.alwaysVisible&&this.hide():this.show(null),a.stopPropagation()):this.options.alwaysVisible?this.show(null):(this.hide(),this.closeImageMode(),this.imageMode=!1)}},this),75)))},this))},d.prototype.setWindowMouseUpEvent=function(){this.$window.on(this.mouseup+"."+this._id,e.proxy(function(){return this.isDisabled?!1:(this.isResizing()||this.isScrolling||(this.$bttn_wrapper.find("button[data-cmd]").removeClass("active"),this.selectionInEditor()&&""!==this.text()&&!this.isTouch()?this.show(null):this.$popup_editor.is(":visible")&&(this.hide(),this.closeImageMode(),this.imageMode=!1),this.blur(!0)),void e("[data-down]").removeAttr("data-down"))},this))},d.prototype.setWindowKeyDownEvent=function(){this.$window.on("keydown."+this._id,e.proxy(function(a){var h=a.which;if(this.imageMode){if(13==h){return this.$element.find(".f-img-editor").parents(".f-img-wrap").before("<br/>"),this.sync(),this.$element.find(".f-img-editor img").click(),!1}if(46==h||8==h){return a.stopPropagation(),a.preventDefault(),setTimeout(e.proxy(function(){this.removeImage(this.$element.find(".f-img-editor"))},this),0),!1}}else{if(this.selectionInEditor()){if(this.isDisabled){return !0}var g=(a.ctrlKey||a.metaKey)&&!a.altKey;!g&&this.$popup_editor.is(":visible")&&(27==h||this.$bttn_wrapper.is(":visible")&&this.options.inlineMode)&&(this.hide(),this.closeImageMode())}}},this))},d.prototype.setWindowKeyUpEvent=function(){this.$window.on("keyup."+this._id,e.proxy(function(){return this.isDisabled?!1:void (this.selectionInEditor()&&""!==this.text()&&!this.$popup_editor.is(":visible")&&this.repositionEditor())},this))},d.prototype.setWindowScrollEvent=function(){this.$window.on("scroll."+this._id,e.proxy(function(){return this.isDisabled?!1:(clearTimeout(this.scrollTimer),this.isScrolling=!0,void (this.scrollTimer=setTimeout(e.proxy(function(){this.isScrolling=!1},this),2500)))},this))},d.prototype.setTextNearImage=function(b){void 0!==b&&(this.options.textNearImage=b),this.options.textNearImage===!0?this.$element.removeClass("f-tni"):this.$element.addClass("f-tni")},d.prototype.setPlaceholder=function(a){a&&(this.options.placeholder=a),this.$textarea&&this.$textarea.attr("placeholder",this.options.placeholder),this.$placeholder||(this.$placeholder=e('<span class="fr-placeholder" unselectable="on"></span>').bind("click",e.proxy(function(){this.focus()},this)),this.$element.after(this.$placeholder)),this.$placeholder.text(this.options.placeholder)},d.prototype.isEmpty=function(){var a=this.$element.text().replace(/(\r\n|\n|\r|\t|\u200B|\u0020)/gm,"");return""===a&&0===this.$element.find("img, table, iframe, input, hr").length&&0===this.$element.find("p > br, div > br").length&&0===this.$element.find(e.map(this.valid_nodes,function(b){return["P, DIV"].indexOf(b)>=0?null:b}).join(", ")).length},d.prototype.checkPlaceholder=function(a){if(this.isDisabled&&!a){return !1}if(this.pasting&&!a){return !1}if(this.$element.find("td:empty, th:empty").append("</br>"),!this.isHTML){if(this.isEmpty()&&!this.fakeEmpty()){var h,g=this.selectionInEditor()||this.$element.is(":focus");this.options.paragraphy?(h=e("<p><br/></p>"),this.$element.html(h),g&&this.setSelection(h.get(0)),this.$element.addClass("f-placeholder")):(0===this.$element.find("br").length&&this.$element.append("<br/>"),this.$element.addClass("f-placeholder"))}else{!this.$element.find("p").length&&this.options.paragraphy?(this.wrapText(!0),this.$element.find("p").length&&""===this.text()?this.setSelection(this.$element.find("p")[0],this.$element.find("p").text().length,null,this.$element.find("p").text().length):this.$element.removeClass("f-placeholder")):this.fakeEmpty()===!1||this.$element.find(this.valid_nodes.join(",")).length>1?this.$element.removeClass("f-placeholder"):this.$element.addClass("f-placeholder")}}return !0},d.prototype.fakeEmpty=function(g){void 0===g&&(g=this.$element);var c=g.text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return""===c&&1==g.find("p, div").length&&1==g.find("p > br, div > br").length&&0===g.find("img, table, iframe, input, hr").length},d.prototype.setPlaceholderEvents=function(){this.browser.msie&&d.getIEversion()<9||(this.$element.on("focus",e.proxy(function(){return this.isDisabled?!1:void (""!==this.$element.text()||this.pasting||this.focus(!1))},this)),this.$element.on("keyup keydown focus placeholderCheck",e.proxy(function(){return this.checkPlaceholder()},this)),this.$element.trigger("placeholderCheck"))},d.prototype.setDimensions=function(h,g,j,i){h&&(this.options.height=h),g&&(this.options.width=g),j&&(this.options.minHeight=j),i&&(this.options.maxHeight=i),"auto"!=this.options.height&&this.$element.css("height",this.options.height),"auto"!=this.options.minHeight&&this.$element.css("minHeight",this.options.minHeight),"auto"!=this.options.maxHeight&&this.$element.css("maxHeight",this.options.maxHeight),"auto"!=this.options.width&&this.$box.css("width",this.options.width)},d.prototype.setDirection=function(b){b&&(this.options.direction=b),"ltr"!=this.options.direction&&"rtl"!=this.options.direction&&(this.options.direction="ltr"),"rtl"==this.options.direction?(this.$element.addClass("f-rtl"),this.$editor.addClass("f-rtl"),this.$popup_editor.addClass("f-rtl"),this.$image_modal&&this.$image_modal.addClass("f-rtl")):(this.$element.removeClass("f-rtl"),this.$editor.removeClass("f-rtl"),this.$popup_editor.removeClass("f-rtl"),this.$image_modal&&this.$image_modal.removeClass("f-rtl"))},d.prototype.setZIndex=function(b){b&&(this.options.zIndex=b),this.$editor.css("z-index",this.options.zIndex),this.$popup_editor.css("z-index",this.options.zIndex+1),this.$overlay&&this.$overlay.css("z-index",this.options.zIndex+2),this.$image_modal&&this.$image_modal.css("z-index",this.options.zIndex+3)},d.prototype.setTheme=function(b){b&&(this.options.theme=b),null!=this.options.theme&&(this.$editor.addClass(this.options.theme+"-theme"),this.$popup_editor.addClass(this.options.theme+"-theme"),this.$box&&this.$box.addClass(this.options.theme+"-theme"),this.$image_modal&&this.$image_modal.addClass(this.options.theme+"-theme"))},d.prototype.setSpellcheck=function(b){void 0!==b&&(this.options.spellcheck=b),this.$element.attr("spellcheck",this.options.spellcheck)},d.prototype.customizeText=function(a){if(a){var g=this.$editor.find("[title]").add(this.$popup_editor.find("[title]"));this.$image_modal&&(g=g.add(this.$image_modal.find("[title]"))),g.each(e.proxy(function(i,h){for(var b in a){e(h).attr("title").toLowerCase()==b.toLowerCase()&&e(h).attr("title",a[b])}},this)),g=this.$editor.find('[data-text="true"]').add(this.$popup_editor.find('[data-text="true"]')),this.$image_modal&&(g=g.add(this.$image_modal.find('[data-text="true"]'))),g.each(e.proxy(function(i,h){for(var b in a){e(h).text().toLowerCase()==b.toLowerCase()&&e(h).text(a[b])}},this))}},d.prototype.setLanguage=function(a){void 0!==a&&(this.options.language=a),e.Editable.LANGS[this.options.language]&&(this.customizeText(e.Editable.LANGS[this.options.language].translation),e.Editable.LANGS[this.options.language].direction&&this.setDirection(e.Editable.LANGS[this.options.language].direction),e.Editable.LANGS[this.options.language].translation[this.options.placeholder]&&this.setPlaceholder(e.Editable.LANGS[this.options.language].translation[this.options.placeholder]))},d.prototype.setCustomText=function(b){b&&(this.options.customText=b),this.options.customText&&this.customizeText(this.options.customText)},d.prototype.execHTML=function(){this.html()},d.prototype.initHTMLArea=function(){this.$html_area=e('<textarea wrap="hard">').keydown(function(a){var i=a.keyCode||a.which;if(9==i){a.preventDefault();var h=e(this).get(0).selectionStart,g=e(this).get(0).selectionEnd;e(this).val(e(this).val().substring(0,h)+"	"+e(this).val().substring(g)),e(this).get(0).selectionStart=e(this).get(0).selectionEnd=h+1}}).focus(e.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this)).mouseup(e.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this))},d.prototype.command_dispatcher={align:function(h){var g=this.buildDropdownAlign(h),i=this.buildDropdownButton(h,g);return i},formatBlock:function(h){var g=this.buildDropdownFormatBlock(h),i=this.buildDropdownButton(h,g);return i},html:function(a){var g=this.buildDefaultButton(a);return this.options.inlineMode&&this.$box.append(e(g).clone(!0).addClass("html-switch").attr("title","Hide HTML").click(e.proxy(this.execHTML,this))),this.initHTMLArea(),g}},d.prototype.setButtons=function(b){b&&(this.options.buttons=b),this.$editor.append('<div class="bttn-wrapper" id="bttn-wrapper-'+this._id+'">'),this.$bttn_wrapper=this.$editor.find("#bttn-wrapper-"+this._id),this.mobile()&&this.$bttn_wrapper.addClass("touch");for(var p,o,n="",m=0;m<this.options.buttons.length;m++){var l=this.options.buttons[m];if("sep"!=l){var k=d.commands[l];if(void 0!==k){k.cmd=l;var j=this.command_dispatcher[k.cmd];j?n+=j.apply(this,[k]):k.seed?(p=this.buildDefaultDropdown(k),o=this.buildDropdownButton(k,p),n+=o):(o=this.buildDefaultButton(k),n+=o,this.bindRefreshListener(k))}else{if(k=this.options.customButtons[l],void 0===k){if(k=this.options.customDropdowns[l],void 0===k){continue}o=this.buildCustomDropdown(k,l),n+=o,this.bindRefreshListener(k);continue}o=this.buildCustomButton(k,l),n+=o,this.bindRefreshListener(k)}}else{n+=this.options.inlineMode?'<div class="f-clear"></div><hr/>':'<span class="f-sep"></span>'}}this.$bttn_wrapper.html(n),this.$bttn_wrapper.find('button[data-cmd="undo"], button[data-cmd="redo"]').prop("disabled",!0),this.bindButtonEvents()},d.prototype.bindRefreshListener=function(a){a.refresh&&this.addListener("refresh",e.proxy(function(){a.refresh.apply(this,[a.cmd])},this))},d.prototype.buildDefaultButton=function(g){var c='<button type="button" class="fr-bttn" title="'+g.title+'" data-cmd="'+g.cmd+'">';return c+=void 0===this.options.icons[g.cmd]?this.addButtonIcon(g):this.prepareIcon(this.options.icons[g.cmd],g.title),c+="</button>"},d.prototype.prepareIcon=function(g,c){switch(g.type){case"font":return this.addButtonIcon({icon:g.value});case"img":return this.addButtonIcon({icon_img:g.value,title:c});case"txt":return this.addButtonIcon({icon_txt:g.value})}},d.prototype.addButtonIcon=function(b){return b.icon?'<i class="'+b.icon+'"></i>':b.icon_alt?'<i class="for-text">'+b.icon_alt+"</i>":b.icon_img?'<img src="'+b.icon_img+'" alt="'+b.title+'"/>':b.icon_txt?"<i>"+b.icon_txt+"</i>":b.title},d.prototype.buildCustomButton=function(h,g){this["call_"+g]=h.callback;var i='<button type="button" class="fr-bttn" data-callback="call_'+g+'" data-cmd="button_name" data-name="'+g+'" title="'+h.title+'">'+this.prepareIcon(h.icon,h.title)+"</button>";return i},d.prototype.callDropdown=function(a,g){this.$bttn_wrapper.on("click touch",'[data-name="'+a+'"]',e.proxy(function(b){b.preventDefault(),b.stopPropagation(),g.apply(this)},this))},d.prototype.buildCustomDropdown=function(h,g){var l='<div class="fr-bttn fr-dropdown">';l+='<button type="button" class="fr-trigger" title="'+h.title+'" data-name="'+g+'">'+this.prepareIcon(h.icon,h.title)+"</button>",l+='<ul class="fr-dropdown-menu">';var k=0;for(var j in h.options){this["call_"+g+k]=h.options[j];var i='<li data-callback="call_'+g+k+'" data-cmd="'+g+k+'" data-name="'+g+k+'"><a href="#">'+j+"</a></li>";l+=i,k++}return l+="</ul></div>"},d.prototype.buildDropdownButton=function(h,g,l){l=l||"";var k='<div class="fr-bttn fr-dropdown '+l+'">',j="";j+=void 0===this.options.icons[h.cmd]?this.addButtonIcon(h):this.prepareIcon(this.options.icons[h.cmd],h.title);var i='<button type="button" data-name="'+h.cmd+'" class="fr-trigger" title="'+h.title+'">'+j+"</button>";return k+=i,k+=g,k+="</div>"},d.prototype.buildDropdownAlign=function(h){this.bindRefreshListener(h);for(var g='<ul class="fr-dropdown-menu f-align">',j=0;j<h.seed.length;j++){var i=h.seed[j];g+='<li data-cmd="align" data-val="'+i.cmd+'" title="'+i.title+'"><a href="#"><i class="'+i.icon+'"></i></a></li>'}return g+="</ul>"},d.prototype.buildDropdownFormatBlock=function(h){var g='<ul class="fr-dropdown-menu">';for(var j in this.options.blockTags){var i='<li data-cmd="'+h.cmd+'" data-val="'+j+'">';i+='<a href="#" data-text="true" class="format-'+j+'" title="'+this.options.blockTags[j]+'">'+this.options.blockTags[j]+"</a></li>",g+=i}return g+="</ul>"},d.prototype.buildDefaultDropdown=function(h){for(var g='<ul class="fr-dropdown-menu">',k=0;k<h.seed.length;k++){var j=h.seed[k],i='<li data-cmd="'+(j.cmd||h.cmd)+'" data-val="'+j.value+'" data-param="'+(j.param||h.param)+'">';i+='<a href="#" data-text="true" class="'+j.value+'" title="'+j.title+'">'+j.title+"</a></li>",g+=i}return g+="</ul>"},d.prototype.createEditPopupHTML=function(){var b='<div class="froala-popup froala-text-popup" style="display:none;">';return b+='<h4><span data-text="true">Edit text</span><i title="Cancel" class="fa fa-times" id="f-text-close-'+this._id+'"></i></h4></h4>',b+='<div class="f-popup-line"><input type="text" placeholder="http://www.example.com" class="f-lu" id="f-ti-'+this._id+'">',b+='<button data-text="true" type="button" class="f-ok" id="f-edit-popup-ok-'+this._id+'">OK</button>',b+="</div>",b+="</div>"},d.prototype.buildEditPopup=function(){this.$edit_popup_wrapper=e(this.createEditPopupHTML()),this.$popup_editor.append(this.$edit_popup_wrapper),this.$edit_popup_wrapper.find("#f-ti-"+this._id).on("mouseup keydown",function(b){b.stopPropagation()}),this.addListener("hidePopups",e.proxy(function(){this.$edit_popup_wrapper.hide()},this)),this.$edit_popup_wrapper.on("click","#f-edit-popup-ok-"+this._id,e.proxy(function(){this.$element.text(this.$edit_popup_wrapper.find("#f-ti-"+this._id).val()),this.sync(),this.hide()},this)),this.$edit_popup_wrapper.on("click","i#f-text-close-"+this._id,e.proxy(function(){this.hide()},this))},d.prototype.createCORSRequest=function(h,g){var j=new XMLHttpRequest;if("withCredentials" in j){j.open(h,g,!0),this.options.withCredentials&&(j.withCredentials=!0);for(var i in this.options.headers){j.setRequestHeader(i,this.options.headers[i])}}else{"undefined"!=typeof XDomainRequest?(j=new XDomainRequest,j.open(h,g)):j=null}return j},d.prototype.isEnabled=function(a){return e.inArray(a,this.options.buttons)>=0},d.prototype.bindButtonEvents=function(){this.bindDropdownEvents(),this.bindCommandEvents(this.$bttn_wrapper)},d.prototype.bindDropdownEvents=function(){var a=this;this.$bttn_wrapper.on(this.mousedown,".fr-dropdown .fr-trigger:not([disabled])",function(c){return"mousedown"===c.type&&1!==c.which?!0:("LI"===this.tagName&&"touchstart"===c.type&&a.android()||a.iOS()||c.preventDefault(),void e(this).attr("data-down",!0))}),this.$bttn_wrapper.on(this.mouseup,".fr-dropdown .fr-trigger:not([disabled])",function(g){if(a.isDisabled){return !1}if(g.stopPropagation(),g.preventDefault(),!e(this).attr("data-down")){return e("[data-down]").removeAttr("data-down"),!1}e("[data-down]").removeAttr("data-down"),a.options.inlineMode===!1&&a.hide(),e(this).toggleClass("active").trigger("blur"),a.closeImageMode(),a.imageMode=!1;var c,b=e(this).attr("data-name");return d.commands[b]?c=d.commands[b].refreshOnShow:a.options.customDropdowns[b]&&(c=a.options.customDropdowns[b].refreshOnShow),c&&c.call(a),a.$bttn_wrapper.find(".fr-dropdown").not(e(this).parent()).find(".fr-trigger").removeClass("active"),!1}),this.$bttn_wrapper.on(this.mouseup,".fr-dropdown",function(b){b.stopPropagation(),b.preventDefault()}),e(window).on("mouseup selectionchange",e.proxy(function(){return this.isDisabled?!1:void this.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active")},this)),this.$element.on("mouseup","img, a",e.proxy(function(){return this.isDisabled?!1:void this.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active")},this)),this.$bttn_wrapper.on("click","li[data-cmd] > a",function(b){b.preventDefault()})},d.prototype.bindCommandEvents=function(a){var g=this;a.on(this.mousedown,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",function(c){return"mousedown"===c.type&&1!==c.which?!0:("LI"===this.tagName&&"touchstart"===c.type&&g.android()||g.iOS()||c.preventDefault(),void e(this).attr("data-down",!0))}),a.on(this.mouseup+" "+this.move,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",e.proxy(function(c){if(g.isDisabled){return !1}if("mouseup"===c.type&&1!==c.which){return !0}var o=c.currentTarget;if("touchmove"!=c.type){if(c.stopPropagation(),c.preventDefault(),!e(o).attr("data-down")){return e("[data-down]").removeAttr("data-down"),!1}if(e("[data-down]").removeAttr("data-down"),e(o).data("dragging")){return e(o).removeData("dragging"),!1}var n=e(o).data("timeout");n&&(clearTimeout(n),e(o).removeData("timeout"));var m=e(o).data("callback");if(m){g[m]()}else{var l=e(o).attr("data-cmd"),k=e(o).attr("data-val"),j=e(o).attr("data-param");g.exec(l,k,j),g.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active")}return !1}e(o).data("timeout")||e(o).data("timeout",setTimeout(function(){e(o).data("dragging",!0)},200))},this))},d.prototype.undo=function(){if(this.no_verify=!0,this.undoIndex>1){clearTimeout(this.typingTimer);var g=this.getHTML(),c=this.undoStack[--this.undoIndex-1];this.$element.html(c),this.restoreSelectionByMarkers(),this.doingRedo=!0,this.triggerEvent("undo",[this.getHTML(),g]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},d.prototype.redo=function(){if(this.no_verify=!0,this.undoIndex<this.undoStack.length){clearTimeout(this.typingTimer);var g=this.getHTML(),c=this.undoStack[this.undoIndex++];this.$element.html(c),this.restoreSelectionByMarkers(),this.doingRedo=!0,this.triggerEvent("redo",[this.getHTML(),g]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},d.prototype.save=function(){if(!this.triggerEvent("beforeSave",[],!1)){return !1}if(this.options.saveURL){var a={};for(var h in this.options.saveParams){var g=this.options.saveParams[h];a[h]="function"==typeof g?g.call(this):g}e.ajax({type:this.options.saveRequestType,url:this.options.saveURL,data:e.extend({body:this.getHTML(!1,!0)},this.options.saveParams),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(e.proxy(function(b){this.triggerEvent("afterSave",[b])},this)).fail(e.proxy(function(){this.triggerEvent("saveError",["Save request failed on the server."])},this))}else{this.triggerEvent("saveError",["Missing save URL."])}},d.prototype.sanitizeURL=function(g){if(/^https?:\/\//.test(g)){g=String(g).replace(/</g,"%3C").replace(/>/g,"%3E").replace(/"/g,"%22").replace(/ /g,"%20");var c=/\(?(?:(http|https|ftp):\/\/)?(?:((?:[^\W\s]|\.|-|[:]{1})+)@{1})?((?:www.)?(?:[^\W\s]|\.|-)+[\.][^\W\s]{2,4}|(?:www.)?(?:[^\W\s]|\.|-)|localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::(\d*))?([\/]?[^\s\?]*[\/]{1})*(?:\/?([^\s\n\?\[\]\{\}\#]*(?:(?=\.)){1}|[^\s\n\?\[\]\{\}\.\#]*)?([\.]{1}[^\s\?\#]*)?)?(?:\?{1}([^\s\n\#\[\]]*))?([\#][^\s\n]*)?\)?/gi;if(!c.test(g)){return""}}else{g=encodeURIComponent(g).replace(/%23/g,"#").replace(/%2F/g,"/").replace(/%25/g,"%").replace(/mailto%3A/g,"mailto:").replace(/tel%3A/g,"tel:").replace(/data%3Aimage/g,"data:image").replace(/webkit-fake-url%3A/g,"webkit-fake-url:").replace(/%3F/g,"?").replace(/%3D/g,"=").replace(/%26/g,"&").replace(/&amp;/g,"&").replace(/%2C/g,",").replace(/%3B/g,";").replace(/%2B/g,"+").replace(/%40/g,"@")}return g},d.prototype.option=function(a,g){if(void 0===a){return this.options}if(a instanceof Object){this.options=e.extend({},this.options,a),this.initOptions(),this.setCustomText(),this.setLanguage()}else{if(void 0===g){return this.options[a]}switch(this.options[a]=g,a){case"direction":this.setDirection();break;case"height":case"width":case"minHeight":case"maxHeight":this.setDimensions();break;case"spellcheck":this.setSpellcheck();break;case"placeholder":this.setPlaceholder();break;case"customText":this.setCustomText();break;case"language":this.setLanguage();break;case"textNearImage":this.setTextNearImage();break;case"zIndex":this.setZIndex();break;case"theme":this.setTheme()}}};var f=e.fn.editable;e.fn.editable=function(h){for(var g=[],b=0;b<arguments.length;b++){g.push(arguments[b])}if("string"==typeof h){var a=[];return this.each(function(){var c=e(this),j=c.data("fa.editable");if(!j[h]){return e.error("Method "+h+" does not exist in Froala Editor.")}var i=j[h].apply(j,g.slice(1));void 0===i?a.push(this):0===a.length&&a.push(i)}),1==a.length?a[0]:a}return"object"!=typeof h&&h?void 0:this.each(function(){var j=this,i=e(j),c=i.data("fa.editable");c||i.data("fa.editable",c=new d(j,h))})},e.fn.editable.Constructor=d,e.Editable=d,e.fn.editable.noConflict=function(){return e.fn.editable=f,this}}(window.jQuery),function(b){b.Editable.prototype.refreshButtons=function(a){return this.selectionInEditor()&&!this.isHTML||this.browser.msie&&b.Editable.getIEversion()<9||a?(this.$editor.find("button[data-cmd]").removeClass("active"),this.refreshDisabledState(),void this.raiseEvent("refresh")):!1},b.Editable.prototype.refreshDisabledState=function(){for(var a=0;a<this.options.buttons.length;a++){var f=this.options.buttons[a];if(void 0!==b.Editable.commands[f]){var e=!1;b.isFunction(b.Editable.commands[f].disabled)?e=b.Editable.commands[f].disabled.apply(this):void 0!==b.Editable.commands[f].disabled&&(e=!0),e?(this.$editor.find('button[data-cmd="'+f+'"]').prop("disabled",!0),this.$editor.find('button[data-name="'+f+'"]').prop("disabled",!0)):(this.$editor.find('button[data-cmd="'+f+'"]').removeAttr("disabled"),this.$editor.find('button[data-name="'+f+'"]').removeAttr("disabled"))}}},b.Editable.prototype.refreshFormatBlocks=function(){var d=this.getSelectionElements()[0],c=d.tagName.toLowerCase();this.options.paragraphy&&"p"===c&&(c="n"),this.$editor.find('.fr-bttn > button[data-name="formatBlock"] + ul li').removeClass("active"),this.$bttn_wrapper.find('.fr-bttn > button[data-name="formatBlock"] + ul li[data-val="'+c+'"]').addClass("active")},b.Editable.prototype.refreshUndo=function(){if(this.isEnabled("undo")){if(void 0===this.$editor){return}this.$bttn_wrapper.find('[data-cmd="undo"]').removeAttr("disabled"),(0===this.undoStack.length||this.undoIndex<=1||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="undo"]').prop("disabled",!0)}},b.Editable.prototype.refreshRedo=function(){if(this.isEnabled("redo")){if(void 0===this.$editor){return}this.$bttn_wrapper.find('[data-cmd="redo"]').removeAttr("disabled"),(this.undoIndex==this.undoStack.length||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="redo"]').prop("disabled",!0)}},b.Editable.prototype.refreshDefault=function(d){try{document.queryCommandState(d)===!0&&this.$editor.find('[data-cmd="'+d+'"]').addClass("active")}catch(c){}},b.Editable.prototype.refreshAlign=function(){var a=b(this.getSelectionElements()[0]);this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li').removeClass("active");var f,e=a.css("text-align");["left","right","justify","center"].indexOf(e)<0&&(e="left"),"left"==e?f="justifyLeft":"right"==e?f="justifyRight":"justify"==e?f="justifyFull":"center"==e&&(f="justifyCenter"),this.$editor.find('.fr-dropdown > button[data-name="align"].fr-trigger i').attr("class","fa fa-align-"+e),this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li[data-val="'+f+'"]').addClass("active")},b.Editable.prototype.refreshHTML=function(){this.isActive("html")?this.$editor.find('[data-cmd="html"]').addClass("active"):this.$editor.find('[data-cmd="html"]').removeClass("active")}}(jQuery),function(b){b.Editable.commands={bold:{title:"Bold",icon:"fa fa-bold",shortcut:"(Ctrl + B)",refresh:b.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(c){this._startInDefault(c)}},italic:{title:"Italic",icon:"fa fa-italic",shortcut:"(Ctrl + I)",refresh:b.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(c){this._startInDefault(c)}},underline:{cmd:"underline",title:"Underline",icon:"fa fa-underline",shortcut:"(Ctrl + U)",refresh:b.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(c){this._startInDefault(c)}},strikeThrough:{title:"Strikethrough",icon:"fa fa-strikethrough",refresh:b.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(c){this._startInDefault(c)}},subscript:{title:"Subscript",icon:"fa fa-subscript",refresh:b.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(c){this._startInDefault(c)}},superscript:{title:"Superscript",icon:"fa fa-superscript",refresh:b.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(c){this._startInDefault(c)}},formatBlock:{title:"Format Block",icon:"fa fa-paragraph",refreshOnShow:b.Editable.prototype.refreshFormatBlocks,callback:function(d,c){this.formatBlock(c)},undo:!0},align:{title:"Alignment",icon:"fa fa-align-left",refresh:b.Editable.prototype.refreshAlign,refreshOnShow:b.Editable.prototype.refreshAlign,seed:[{cmd:"justifyLeft",title:"Align Left",icon:"fa fa-align-left"},{cmd:"justifyCenter",title:"Align Center",icon:"fa fa-align-center"},{cmd:"justifyRight",title:"Align Right",icon:"fa fa-align-right"},{cmd:"justifyFull",title:"Justify",icon:"fa fa-align-justify"}],callback:function(d,c){this.align(c)},undo:!0},outdent:{title:"Indent Less",icon:"fa fa-dedent",activeless:!0,shortcut:"(Ctrl + <)",callback:function(){this.outdent(!0)},undo:!0},indent:{title:"Indent More",icon:"fa fa-indent",activeless:!0,shortcut:"(Ctrl + >)",callback:function(){this.indent()},undo:!0},selectAll:{title:"Select All",icon:"fa fa-file-text",shortcut:"(Ctrl + A)",callback:function(d,c){this.$element.focus(),this.execDefault(d,c)},undo:!1},createLink:{title:"Insert Link",icon:"fa fa-link",shortcut:"(Ctrl + K)",callback:function(){this.insertLink()},undo:!1},insertImage:{title:"Insert Image",icon:"fa fa-picture-o",activeless:!0,shortcut:"(Ctrl + P)",callback:function(){this.insertImage()},undo:!1},undo:{title:"Undo",icon:"fa fa-undo",activeless:!0,shortcut:"(Ctrl+Z)",refresh:b.Editable.prototype.refreshUndo,callback:function(){this.undo()},undo:!1},redo:{title:"Redo",icon:"fa fa-repeat",activeless:!0,shortcut:"(Shift+Ctrl+Z)",refresh:b.Editable.prototype.refreshRedo,callback:function(){this.redo()},undo:!1},html:{title:"Show HTML",icon:"fa fa-code",refresh:b.Editable.prototype.refreshHTML,callback:function(){this.html()},undo:!1},save:{title:"Save",icon:"fa fa-floppy-o",callback:function(){this.save()},undo:!1},insertHorizontalRule:{title:"Insert Horizontal Line",icon:"fa fa-minus",callback:function(c){this.insertHR(c)},undo:!0},removeFormat:{title:"Clear formatting",icon:"fa fa-eraser",activeless:!0,callback:function(){this.removeFormat()},undo:!0}},b.Editable.prototype.exec=function(a,f,e){return !this.selectionInEditor()&&b.Editable.commands[a].undo&&this.focus(),this.selectionInEditor()&&""===this.text()&&b.Editable.commands[a].callbackWithoutSelection?(b.Editable.commands[a].callbackWithoutSelection.apply(this,[a,f,e]),!1):void (b.Editable.commands[a].callback?b.Editable.commands[a].callback.apply(this,[a,f,e]):this.execDefault(a,f))},b.Editable.prototype.html=function(){var c;this.isHTML?(this.isHTML=!1,c=this.$html_area.val(),c=this.clean(c,!0,!1),this.$box.removeClass("f-html"),this.$html_area.blur(),this.no_verify=!0,this.$element.html(c),this.cleanupLists(),this.cleanify(!1),this.no_verify=!1,this.$element.attr("contenteditable",!0),this.$editor.find('.fr-bttn:not([data-cmd="html"]), .fr-trigger').removeAttr("disabled"),this.$editor.find('.fr-bttn[data-cmd="html"]').removeClass("active"),this.options.paragraphy&&this.wrapText(),this.$element.blur(),this.focus(),this.refreshButtons(),this.triggerEvent("htmlHide",[c],!0,!0)):(this.$box.removeClass("f-placeholder"),this.cleanify(!1),c=this.options.inlineMode?"\n\n"+this.cleanTags(this.getHTML(!1,!1)):this.cleanTags(this.getHTML(!1,!1)),c=c.replace(/\&amp;/g,"&"),this.$html_area.val(c).trigger("resize"),this.$html_area.css("height",this.$element.height()-1),this.$element.html("").append(this.$html_area).removeAttr("contenteditable"),this.$box.addClass("f-html"),this.$editor.find('button.fr-bttn:not([data-cmd="html"]), button.fr-trigger').attr("disabled",!0),this.$editor.find('.fr-bttn[data-cmd="html"]').addClass("active"),this.hide(),this.imageMode=!1,this.isHTML=!0,this.$element.blur(),this.$element.removeAttr("contenteditable"),this.triggerEvent("htmlShow",[c],!0,!1))},b.Editable.prototype.insertHR=function(a){this.$element.find("hr").addClass("fr-tag"),this.$element.hasClass("f-placeholder")?b(this.$element.find("> "+this.valid_nodes.join(", >"))[0]).before("<hr/>"):document.execCommand(a),this.hide();var d=this.$element.find("hr:not(.fr-tag)").next(this.valid_nodes.join(","));d.length>0?b(d[0]).prepend(this.markers_html):this.$element.find("hr:not(.fr-tag)").after(this.options.paragraphy?"<p>"+this.markers_html+"<br/></p>":this.markers_html),this.restoreSelectionByMarkers(),this.triggerEvent(a,[],!0,!1)},b.Editable.prototype.formatBlock=function(D,C,B){if(this.disabledList.indexOf("formatBlock")>=0){return !1}if(this.browser.msie&&b.Editable.getIEversion()<9){return"n"==D&&(D=this.options.paragraphy?"p":"div"),document.execCommand("formatBlock",!1,"<"+D+">"),this.triggerEvent("formatBlock"),!1}this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var A=this.getSelectionElements();A[0]==this.$element.get(0)&&(A=this.$element.find("> "+this.valid_nodes.join(", >"))),this.saveSelectionByMarkers();for(var z,y=function(c){return c.get&&["LI","TD","TH"].indexOf(c.get(0).tagName)>=0?!0:!1},x=0;x<A.length;x++){var w=b(A[x]);if(!this.fakeEmpty(w)){if(z="n"==D?this.options.paragraphy?b("<p>").html(w.html()):w.html()+"<br/>":b("<"+D+">").html(w.html()),w.get(0)==this.$element.get(0)||y(z)){w.html(z)}else{var v=w.prop("attributes");if(z.attr){for(var u=0;u<v.length;u++){"class"!==v[u].name&&z.attr(v[u].name,v[u].value)}}var t;this.options.blockStyles&&this.options.blockStyles[D],void 0===t&&(t=this.options.defaultBlockStyle);try{if(w.hasClass(C)&&w.get(0).tagName.toLowerCase()===D){z.addClass(w.attr("class")).removeClass(C)}else{if(void 0===w.attr("class")||void 0===t||!this.options.blockStylesToggle&&"toggle"!=B){z.addClass(w.attr("class"))}else{for(var s=w.attr("class").split(" "),r=0;r<s.length;r++){var q=s[r];void 0===t[q]&&void 0===B?z.addClass(q):void 0!==t[q]&&"toggle"===B&&z.addClass(q),w.get(0).tagName.toLowerCase()!==D&&void 0!==t[q]&&z.addClass(q)}}"*"!=C&&z.addClass(C)}}catch(a){}y(w)?w.html(z):w.replaceWith(z)}}}this.unwrapText(),this.restoreSelectionByMarkers(),this.triggerEvent("formatBlock"),this.repositionEditor()},b.Editable.prototype.align=function(a){if(this.browser.msie&&b.Editable.getIEversion()<9){return document.execCommand(a,!1,!1),this.triggerEvent("align",[a]),!1}this.saveSelectionByMarkers();var f=this.getSelectionElements();"justifyLeft"==a?a="left":"justifyRight"==a?a="right":"justifyCenter"==a?a="center":"justifyFull"==a&&(a="justify");for(var e=0;e<f.length;e++){b(f[e]).css("text-align",a)}this.repositionEditor(),this.restoreSelectionByMarkers(),this.triggerEvent("align",[a])},b.Editable.prototype.indent=function(a){if(this.browser.msie&&b.Editable.getIEversion()<9){return a?document.execCommand("outdent",!1,!1):document.execCommand("indent",!1,!1),!1}var p=20;a&&(p=-20),this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var o=this.getSelectionElements();this.saveSelectionByMarkers();for(var n=0;n<o.length;n++){var m=b(o[n]);if(m.parentsUntil(this.$element,"li").length>0&&(m=m.closest("li")),"LI"===m.get(0).tagName&&b.isFunction(this.indentLi)){a?this.outdentLi(m):this.indentLi(m)}else{if(m.get(0)!=this.$element.get(0)){var l=parseInt(m.css("margin-left").replace(/px/,""),10),k=Math.max(0,l+p);m.css("marginLeft",k)}else{var j=b("<div>").html(m.html());m.html(j),j.css("marginLeft",Math.max(0,p))}}}this.cleanupLists(),this.options.paragraphy&&this.wrapText(!0),this.unwrapText(),this.restoreSelectionByMarkers(),this.repositionEditor(),a||this.triggerEvent("indent")},b.Editable.prototype.outdent=function(){this.indent(!0),this.triggerEvent("outdent")},b.Editable.prototype.execDefault=function(d,c){document.execCommand(d,!1,c),this.triggerEvent(d,[],!0,!0)},b.Editable.prototype._startInDefault=function(c){this.focus(),document.execCommand(c,!1,!1),this.refreshButtons()},b.Editable.prototype._startInFontExec=function(a,n,m){this.focus();try{var l=this.getRange(),k=l.cloneRange();k.collapse(!1);var j=b('<span data-inserted="true" data-fr-verified="true" style="'+a+": "+m+';">&#8203;</span>',document);k.insertNode(j[0]),j=this.$element.find("[data-inserted]"),j.removeAttr("data-inserted"),this.setSelection(j.get(0),1)}catch(i){}},b.Editable.prototype.removeFormat=function(){document.execCommand("removeFormat",!1,!1),document.execCommand("unlink",!1,!1)},b.Editable.prototype.inlineStyle=function(a,j,i){if(this.browser.webkit&&"font-size"!=a){var h=function(c){return c.attr("style").indexOf("font-size")>=0};this.$element.find("span").each(function(e,k){var f=b(k);f.attr("style")&&h(f)&&(f.data("font-size",f.css("font-size")),f.css("font-size",""))})}document.execCommand("fontSize",!1,4),this.saveSelectionByMarkers(),this.browser.webkit&&"font-size"!=a&&this.$element.find("span").each(function(e,k){var f=b(k);f.data("font-size")&&(f.css("font-size",f.data("font-size")),f.removeData("font-size"))});var g=function(l,k){var d=b(k);d.css(a)!=i&&d.css(a,""),""===d.attr("style")&&d.replaceWith(d.html())};this.$element.find("font").each(function(k,f){var d=b('<span data-fr-verified="true" style="'+a+": "+i+';">'+b(f).html()+"</span>");b(f).replaceWith(d),d.find("span").each(g)}),this.restoreSelectionByMarkers(),this.repositionEditor(),this.triggerEvent(j,[i],!0,!0)}}(jQuery),function(b){b.Editable.prototype.addListener=function(f,e){var h=this._events,g=h[f]=h[f]||[];g.push(e)},b.Editable.prototype.raiseEvent=function(i,h){void 0===h&&(h=[]);var n=!0,m=this._events[i];if(m){for(var l=0,k=m.length;k>l;l++){var j=m[l].apply(this,h);void 0!==j&&n!==!1&&(n=j)}}return void 0===n&&(n=!0),n}}(jQuery),function(b){b.Editable.prototype.markers_html='<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>',b.Editable.prototype.text=function(){var c="";return window.getSelection?c=window.getSelection():document.getSelection?c=document.getSelection():document.selection&&(c=document.selection.createRange().text),c.toString()},b.Editable.prototype.selectionInEditor=function(){var a=this.getSelectionParent(),d=!1;return a==this.$element.get(0)&&(d=!0),d===!1&&b(a).parents().each(b.proxy(function(e,c){c==this.$element.get(0)&&(d=!0)},this)),d},b.Editable.prototype.getSelection=function(){var c="";return c=window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection.createRange()},b.Editable.prototype.getRange=function(){var c=this.getRanges();return c.length>0?c[0]:null},b.Editable.prototype.getRanges=function(){var e=this.getSelection();if(e.getRangeAt&&e.rangeCount){for(var d=[],f=0;f<e.rangeCount;f++){d.push(e.getRangeAt(f))}return d}return document.createRange?[document.createRange()]:[]},b.Editable.prototype.clearSelection=function(){var d=this.getSelection();try{d.removeAllRanges?d.removeAllRanges():d.empty?d.empty():d.clear&&d.clear()}catch(c){}},b.Editable.prototype.getSelectionElement=function(){var a=this.getSelection();if(a.rangeCount){var j=this.getRange(),i=j.startContainer;1!=i.nodeType&&(i=i.parentNode);var h=!1;i.children.length>0&&i.children[j.startOffset]&&b(i.children[j.startOffset]).text()===this.text()&&(i=i.children[j.startOffset],h=!0),!h&&i.children.length>0&&b(i.children[0]).text()===this.text()&&["BR","IMG"].indexOf(i.children[0].tagName)<0&&(i=i.children[0]);for(var g=i;g&&"BODY"!=g.tagName;){if(g==this.$element.get(0)){return i}g=b(g).parent()[0]}}return this.$element.get(0)},b.Editable.prototype.getSelectionParent=function(){var a,d=null;return window.getSelection?(a=window.getSelection(),a.rangeCount&&(d=a.getRangeAt(0).commonAncestorContainer,1!=d.nodeType&&(d=d.parentNode))):(a=document.selection)&&"Control"!=a.type&&(d=a.createRange().parentElement()),null!=d&&(b.inArray(this.$element.get(0),b(d).parents())>=0||d==this.$element.get(0))?d:null},b.Editable.prototype.nodeInRange=function(f,e){var h;if(f.intersectsNode){return f.intersectsNode(e)}h=e.ownerDocument.createRange();try{h.selectNode(e)}catch(g){h.selectNodeContents(e)}return -1==f.compareBoundaryPoints(Range.END_TO_START,h)&&1==f.compareBoundaryPoints(Range.START_TO_END,h)},b.Editable.prototype.getElementFromNode=function(a){for(1!=a.nodeType&&(a=a.parentNode);null!==a&&this.valid_nodes.indexOf(a.tagName)<0;){a=a.parentNode}return null!=a&&"LI"==a.tagName&&b(a).find(this.valid_nodes.join(",")).length>0?null:b.makeArray(b(a).parents()).indexOf(this.$element.get(0))>=0?a:null},b.Editable.prototype.nextNode=function(d,c){if(d.hasChildNodes()){return d.firstChild}for(;d&&!d.nextSibling&&d!=c;){d=d.parentNode}return d&&d!=c?d.nextSibling:null},b.Editable.prototype.getRangeSelectedNodes=function(r){var q=[],p=r.startContainer,o=r.endContainer;if(p==o&&"TR"!=p.tagName){if(p.hasChildNodes()&&0!==p.children.length){for(var n=p.children,m=r.startOffset;m<r.endOffset;m++){n[m]&&q.push(n[m])}return 0===q.length&&q.push(p),q}return[p]}if(p==o&&"TR"==p.tagName){var l=p.childNodes,k=r.startOffset;if(l.length>k&&k>=0){var j=l[k];if("TD"==j.tagName||"TH"==j.tagName){return[j]}}}for(;p&&p!=o;){q.push(p=this.nextNode(p,o))}for(p=r.startContainer;p&&p!=r.commonAncestorContainer;){q.unshift(p),p=p.parentNode}return q},b.Editable.prototype.getSelectedNodes=function(){if(window.getSelection){var a=window.getSelection();if(!a.isCollapsed){for(var j=this.getRanges(),i=[],h=0;h<j.length;h++){i=b.merge(i,this.getRangeSelectedNodes(j[h]))}return i}if(this.selectionInEditor()){var g=a.getRangeAt(0).startContainer;return 3==g.nodeType?[g.parentNode]:[g]}}return[]},b.Editable.prototype.getSelectionElements=function(){var a=this.getSelectedNodes(),d=[];return b.each(a,b.proxy(function(e,c){if(null!==c){var f=this.getElementFromNode(c);d.indexOf(f)<0&&f!=this.$element.get(0)&&null!==f&&d.push(f)}},this)),0===d.length&&d.push(this.$element.get(0)),d},b.Editable.prototype.getSelectionLink=function(){var a=this.getSelectionLinks();return a.length>0?b(a[0]).attr("href"):null},b.Editable.prototype.saveSelection=function(){if(!this.selectionDisabled){this.savedRanges=[];for(var d=this.getRanges(),c=0;c<d.length;c++){this.savedRanges.push(d[c].cloneRange())}}},b.Editable.prototype.restoreSelection=function(){if(!this.selectionDisabled){var e,d,f=this.getSelection();if(this.savedRanges&&this.savedRanges.length){for(f.removeAllRanges(),e=0,d=this.savedRanges.length;d>e;e+=1){f.addRange(this.savedRanges[e])}}}},b.Editable.prototype.insertMarkersAtPoint=function(j){var i=j.clientX,p=j.clientY;this.removeMarkers();var o,n=null;if("undefined"!=typeof document.caretPositionFromPoint?(o=document.caretPositionFromPoint(i,p),n=document.createRange(),n.setStart(o.offsetNode,o.offset),n.setEnd(o.offsetNode,o.offset)):"undefined"!=typeof document.caretRangeFromPoint&&(o=document.caretRangeFromPoint(i,p),n=document.createRange(),n.setStart(o.startContainer,o.startOffset),n.setEnd(o.startContainer,o.startOffset)),null!==n&&"undefined"!=typeof window.getSelection){var m=window.getSelection();m.removeAllRanges(),m.addRange(n)}else{if("undefined"!=typeof document.body.createTextRange){try{n=document.body.createTextRange(),n.moveToPoint(i,p);var l=n.duplicate();l.moveToPoint(i,p),n.setEndPoint("EndToEnd",l),n.select()}catch(k){}}}this.placeMarker(n,!0,0),this.placeMarker(n,!1,0)},b.Editable.prototype.saveSelectionByMarkers=function(){if(!this.selectionDisabled){this.selectionInEditor()||this.focus(),this.removeMarkers();for(var e=this.getRanges(),d=0;d<e.length;d++){if(e[d].startContainer!==document){var f=e[d];this.placeMarker(f,!0,d),this.placeMarker(f,!1,d)}}}},b.Editable.prototype.hasSelectionByMarkers=function(){var c=this.$element.find('.f-marker[data-type="true"]');return c.length>0?!0:!1},b.Editable.prototype.restoreSelectionByMarkers=function(r){if(void 0===r&&(r=!0),!this.selectionDisabled){var q=this.$element.find('.f-marker[data-type="true"]');if(0===q.length){return !1}this.$element.is(":focus")||this.browser.msie||this.$element.focus();var p=this.getSelection();(r||this.getRange()&&!this.getRange().collapsed||!b(q[0]).attr("data-collapsed"))&&(this.browser.msie&&b.Editable.getIEversion()<9||(this.clearSelection(),r=!0));for(var o=0;o<q.length;o++){var n=b(q[o]).data("id"),m=q[o],l=this.$element.find('.f-marker[data-type="false"][data-id="'+n+'"]');if(this.browser.msie&&b.Editable.getIEversion()<9){return this.setSelection(m,0,l,0),this.removeMarkers(),!1}var k;if(k=r?document.createRange():this.getRange(),l.length>0){l=l[0];try{k.setStartAfter(m),k.setEndBefore(l)}catch(a){}}r&&p.addRange(k)}this.removeMarkers()}},b.Editable.prototype.setSelection=function(i,h,n,m){var l=this.getSelection();if(l){this.clearSelection();try{n||(n=i),void 0===h&&(h=0),void 0===m&&(m=h);var k=this.getRange();k.setStart(i,h),k.setEnd(n,h),l.addRange(k)}catch(j){}}},b.Editable.prototype.buildMarker=function(a,f,e){return void 0===e&&(e=""),b('<span class="f-marker"'+e+' style="display:none; line-height: 0;" data-fr-verified="true" data-id="'+f+'" data-type="'+a+'">',document)[0]},b.Editable.prototype.placeMarker=function(a,n,m){var l="";a.collapsed&&(l=' data-collapsed="true"');try{var k=a.cloneRange();if(k.collapse(n),k.insertNode(this.buildMarker(n,m,l)),n===!0&&l){for(var j=this.$element.find('span.f-marker[data-type="true"][data-id="'+m+'"]').get(0).nextSibling;3===j.nodeType&&0===j.data.length;){b(j).remove(),j=this.$element.find('span.f-marker[data-type="true"][data-id="'+m+'"]').get(0).nextSibling}}}catch(i){}},b.Editable.prototype.removeMarkers=function(){this.$element.find(".f-marker").remove()},b.Editable.prototype.getSelectionTextInfo=function(h){var g,l,k=!1,j=!1;if(window.getSelection){var i=window.getSelection();i.rangeCount&&(g=i.getRangeAt(0),l=g.cloneRange(),l.selectNodeContents(h),l.setEnd(g.startContainer,g.startOffset),k=""===l.toString(),l.selectNodeContents(h),l.setStart(g.endContainer,g.endOffset),j=""===l.toString())}else{document.selection&&"Control"!=document.selection.type&&(g=document.selection.createRange(),l=g.duplicate(),l.moveToElementText(h),l.setEndPoint("EndToStart",g),k=""===l.text,l.moveToElementText(h),l.setEndPoint("StartToEnd",g),j=""===l.text)}return{atStart:k,atEnd:j}},b.Editable.prototype.endsWith=function(d,c){return -1!==d.indexOf(c,d.length-c.length)}}(jQuery),function(b){b.Editable.hexToRGB=function(e){var d=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(d,function(h,g,j,i){return g+g+j+j+i+i});var f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return f?{r:parseInt(f[1],16),g:parseInt(f[2],16),b:parseInt(f[3],16)}:null},b.Editable.hexToRGBString=function(d){var c=this.hexToRGB(d);return c?"rgb("+c.r+", "+c.g+", "+c.b+")":""},b.Editable.RGBToHex=function(e){function d(c){return("0"+parseInt(c,10).toString(16)).slice(-2)}try{return e&&"transparent"!==e?/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),("#"+d(e[1])+d(e[2])+d(e[3])).toUpperCase()):""}catch(f){return null}},b.Editable.getIEversion=function(){var e,d,f=-1;return"Microsoft Internet Explorer"==navigator.appName?(e=navigator.userAgent,d=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),null!==d.exec(e)&&(f=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(e=navigator.userAgent,d=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),null!==d.exec(e)&&(f=parseFloat(RegExp.$1))),f},b.Editable.browser=function(){var f={};if(this.getIEversion()>0){f.msie=!0}else{var e=navigator.userAgent.toLowerCase(),h=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],g={browser:h[1]||"",version:h[2]||"0"};h[1]&&(f[g.browser]=!0),parseInt(g.version,10)<9&&f.msie&&(f.oldMsie=!0),f.chrome?f.webkit=!0:f.webkit&&(f.safari=!0)}return f},b.Editable.isArray=function(c){return c&&!c.propertyIsEnumerable("length")&&"object"==typeof c&&"number"==typeof c.length},b.Editable.uniq=function(a){return b.grep(a,function(f,e){return e==b.inArray(f,a)})}}(jQuery),function(b){b.Editable.prototype.show=function(a){if(void 0!==a){if(this.options.inlineMode||this.options.editInPopup){if(null!==a&&"touchend"!==a.type){var f=a.pageX,e=a.pageY;f<this.$element.offset().left&&(f=this.$element.offset().left),f>this.$element.offset().left+this.$element.width()&&(f=this.$element.offset().left+this.$element.width()),e<this.$element.offset.top&&(e=this.$element.offset().top),e>this.$element.offset().top+this.$element.height()&&(e=this.$element.offset().top+this.$element.height()),20>f&&(f=20),0>e&&(e=0),this.showByCoordinates(f,e),b(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),0!==this.options.buttons.length||this.options.editInPopup||this.$editor.hide()}else{b(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),this.repositionEditor()}}this.hidePopups(),this.options.editInPopup||this.showEditPopupWrapper(),this.$bttn_wrapper.show(),this.refreshButtons(),this.imageMode=!1}},b.Editable.prototype.hideDropdowns=function(){this.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active"),this.$bttn_wrapper.find(".fr-dropdown .fr-trigger")},b.Editable.prototype.hide=function(c){return this.initialized?(void 0===c&&(c=!0),c?this.hideOtherEditors():(this.closeImageMode(),this.imageMode=!1),this.$popup_editor.hide(),this.hidePopups(!1),this.hideDropdowns(),void (this.link=!1)):!1},b.Editable.prototype.hideOtherEditors=function(){for(var a=1;a<=b.Editable.count;a++){a!=this._id&&b(window).trigger("hide."+a)}},b.Editable.prototype.hideBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.hide()},b.Editable.prototype.showBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.show()},b.Editable.prototype.showEditPopupWrapper=function(){this.$edit_popup_wrapper&&(this.$edit_popup_wrapper.show(),setTimeout(b.proxy(function(){this.$edit_popup_wrapper.find("input").val(this.$element.text()).focus().select()},this),1))},b.Editable.prototype.hidePopups=function(c){void 0===c&&(c=!0),c&&this.hideBttnWrapper(),this.raiseEvent("hidePopups")},b.Editable.prototype.showEditPopup=function(){this.showEditPopupWrapper()}}(jQuery),function(b){b.Editable.prototype.getBoundingRect=function(){var a;if(this.isLink){a={};var j=this.$element;a.left=j.offset().left-b(window).scrollLeft(),a.top=j.offset().top-b(window).scrollTop(),a.width=j.outerWidth(),a.height=parseInt(j.css("padding-top").replace("px",""),10)+j.height(),a.right=1,a.bottom=1,a.ok=!0}else{if(this.getRange()&&this.getRange().collapsed){var i=b(this.getSelectionElement());this.saveSelectionByMarkers();var h=this.$element.find(".f-marker:first");h.css("display","inline");var g=h.offset();h.css("display","none"),a={},a.left=g.left-b(window).scrollLeft(),a.width=0,a.height=(parseInt(i.css("line-height").replace("px",""),10)||10)-10-b(window).scrollTop(),a.top=g.top,a.right=1,a.bottom=1,a.ok=!0,this.removeMarkers()}else{this.getRange()&&(a=this.getRange().getBoundingClientRect())}}return a},b.Editable.prototype.repositionEditor=function(a){var j,i,h;if(this.options.inlineMode||a){if(j=this.getBoundingRect(),this.showBttnWrapper(),j.ok||j.left>=0&&j.top>=0&&j.right>0&&j.bottom>0){i=j.left+j.width/2,h=j.top+j.height,this.iOS()&&this.iOSVersion()<8||(i+=b(window).scrollLeft(),h+=b(window).scrollTop()),this.showByCoordinates(i,h)}else{if(this.options.alwaysVisible){this.hide()}else{var g=this.$element.offset();this.showByCoordinates(g.left,g.top+10)}}0===this.options.buttons.length&&this.hide()}},b.Editable.prototype.showByCoordinates=function(a,f){a-=20,f+=15;var e=Math.max(this.$popup_editor.width(),250);a+e>=b(window).width()-50&&a+40-e>0?(this.$popup_editor.addClass("right-side"),a=b(window).width()-(a+40),this.$popup_editor.css("top",f),this.$popup_editor.css("right",a),this.$popup_editor.css("left","auto")):a+e<b(window).width()-50?(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",f),this.$popup_editor.css("left",a),this.$popup_editor.css("right","auto")):(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",f),this.$popup_editor.css("left",Math.max(b(window).width()-e,10)/2),this.$popup_editor.css("right","auto")),this.$popup_editor.show()},b.Editable.prototype.positionPopup=function(a){if(b(this.$editor.find('button.fr-bttn[data-cmd="'+a+'"]')).length){var l=this.$editor.find('button.fr-bttn[data-cmd="'+a+'"]'),k=l.width(),j=l.height()-15,i=l.offset().left+k/2,h=l.offset().top+j;this.showByCoordinates(i,h)}}}(jQuery),function(b){b.Editable.image_commands={floatImageLeft:{title:"Float Left",icon:{type:"font",value:"fa fa-align-left"}},floatImageNone:{title:"Float None",icon:{type:"font",value:"fa fa-align-justify"}},floatImageRight:{title:"Float Right",icon:{type:"font",value:"fa fa-align-right"}},linkImage:{title:"Insert Link",icon:{type:"font",value:"fa fa-link"}},replaceImage:{title:"Replace Image",icon:{type:"font",value:"fa fa-exchange"}},removeImage:{title:"Remove Image",icon:{type:"font",value:"fa fa-trash-o"}}},b.Editable.DEFAULTS=b.extend(b.Editable.DEFAULTS,{allowedImageTypes:["jpeg","jpg","png","gif"],defaultImageTitle:"Image title",defaultImageWidth:300,imageButtons:["floatImageLeft","floatImageNone","floatImageRight","linkImage","replaceImage","removeImage"],imageDeleteConfirmation:!0,imageDeleteURL:null,imageDeleteParams:{},imageMove:!0,imageResize:!0,imageLink:!0,imageTitle:!0,imageUpload:!0,imageUploadParams:{},imageUploadParam:"file",imageUploadToS3:!1,imageUploadURL:"http://i.froala.com/upload",maxImageSize:10485760,pasteImage:!0,textNearImage:!0}),b.Editable.prototype.hideImageEditorPopup=function(){this.$image_editor&&this.$image_editor.hide()},b.Editable.prototype.showImageEditorPopup=function(){this.$image_editor&&this.$image_editor.show(),this.options.imageMove||this.$element.attr("contenteditable",!1)},b.Editable.prototype.showImageWrapper=function(){this.$image_wrapper&&this.$image_wrapper.show()},b.Editable.prototype.hideImageWrapper=function(c){this.$image_wrapper&&(this.$element.attr("data-resize")||c||(this.closeImageMode(),this.imageMode=!1),this.$image_wrapper.hide(),this.$image_wrapper.find("input").blur())},b.Editable.prototype.showInsertImage=function(){this.hidePopups(),this.showImageWrapper()},b.Editable.prototype.showImageEditor=function(){this.hidePopups(),this.showImageEditorPopup()},b.Editable.prototype.insertImageHTML=function(){var a='<div class="froala-popup froala-image-popup" style="display: none;"><h4><span data-text="true">Insert Image</span><span data-text="true">Uploading image</span><i title="Cancel" class="fa fa-times" id="f-image-close-'+this._id+'"></i></h4>';return a+='<div id="f-image-list-'+this._id+'">',this.options.imageUpload&&(a+='<div class="f-popup-line drop-upload">',a+='<div class="f-upload" id="f-upload-div-'+this._id+'"><strong data-text="true">Drop Image</strong><br>(<span data-text="true">or click</span>)<form target="frame-'+this._id+'" enctype="multipart/form-data" encoding="multipart/form-data" action="'+this.options.imageUploadURL+'" method="post" id="f-upload-form-'+this._id+'"><input id="f-file-upload-'+this._id+'" type="file" name="'+this.options.imageUploadParam+'" accept="image/*"></form></div>',this.browser.msie&&b.Editable.getIEversion()<=9&&(a+='<iframe id="frame-'+this._id+'" name="frame-'+this._id+'" src="javascript:false;" style="width:0; height:0; border:0px solid #FFF; position: fixed; z-index: -1;"></iframe>'),a+="</div>"),this.options.imageLink&&(a+='<div class="f-popup-line"><label><span data-text="true">Enter URL</span>: </label><input id="f-image-url-'+this._id+'" type="text" placeholder="http://example.com"><button class="f-browse fr-p-bttn" id="f-browser-'+this._id+'"><i class="fa fa-search"></i></button><button data-text="true" class="f-ok fr-p-bttn" id="f-image-ok-'+this._id+'">OK</button></div>'),a+="</div>",a+='<p class="f-progress" id="f-progress-'+this._id+'"><span></span></p>',a+="</div>"},b.Editable.prototype.iFrameLoad=function(){var i=this.$image_wrapper.find("iframe#frame-"+this._id);if(!i.attr("data-loaded")){return i.attr("data-loaded",!0),!1}try{var h=this.$image_wrapper.find("#f-upload-form-"+this._id);if(this.options.imageUploadToS3){var n=h.attr("action"),m=h.find('input[name="key"]').val(),l=n+m;this.writeImage(l),this.options.imageUploadToS3.callback&&this.options.imageUploadToS3.callback.call(this,l,m)}else{var k=i.contents().text();this.parseImageResponse(k)}}catch(j){this.throwImageError(7)}},b.Editable.prototype.initImage=function(){this.buildInsertImage(),(!this.isLink||this.isImage)&&this.initImagePopup(),this.addListener("destroy",this.destroyImage)},b.Editable.initializers.push(b.Editable.prototype.initImage),b.Editable.prototype.destroyImage=function(){this.$image_editor&&this.$image_editor.html("").removeData().remove(),this.$image_wrapper&&this.$image_wrapper.html("").removeData().remove()},b.Editable.prototype.buildInsertImage=function(){this.$image_wrapper=b(this.insertImageHTML()),this.$popup_editor.append(this.$image_wrapper);var a=this;if(this.$image_wrapper.on("mouseup touchend",b.proxy(function(c){this.isResizing()||c.stopPropagation()},this)),this.addListener("hidePopups",b.proxy(function(){this.hideImageWrapper(!0)}),this),this.$progress_bar=this.$image_wrapper.find("p#f-progress-"+this._id),this.options.imageUpload){if(this.browser.msie&&b.Editable.getIEversion()<=9){var d=this.$image_wrapper.find("iframe").get(0);d.attachEvent?d.attachEvent("onload",function(){a.iFrameLoad()}):d.onload=function(){a.iFrameLoad()}}this.$image_wrapper.on("change",'input[type="file"]',function(){if(void 0!==this.files){a.uploadImage(this.files)}else{var f=b(this).parents("form");f.find('input[type="hidden"]').remove();var e;for(e in a.options.imageUploadParams){f.prepend('<input type="hidden" name="'+e+'" value="'+a.options.imageUploadParams[e]+'" />')}if(a.options.imageUploadToS3!==!1){for(e in a.options.imageUploadToS3.params){f.prepend('<input type="hidden" name="'+e+'" value="'+a.options.imageUploadToS3.params[e]+'" />')}f.prepend('<input type="hidden" name="success_action_status" value="201" />'),f.prepend('<input type="hidden" name="X-Requested-With" value="xhr" />'),f.prepend('<input type="hidden" name="Content-Type" value="" />'),f.prepend('<input type="hidden" name="key" value="'+a.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+b(this).val().match(/[^\/\\]+$/)+'" />')}else{f.prepend('<input type="hidden" name="XHR_CORS_TRARGETORIGIN" value="'+window.location.href+'" />')}a.showInsertImage(),a.showImageLoader(!0),a.disable(),f.submit()}b(this).val("")})}this.buildDragUpload(),this.$image_wrapper.on("mouseup keydown","#f-image-url-"+this._id,b.proxy(function(e){var c=e.which;c&&27===c||e.stopPropagation()},this)),this.$image_wrapper.on("click","#f-image-ok-"+this._id,b.proxy(function(){this.writeImage(this.$image_wrapper.find("#f-image-url-"+this._id).val(),!0)},this)),this.$image_wrapper.on(this.mouseup,"#f-image-close-"+this._id,b.proxy(function(c){return this.isDisabled?!1:(c.stopPropagation(),this.$bttn_wrapper.show(),this.hideImageWrapper(!0),this.options.inlineMode&&0===this.options.buttons.length&&(this.imageMode?this.showImageEditor():this.hide()),this.imageMode||(this.restoreSelection(),this.focus()),void (this.options.inlineMode||this.imageMode?this.imageMode&&this.showImageEditor():this.hide()))},this)),this.$image_wrapper.on("click",function(c){c.stopPropagation()}),this.$image_wrapper.on("click","*",function(c){c.stopPropagation()})},b.Editable.prototype.deleteImage=function(a){if(this.options.imageDeleteURL){var d=this.options.imageDeleteParams;d.info=a.data("info"),d.src=a.attr("src"),b.ajax({type:"POST",url:this.options.imageDeleteURL,data:d,crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(b.proxy(function(c){a.parent().parent().hasClass("f-image-list")?a.parent().remove():a.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteSuccess",[c],!1)},this)).fail(b.proxy(function(){a.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Error during image delete."],!1)},this))}else{a.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Missing imageDeleteURL option."],!1)}},b.Editable.prototype.imageHandle=function(){var a=this,d=b('<span data-fr-verified="true">').addClass("f-img-handle").on({movestart:function(e){a.hide(),a.$element.addClass("f-non-selectable").attr("contenteditable",!1),a.$element.attr("data-resize",!0),b(this).attr("data-start-x",e.startX),b(this).attr("data-start-y",e.startY)},move:function(l){var k=b(this),j=l.pageX-parseInt(k.attr("data-start-x"),10);k.attr("data-start-x",l.pageX),k.attr("data-start-y",l.pageY);var i=k.prevAll("img"),h=i.width();k.hasClass("f-h-ne")||k.hasClass("f-h-se")?i.attr("width",h+j):i.attr("width",h-j),a.triggerEvent("imageResize",[],!1)},moveend:function(){b(this).removeAttr("data-start-x"),b(this).removeAttr("data-start-y"),a.$element.removeClass("f-non-selectable"),a.isImage||a.$element.attr("contenteditable",!0),a.triggerEvent("imageResizeEnd"),b(this).trigger("mouseup")},touchend:function(){b(this).trigger("moveend")}});return d},b.Editable.prototype.disableImageResize=function(){if(this.browser.mozilla){try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(c){}}},b.Editable.prototype.isResizing=function(){return this.$element.attr("data-resize")},b.Editable.prototype.getImageClass=function(d){var c=d.split(" ");return c.indexOf("fr-fir")>=0?"fr-fir":c.indexOf("fr-fil")>=0?"fr-fil":"fr-fin"},b.Editable.prototype.addImageClass=function(d,c){d.removeClass("fr-fin fr-fir fr-fil").addClass(c)},b.Editable.prototype.initImageEvents=function(){document.addEventListener&&!document.dropAssigned&&(document.dropAssigned=!0,document.addEventListener("drop",b.proxy(function(c){return c.preventDefault(),c.stopPropagation(),b(".froala-element img.fr-image-move").removeClass("fr-image-move"),!1},this))),this.disableImageResize();var a=this;this.$element.on("mousedown",'img:not([contenteditable="false"])',function(d){return a.isDisabled?!1:void (a.isResizing()||(a.initialized&&d.stopPropagation(),a.$element.attr("contenteditable",!1),b(this).addClass("fr-image-move")))}),this.$element.on("mouseup",'img:not([contenteditable="false"])',function(){return a.isDisabled?!1:void (a.isResizing()||(a.options.imageMove||a.isImage||a.isHTML||a.$element.attr("contenteditable",!0),b(this).removeClass("fr-image-move")))}),this.$element.on("click touchend",'img:not([contenteditable="false"])',function(j){if(a.isDisabled){return !1}if(!a.isResizing()&&a.initialized){j.preventDefault(),j.stopPropagation(),a.closeImageMode(),a.$element.blur(),a.$image_editor.find("button").removeClass("active");var i=b(this).css("float");if(b(this).hasClass("fr-fil")?i="left":b(this).hasClass("fr-fir")&&(i="right"),a.$image_editor.find('button[data-cmd="floatImage'+i.charAt(0).toUpperCase()+i.slice(1)+'"]').addClass("active"),a.$image_editor.find('.f-image-alt input[type="text"]').val(b(this).attr("alt")||b(this).attr("title")),a.showImageEditor(),!b(this).parent().hasClass("f-img-editor")||"SPAN"!=b(this).parent().get(0).tagName){var h=a.getImageClass(b(this).attr("class"));b(this).wrap('<span data-fr-verified="true" class="f-img-editor '+h+'"></span>'),0!==b(this).parents(".f-img-wrap").length||a.isImage?a.addImageClass(b(this).parents(".f-img-wrap"),h):b(this).parents("a").length>0?b(this).parents("a:first").wrap('<span data-fr-verified="true" class="f-img-wrap '+h+'"></span>'):b(this).parent().wrap('<span data-fr-verified="true" class="f-img-wrap '+h+'"></span>')}var g=a.imageHandle();b(this).parent().find(".f-img-handle").remove(),a.options.imageResize&&(b(this).parent().append(g.clone(!0).addClass("f-h-ne")),b(this).parent().append(g.clone(!0).addClass("f-h-se")),b(this).parent().append(g.clone(!0).addClass("f-h-sw")),b(this).parent().append(g.clone(!0).addClass("f-h-nw"))),a.showByCoordinates(b(this).offset().left+b(this).width()/2,b(this).offset().top+b(this).height()),a.imageMode=!0,a.$bttn_wrapper.find(".fr-bttn").removeClass("active"),a.clearSelection()}}),this.$element.on("mousedown touchstart",".f-img-handle",b.proxy(function(){return a.isDisabled?!1:void this.$element.attr("data-resize",!0)},this)),this.$element.on("mouseup",".f-img-handle",b.proxy(function(f){if(a.isDisabled){return !1}var e=b(f.target).prevAll("img");setTimeout(b.proxy(function(){this.$element.removeAttr("data-resize"),e.click()},this),0)},this))},b.Editable.prototype.initImagePopup=function(){this.$image_editor=b('<div class="froala-popup froala-image-editor-popup" style="display: none">');for(var a=b('<div class="f-popup-line f-popup-toolbar">').appendTo(this.$image_editor),j=0;j<this.options.imageButtons.length;j++){var i=this.options.imageButtons[j];if(void 0!==b.Editable.image_commands[i]){var h=b.Editable.image_commands[i],g='<button class="fr-bttn" data-callback="'+i+'" data-cmd="'+i+'" title="'+h.title+'">';g+=void 0!==this.options.icons[i]?this.prepareIcon(this.options.icons[i],h.title):this.prepareIcon(h.icon,h.title),g+="</button>",a.append(g)}}this.addListener("hidePopups",this.hideImageEditorPopup),this.options.imageTitle&&b('<div class="f-popup-line f-image-alt">').append('<label><span data-text="true">Title</span>: </label>').append(b('<input type="text">').on("mouseup keydown",function(d){var c=d.which;c&&27===c||d.stopPropagation()})).append('<button class="fr-p-bttn f-ok" data-text="true" data-callback="setImageAlt" data-cmd="setImageAlt" title="OK">OK</button>').appendTo(this.$image_editor),this.$popup_editor.append(this.$image_editor),this.bindCommandEvents(this.$image_editor)},b.Editable.prototype.floatImageLeft=function(){var c=this.$element.find("span.f-img-editor");this.addImageClass(c,"fr-fil"),this.isImage&&this.$element.css("float","left"),this.triggerEvent("imageFloatedLeft"),c.find("img").click()},b.Editable.prototype.floatImageNone=function(){var c=this.$element.find("span.f-img-editor");this.addImageClass(c,"fr-fin"),this.isImage||(c.parent().get(0)==this.$element.get(0)?c.wrap('<div style="text-align: center;"></div>'):c.parents(".f-img-wrap:first").css("text-align","center")),this.isImage&&this.$element.css("float","none"),this.triggerEvent("imageFloatedNone"),c.find("img").click()},b.Editable.prototype.floatImageRight=function(){var c=this.$element.find("span.f-img-editor");this.addImageClass(c,"fr-fir"),this.isImage&&this.$element.css("float","right"),this.triggerEvent("imageFloatedRight"),c.find("img").click()},b.Editable.prototype.linkImage=function(){var c=this.$element.find("span.f-img-editor");this.showInsertLink(),this.imageMode=!0,"A"==c.parent().get(0).tagName?(this.$link_wrapper.find('input[type="text"]').val(c.parent().attr("href")),this.$link_wrapper.find(".f-external-link").attr("href",c.parent().attr("href")),"_blank"==c.parent().attr("target")?this.$link_wrapper.find('input[type="checkbox"]').prop("checked",!0):this.$link_wrapper.find('input[type="checkbox"]').prop("checked",!1),this.$link_wrapper.find("a.f-external-link, button.f-unlink").show()):(this.$link_wrapper.find('input[type="text"]').val("http://"),this.$link_wrapper.find(".f-external-link").attr("href","#"),this.$link_wrapper.find('input[type="checkbox"]').prop("checked",this.options.alwaysBlank),this.$link_wrapper.find("a.f-external-link, button.f-unlink").hide())},b.Editable.prototype.replaceImage=function(){var d=this.$element.find("span.f-img-editor");this.showInsertImage(),this.imageMode=!0,this.$image_wrapper.find('input[type="text"]').val(d.find("img").attr("src"));var c=d.find("img");this.showByCoordinates(c.offset().left+c.width()/2,c.offset().top+c.height())},b.Editable.prototype.removeImage=function(){var a=this.$element.find("span.f-img-editor");if(0===a.length){return !1}var h=a.find("img").get(0),g="Are you sure? Image will be deleted.";if(b.Editable.LANGS[this.options.language]&&(g=b.Editable.LANGS[this.options.language].translation[g]),!this.options.imageDeleteConfirmation||confirm(g)){if(this.triggerEvent("beforeRemoveImage",[b(h)],!1)){var f=a.parents(this.valid_nodes.join(","));a.parents(".f-img-wrap").length?a.parents(".f-img-wrap").remove():a.remove(),this.refreshImageList(!0),this.hide(),f.length&&f[0]!=this.$element.get(0)&&""===b(f[0]).text()&&b(f[0]).remove(),this.wrapText(),this.triggerEvent("afterRemoveImage",[b(h)]),this.focus(),this.imageMode=!1}}else{a.find("img").click()}},b.Editable.prototype.setImageAlt=function(){var c=this.$element.find("span.f-img-editor");c.find("img").attr("alt",this.$image_editor.find('.f-image-alt input[type="text"]').val()),c.find("img").attr("title",this.$image_editor.find('.f-image-alt input[type="text"]').val()),this.hide(),this.closeImageMode(),this.triggerEvent("imageAltSet")},b.Editable.prototype.buildImageMove=function(){var a=this;this.isLink||this.initDrag(),a.$element.on("dragover dragenter dragend",function(){return !1}),a.$element.on("drop",function(f){if(a.closeImageMode(),a.hide(),a.imageMode=!1,a.initialized||(a.$element.unbind("mousedown.element"),a.lateInit()),!a.options.imageUpload||0!==b(".froala-element img.fr-image-move").length){if(b(".froala-element .fr-image-move").length>0&&a.options.imageMove){f.preventDefault(),f.stopPropagation(),a.insertMarkersAtPoint(f.originalEvent),a.restoreSelectionByMarkers();var e=b("<div>").append(b(".froala-element img.fr-image-move").clone().removeClass("fr-image-move").addClass("fr-image-dropped")).html();a.insertHTML(e),b(".froala-element img.fr-image-move").remove(),a.clearSelection(),a.initialized?setTimeout(function(){a.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped").click()},0):a.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped"),a.sync(),a.hideOtherEditors()}else{f.preventDefault(),f.stopPropagation(),b(".froala-element img.fr-image-move").removeClass("fr-image-move")}return !1}if(f.originalEvent.dataTransfer&&f.originalEvent.dataTransfer.files&&f.originalEvent.dataTransfer.files.length){if(a.isDisabled){return !1}a.insertMarkersAtPoint(f.originalEvent),a.showByCoordinates(f.originalEvent.pageX,f.originalEvent.pageY),a.uploadImage(f.originalEvent.dataTransfer.files),f.preventDefault(),f.stopPropagation()}})},b.Editable.prototype.buildDragUpload=function(){var a=this;a.$image_wrapper.on("dragover","#f-upload-div-"+this._id,function(){return b(this).addClass("f-hover"),!1}),a.$image_wrapper.on("dragend","#f-upload-div-"+this._id,function(){return b(this).removeClass("f-hover"),!1}),a.$image_wrapper.on("drop","#f-upload-div-"+this._id,function(d){return d.preventDefault(),d.stopPropagation(),a.options.imageUpload?(b(this).removeClass("f-hover"),void a.uploadImage(d.originalEvent.dataTransfer.files)):!1})},b.Editable.prototype.showImageLoader=function(a){if(void 0===a&&(a=!1),a){var d="Please wait!";b.Editable.LANGS[this.options.language]&&(d=b.Editable.LANGS[this.options.language].translation[d]),this.$progress_bar.find("span").css("width","100%").text(d)}else{this.$image_wrapper.find("h4").addClass("uploading")}this.$image_wrapper.find("#f-image-list-"+this._id).hide(),this.$progress_bar.show(),this.showInsertImage()},b.Editable.prototype.hideImageLoader=function(){this.$progress_bar.hide(),this.$progress_bar.find("span").css("width","0%").text(""),this.$image_wrapper.find("#f-image-list-"+this._id).show(),this.$image_wrapper.find("h4").removeClass("uploading")},b.Editable.prototype.writeImage=function(a,f){if(f&&(a=this.sanitizeURL(a),""===a)){return !1}var e=new Image;e.onerror=b.proxy(function(){this.hideImageLoader(),this.throwImageError(1)},this),e.onload=this.imageMode?b.proxy(function(){var c=this.$element.find(".f-img-editor > img");c.attr("src",a),this.hide(),this.hideImageLoader(),this.$image_editor.show(),this.enable(),this.triggerEvent("imageReplaced",[c]),setTimeout(function(){c.trigger("click")},0)},this):b.proxy(function(){this.insertLoadedImage(a)},this),this.showImageLoader(!0),e.src=a},b.Editable.prototype.processInsertImage=function(a,n){void 0===n&&(n=!0),this.enable(),this.restoreSelection(),this.focus();var m="";parseInt(this.options.defaultImageWidth,10)&&(m=' width="auto"');var l='<img class="fr-fin fr-just-inserted" alt="'+this.options.defaultImageTitle+'" src="'+a+'"'+m+">",k=this.getSelectionElements()[0],j=this.getRange(),i=!this.browser.msie&&b.Editable.getIEversion()>8?b(j.startContainer):null;i&&i.hasClass("f-img-wrap")?(1===j.startOffset?(i.after('<p><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></p>'),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()):0===j.startOffset&&(i.before('<p><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></p>'),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()),this.insertHTML(l)):this.getSelectionTextInfo(k).atStart&&k!=this.$element.get(0)&&"TD"!=k.tagName&&"TH"!=k.tagName&&"LI"!=k.tagName?b(k).before("<p>"+l+"</p>"):this.insertHTML(l),this.disable()},b.Editable.prototype.insertLoadedImage=function(a){this.triggerEvent("imageLoaded",[a],!1),this.processInsertImage(a,!1),this.browser.msie&&this.$element.find("img").each(function(d,c){c.oncontrolselect=function(){return !1}}),this.enable(),this.hide(),this.hideImageLoader(),this.wrapText(),this.triggerEvent("imageInserted",[this.$element.find("img.fr-just-inserted")]),setTimeout(b.proxy(function(){this.$element.find("img.fr-just-inserted").removeClass("fr-just-inserted").trigger("touchend")},this),50)},b.Editable.prototype.throwImageErrorWithMessage=function(c){this.enable(),this.triggerEvent("imageError",[{message:c,code:0}],!1),this.hideImageLoader()},b.Editable.prototype.throwImageError=function(d){this.enable();var c="Unknown image upload error.";1==d?c="Bad link.":2==d?c="No link in upload response.":3==d?c="Error during file upload.":4==d?c="Parsing response failed.":5==d?c="Image too large.":6==d?c="Invalid image type.":7==d&&(c="Image can be uploaded only to same domain in IE 8 and IE 9."),this.triggerEvent("imageError",[{code:d,message:c}],!1),this.hideImageLoader()},b.Editable.prototype.uploadImage=function(a){if(!this.triggerEvent("beforeImageUpload",[a],!1)){return !1}if(void 0!==a&&a.length>0){var j;if(this.drag_support.formdata&&(j=this.drag_support.formdata?new FormData:null),j){var i;for(i in this.options.imageUploadParams){j.append(i,this.options.imageUploadParams[i])}if(this.options.imageUploadToS3!==!1){for(i in this.options.imageUploadToS3.params){j.append(i,this.options.imageUploadToS3.params[i])}j.append("success_action_status","201"),j.append("X-Requested-With","xhr"),j.append("Content-Type",a[0].type),j.append("key",this.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+a[0].name)}if(j.append(this.options.imageUploadParam,a[0]),a[0].size>this.options.maxImageSize){return this.throwImageError(5),!1}if(this.options.allowedImageTypes.indexOf(a[0].type.replace(/image\//g,""))<0){return this.throwImageError(6),!1}}if(j){var h;if(this.options.crossDomain){h=this.createCORSRequest("POST",this.options.imageUploadURL)}else{h=new XMLHttpRequest,h.open("POST",this.options.imageUploadURL);for(var g in this.options.headers){h.setRequestHeader(g,this.options.headers[g])}}h.onload=b.proxy(function(){var d="Please wait!";b.Editable.LANGS[this.options.language]&&(d=b.Editable.LANGS[this.options.language].translation[d]),this.$progress_bar.find("span").css("width","100%").text(d);try{this.options.imageUploadToS3?201==h.status?this.parseImageResponseXML(h.responseXML):this.throwImageError(3):h.status>=200&&h.status<300?this.parseImageResponse(h.responseText):this.throwImageError(3)}catch(e){this.throwImageError(4)}},this),h.onerror=b.proxy(function(){this.throwImageError(3)},this),h.upload.onprogress=b.proxy(function(d){if(d.lengthComputable){var c=d.loaded/d.total*100|0;this.$progress_bar.find("span").css("width",c+"%")}},this),this.disable(),h.send(j),this.showImageLoader()}}},b.Editable.prototype.parseImageResponse=function(a){try{var f=b.parseJSON(a);f.link?this.writeImage(f.link):f.error?this.throwImageErrorWithMessage(f.error):this.throwImageError(2)}catch(e){this.throwImageError(4)}},b.Editable.prototype.parseImageResponseXML=function(a){try{var h=b(a).find("Location").text(),g=b(a).find("Key").text();this.options.imageUploadToS3.callback.call(this,h,g),h?this.writeImage(h):this.throwImageError(2)}catch(f){this.throwImageError(4)}},b.Editable.prototype.setImageUploadURL=function(c){c&&(this.options.imageUploadURL=c),this.options.imageUploadToS3&&(this.options.imageUploadURL="https://"+this.options.imageUploadToS3.bucket+"."+this.options.imageUploadToS3.region+".amazonaws.com/")},b.Editable.prototype.closeImageMode=function(){this.$element.find("span.f-img-editor > img").each(b.proxy(function(a,d){this.addImageClass(b(d),this.getImageClass(b(d).parent().attr("class"))),b(d).parents(".f-img-wrap").length>0?"A"==b(d).parent().parent().get(0).tagName?b(d).siblings("span.f-img-handle").remove().end().unwrap().parent().unwrap():b(d).siblings("span.f-img-handle").remove().end().unwrap().unwrap():b(d).siblings("span.f-img-handle").remove().end().unwrap()},this)),this.$element.find("span.f-img-editor").length&&(this.$element.find("span.f-img-editor").remove(),this.$element.parents("span.f-img-editor").remove()),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0),this.$image_editor&&this.$image_editor.hide(),this.$link_wrapper&&this.options.linkText&&this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden")},b.Editable.prototype.refreshImageList=function(a){if(!this.isLink&&!this.options.editInPopup){var j=[],i=[],h=this;if(this.$element.find("img").each(function(c,k){var e=b(k);if(j.push(e.attr("src")),i.push(e),0===e.parents(".f-img-editor").length&&!e.hasClass("fr-fil")&&!e.hasClass("fr-fir")&&!e.hasClass("fr-fin")){var d;"right"==e.css("float")?(d=e.parent(),d.hasClass("f-img-editor")?d.addClass("fr-fir"):e.addClass("fr-fir")):"left"==e.css("float")?(d=e.parent(),d.hasClass("f-img-editor")?d.addClass("fr-fil"):e.addClass("fr-fil")):(d=e.parent(),d.hasClass("f-img-editor")?d.addClass("fr-fin"):e.addClass("fr-fin"))}h.options.textNearImage?e.removeClass("fr-tni"):e.addClass("fr-tni"),e.css("margin",""),e.css("float","")}),void 0===a){for(var g=0;g<this.imageList.length;g++){j.indexOf(this.imageList[g].attr("src"))<0&&this.triggerEvent("afterRemoveImage",[this.imageList[g]],!1)}}this.imageList=i}},b.Editable.prototype.insertImage=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertImage")),this.selectionInEditor()&&this.saveSelection(),this.showInsertImage(),this.imageMode=!1,this.$image_wrapper.find('input[type="text"]').val("")}}(jQuery),function(b){b.Editable.prototype.showLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.show(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList"),this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode||!this.options.linkText?this.$link_wrapper.find('input[type="text"].f-lt').parent().addClass("fr-hidden"):this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden"),this.imageMode&&this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.phone()?this.$document.scrollTop(this.$link_wrapper.offset().top-10):setTimeout(b.proxy(function(){this.$link_wrapper.find('input[type="text"].f-lu').focus().select()},this),0),this.link=!0)},b.Editable.prototype.hideLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.hide(),this.$link_wrapper.find("input").blur())},b.Editable.prototype.showInsertLink=function(){this.hidePopups(),this.showLinkWrapper()},b.Editable.prototype.initLinkEvents=function(){var a=this,f=function(c){c.stopPropagation(),c.preventDefault()},e=function(h){if(h.stopPropagation(),h.preventDefault(),a.isDisabled){return !1}if(""!==a.text()){return a.hide(),!1}a.link=!0,a.clearSelection(),a.removeMarkers(),a.selectionDisabled||(b(this).before('<span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),b(this).after('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span>'),a.restoreSelectionByMarkers()),a.exec("createLink");var g=b(this).attr("href")||"";a.$link_wrapper.find("input.f-lt").val(b(this).text()),a.isLink?("#"==g&&(g=""),a.$link_wrapper.find("input#f-lu-"+a._id).val(g.replace(/\&amp;/g,"&")),a.$link_wrapper.find(".f-external-link").attr("href",g||"#")):(a.$link_wrapper.find("input.f-lu").val(g.replace(/\&amp;/g,"&")),a.$link_wrapper.find(".f-external-link").attr("href",g)),a.$link_wrapper.find('input[type="checkbox"]').prop("checked","_blank"==b(this).attr("target")),a.$link_wrapper.find("li.f-choose-link-class").each(b.proxy(function(d,i){b(this).hasClass(b(i).data("class"))&&b(i).click()},this)),a.showByCoordinates(b(this).offset().left+b(this).outerWidth()/2,b(this).offset().top+(parseInt(b(this).css("padding-top"),10)||0)+b(this).height()),a.showInsertLink(),b(this).hasClass("fr-file")?a.$link_wrapper.find("input.f-lu").attr("disabled","disabled"):a.$link_wrapper.find("input.f-lu").removeAttr("disabled"),a.closeImageMode()};this.$element.on("mousedown","a",b.proxy(function(c){this.isResizing()||c.stopPropagation()},this)),this.isLink?this.iOS()?(this.$element.on("touchstart",f),this.$element.on("touchend",e)):this.$element.on("click",e):this.iOS()?(this.$element.on("touchstart",'a:not([contenteditable="false"])',f),this.$element.on("touchend",'a:not([contenteditable="false"])',e),this.$element.on("touchstart",'a[contenteditable="false"]',f),this.$element.on("touchend",'a[contenteditable="false"]',f)):(this.$element.on("click",'a:not([contenteditable="false"])',e),this.$element.on("click",'a[contenteditable="false"]',f))},b.Editable.prototype.destroyLink=function(){this.$link_wrapper.html("").removeData().remove()},b.Editable.prototype.initLink=function(){this.buildCreateLink(),this.initLinkEvents(),this.addListener("destroy",this.destroyLink)},b.Editable.initializers.push(b.Editable.prototype.initLink),b.Editable.prototype.removeLink=function(){this.imageMode?("A"==this.$element.find(".f-img-editor").parent().get(0).tagName&&b(this.$element.find(".f-img-editor").get(0)).unwrap(),this.triggerEvent("imageLinkRemoved"),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1):(this.restoreSelection(),document.execCommand("unlink",!1,null),this.isLink||this.$element.find("a:empty").remove(),this.triggerEvent("linkRemoved"),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1)},b.Editable.prototype.writeLink=function(B,A,z,y,x){var w;this.options.noFollow&&(x=!0),this.options.alwaysBlank&&(y=!0);var v="",u="";x===!0&&/^https?:\/\//.test(B)&&(v='rel="nofollow"'),y===!0&&(u='target="_blank"');var t=B;if(B=this.sanitizeURL(B),this.options.convertMailAddresses){var s=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i;s.test(B)&&0!==B.indexOf("mailto:")&&(B="mailto:"+B)}if(""===B){return this.$link_wrapper.find("input.f-lu").addClass("fr-error").focus(),this.triggerEvent("badLink",[t],!1),!1}if(this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode){if("A"!=this.$element.find(".f-img-editor").parent().get(0).tagName){this.$element.find(".f-img-editor").wrap('<a data-fr-link="true" href="'+B+'" '+u+" "+v+"></a>")}else{var r=this.$element.find(".f-img-editor").parent();y===!0?r.attr("target","_blank"):r.removeAttr("target"),x===!0?r.attr("rel","nofollow"):r.removeAttr("rel"),r.removeClass(Object.keys(this.options.linkClasses).join(" ")),r.attr("href",B).addClass(z)}this.triggerEvent("imageLinkInserted",[B]),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1}else{var q=null;this.isLink?""===A&&(A=this.$element.text()):(this.restoreSelection(),w=this.getSelectionLinks(),w.length>0&&(q=w[0].attributes,is_file=b(w[0]).hasClass("fr-file")),this.saveSelectionByMarkers(),document.execCommand("unlink",!1,B),this.$element.find('span[data-fr-link="true"]').each(function(d,e){b(e).replaceWith(b(e).html())}),this.restoreSelectionByMarkers()),this.isLink?(this.$element.text(A),w=[this.$element.attr("href",B).get(0)]):(this.removeMarkers(),(this.options.linkText||""===this.text())&&(this.insertHTML('<span class="f-marker" data-fr-verified="true" data-id="0" data-type="true"></span>'+(A||B)+'<span class="f-marker" data-fr-verified="true" data-id="0" data-type="false"></span>'),this.restoreSelectionByMarkers()),document.execCommand("createLink",!1,B),w=this.getSelectionLinks());for(var p=0;p<w.length;p++){if(q){for(var a=0;a<q.length;a++){"href"!=q[a].nodeName&&b(w[p]).attr(q[a].nodeName,q[a].value)}}y===!0?b(w[p]).attr("target","_blank"):b(w[p]).removeAttr("target"),x===!0&&/^https?:\/\//.test(B)?b(w[p]).attr("rel","nofollow"):b(w[p]).removeAttr("rel"),b(w[p]).data("fr-link",!0),b(w[p]).removeClass(Object.keys(this.options.linkClasses).join(" ")),b(w[p]).addClass(z)}this.$element.find("a:empty").remove(),this.triggerEvent("linkInserted",[B]),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1}},b.Editable.prototype.createLinkHTML=function(){var h='<div class="froala-popup froala-link-popup" style="display: none;">';h+='<h4><span data-text="true">Insert Link</span><a target="_blank" title="Open Link" class="f-external-link" href="#"><i class="fa fa-external-link"></i></a><i title="Cancel" class="fa fa-times" id="f-link-close-'+this._id+'"></i></h4>',h+='<div class="f-popup-line fr-hidden"><input type="text" placeholder="Text" class="f-lt" id="f-lt-'+this._id+'"></div>';var g="";if(this.options.linkList.length&&(g="f-bi"),h+='<div class="f-popup-line"><input type="text" placeholder="http://www.example.com" class="f-lu '+g+'" id="f-lu-'+this._id+'"/>',this.options.linkList.length){h+='<button class="fr-p-bttn f-browse-links" id="f-browse-links-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',h+='<ul id="f-link-list-'+this._id+'">';for(var l=0;l<this.options.linkList.length;l++){var k=this.options.linkList[l];h+='<li class="f-choose-link" data-nofollow="'+k.nofollow+'" data-blank="'+k.blank+'" data-body="'+k.body+'" data-title="'+k.title+'" data-href="'+k.href+'">'+k.body+"</li>"}h+="</ul>"}if(h+="</div>",Object.keys(this.options.linkClasses).length){h+='<div class="f-popup-line"><input type="text" placeholder="Choose link type" class="f-bi" id="f-luc-'+this._id+'" disabled="disabled"/>',h+='<button class="fr-p-bttn f-browse-links" id="f-links-class-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',h+='<ul id="f-link-class-list-'+this._id+'">';for(var j in this.options.linkClasses){var i=this.options.linkClasses[j];h+='<li class="f-choose-link-class" data-class="'+j+'">'+i+"</li>"}h+="</ul>",h+="</div>"}return h+='<div class="f-popup-line"><input type="checkbox" id="f-checkbox-'+this._id+'"> <label data-text="true" for="f-checkbox-'+this._id+'">Open in new tab</label><button data-text="true" type="button" class="fr-p-bttn f-ok" id="f-ok-'+this._id+'">OK</button>',this.options.unlinkButton&&(h+='<button type="button" data-text="true" class="fr-p-bttn f-ok f-unlink" id="f-unlink-'+this._id+'">UNLINK</button>'),h+="</div></div>"},b.Editable.prototype.buildCreateLink=function(){this.$link_wrapper=b(this.createLinkHTML()),this.$popup_editor.append(this.$link_wrapper);var a=this;this.addListener("hidePopups",this.hideLinkWrapper),this.$link_wrapper.on("mouseup touchend",b.proxy(function(c){this.isResizing()||(c.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"))},this)),this.options.linkText&&this.$link_wrapper.on("mouseup keydown","input#f-lt-"+this._id,b.proxy(function(d){var c=d.which;c&&27===c||d.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("mouseup keydown","input#f-lu-"+this._id,b.proxy(function(d){var c=d.which;c&&27===c||d.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click keydown","input#f-checkbox-"+this._id,function(d){var c=d.which;c&&27===c||d.stopPropagation()}),this.$link_wrapper.on("touchend","button#f-ok-"+this._id,function(c){c.stopPropagation()}).on("click","button#f-ok-"+this._id,b.proxy(function(){var i,h=this.$link_wrapper.find("input#f-lt-"+this._id),n=this.$link_wrapper.find("input#f-lu-"+this._id),m=this.$link_wrapper.find("input#f-luc-"+this._id),l=this.$link_wrapper.find("input#f-checkbox-"+this._id);i=h?h.val():"";var k=n.val();this.isLink&&""===k&&(k="#");var j="";m&&(j=m.data("class")),this.writeLink(k,i,j,l.prop("checked"))},this)),this.$link_wrapper.on("click touch","button#f-unlink-"+this._id,b.proxy(function(){this.link=!0,this.removeLink()},this)),this.options.linkList.length&&(this.$link_wrapper.on("click touch","li.f-choose-link",function(){var j=a.$link_wrapper.find("button#f-browse-links-"+a._id),i=a.$link_wrapper.find("input#f-lt-"+a._id),h=a.$link_wrapper.find("input#f-lu-"+a._id),g=a.$link_wrapper.find("input#f-checkbox-"+a._id);i&&i.val(b(this).data("body")),h.val(b(this).data("href")),g.prop("checked",b(this).data("blank")),j.click()}).on("mouseup","li.f-choose-link",function(c){c.stopPropagation()}),this.$link_wrapper.on("click","button#f-browse-links-"+this._id,function(f){f.stopPropagation();var e=a.$link_wrapper.find("ul#f-link-list-"+a._id);a.$link_wrapper.trigger("hideLinkClassList"),b(this).find("i").toggleClass("fa-chevron-down"),b(this).find("i").toggleClass("fa-chevron-up"),e.toggle()}).on("mouseup","button#f-browse-links-"+this._id,function(c){c.stopPropagation()}),this.$link_wrapper.bind("hideLinkList",function(){var d=a.$link_wrapper.find("ul#f-link-list-"+a._id),e=a.$link_wrapper.find("button#f-browse-links-"+a._id);d&&d.is(":visible")&&e.click()})),Object.keys(this.options.linkClasses).length&&(this.$link_wrapper.on("mouseup keydown","input#f-luc-"+this._id,b.proxy(function(d){var c=d.which;c&&27===c||d.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click touch","li.f-choose-link-class",function(){var d=a.$link_wrapper.find("input#f-luc-"+a._id);d.val(b(this).text()),d.data("class",b(this).data("class")),a.$link_wrapper.trigger("hideLinkClassList")}).on("mouseup","li.f-choose-link-class",function(c){c.stopPropagation()}),this.$link_wrapper.on("click","button#f-links-class-"+this._id,function(f){f.stopPropagation(),a.$link_wrapper.trigger("hideLinkList");var e=a.$link_wrapper.find("ul#f-link-class-list-"+a._id);b(this).find("i").toggleClass("fa-chevron-down"),b(this).find("i").toggleClass("fa-chevron-up"),e.toggle()}).on("mouseup","button#f-links-class-"+this._id,function(c){c.stopPropagation()}),this.$link_wrapper.bind("hideLinkClassList",function(){var d=a.$link_wrapper.find("ul#f-link-class-list-"+a._id),e=a.$link_wrapper.find("button#f-links-class-"+a._id);d&&d.is(":visible")&&e.click()})),this.$link_wrapper.on(this.mouseup,"i#f-link-close-"+this._id,b.proxy(function(){this.$bttn_wrapper.show(),this.hideLinkWrapper(),(!this.options.inlineMode&&!this.imageMode||this.isLink||0===this.options.buttons.length)&&this.hide(),this.imageMode?this.showImageEditor():(this.restoreSelection(),this.focus())},this))},b.Editable.prototype.getSelectionLinks=function(){var r,q,p,o,n=[];if(window.getSelection){var m=window.getSelection();if(m.getRangeAt&&m.rangeCount){o=document.createRange();for(var l=0;l<m.rangeCount;++l){if(r=m.getRangeAt(l),q=r.commonAncestorContainer,q&&1!=q.nodeType&&(q=q.parentNode),q&&"a"==q.nodeName.toLowerCase()){n.push(q)}else{p=q.getElementsByTagName("a");for(var k=0;k<p.length;++k){o.selectNodeContents(p[k]),o.compareBoundaryPoints(r.END_TO_START,r)<1&&o.compareBoundaryPoints(r.START_TO_END,r)>-1&&n.push(p[k])}}}}}else{if(document.selection&&"Control"!=document.selection.type){if(r=document.selection.createRange(),q=r.parentElement(),"a"==q.nodeName.toLowerCase()){n.push(q)}else{p=q.getElementsByTagName("a"),o=document.body.createTextRange();for(var j=0;j<p.length;++j){o.moveToElementText(p[j]),o.compareEndPoints("StartToEnd",r)>-1&&o.compareEndPoints("EndToStart",r)<1&&n.push(p[j])}}}}return n},b.Editable.prototype.insertLink=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("createLink")),this.selectionInEditor()&&this.saveSelection(),this.showInsertLink();var a=this.getSelectionLink()||"",d=this.getSelectionLinks();d.length>0?(this.$link_wrapper.find('input[type="checkbox"]').prop("checked","_blank"==b(d[0]).attr("target")),this.$link_wrapper.find('input[type="text"].f-lt').val(b(d[0]).text()||""),b(d[0]).hasClass("fr-file")?this.$link_wrapper.find('input[type="text"].f-lu').attr("disabled","disabled"):this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.$link_wrapper.find("a.f-external-link, button.f-unlink").show()):(this.$link_wrapper.find('input[type="checkbox"]').prop("checked",this.options.alwaysBlank),this.$link_wrapper.find('input[type="text"].f-lt').val(this.text()),this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.$link_wrapper.find("a.f-external-link, button.f-unlink").hide()),this.$link_wrapper.find(".f-external-link").attr("href",a||"#"),this.$link_wrapper.find('input[type="text"].f-lu').val(a.replace(/\&amp;/g,"&")||"http://")}}(jQuery),function(b){b.Editable.prototype.browserFixes=function(){this.preBlockquoteEnter(),this.enterNoParagraphy(),this.backspaceEmpty(),this.fixHR(),this.domInsert(),this.fixIME()},b.Editable.prototype.fixHR=function(){this.$element.on("keydown",b.proxy(function(a){var h=b(this.getSelectionElement());if(h.is("hr")||h.parents("hr").length){return !1}var g=a.which,f=b(this.getSelectionElements()[0]);8==g&&f.prev().is("hr")&&this.getSelectionTextInfo(f.get(0)).atStart&&(this.saveSelectionByMarkers(),f.prev().remove(),this.restoreSelectionByMarkers(),a.preventDefault())},this))},b.Editable.prototype.backspaceEmpty=function(){this.$element.on("keydown",b.proxy(function(d){var c=d.which;!this.isHTML&&8==c&&this.$element.hasClass("f-placeholder")&&d.preventDefault()},this))},b.Editable.prototype.preBlockquoteEnter=function(){this.isImage||this.isLink||this.options.editInPopup||this.$element.on("keydown",b.proxy(function(a){var j=a.which,i=["PRE","BLOCKQUOTE"],h=this.getSelectionElements()[0];if(13==j&&""===this.text()&&i.indexOf(h.tagName)>=0&&0===b(h).parents("ul, ol").length){if(this.getSelectionTextInfo(h).atEnd&&!a.shiftKey){a.preventDefault();var g=b("<p><br></p>");b(h).after(g),this.setSelection(g.get(0))}else{(this.browser.webkit||this.browser.msie)&&(a.preventDefault(),this.insertHTML(this.endsWith(b(h).html(),"<br>")||!this.getSelectionTextInfo(h).atEnd?"<br>":"<br><br>"))}}},this))},b.Editable.prototype.enterNoParagraphy=function(){!this.browser.webkit&&!this.browser.msie||this.options.paragraphy||this.$element.on("keydown",b.proxy(function(d){var c=d.which;13==c&&(d.preventDefault(),this.insertHTML('</br>&#8203;<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),this.restoreSelectionByMarkers())},this))},b.Editable.prototype.domInsert=function(){this.$element.on("keydown",b.proxy(function(d){var c=d.which;8===c&&(this.no_verify=!0),13===c&&(this.add_br=!0)},this)),this.$element.on("DOMNodeInserted",b.proxy(function(a){if("SPAN"!==a.target.tagName||b(a.target).attr("data-fr-verified")||this.no_verify||this.textEmpty(a.target)||b(a.target).replaceWith(b(a.target).contents()),this.options.paragraphy&&this.add_br&&"BR"===a.target.tagName&&(b(a.target).prev().length&&"TABLE"===b(a.target).prev().get(0).tagName||b(a.target).next().length&&"TABLE"===b(a.target).next().get(0).tagName)){b(a.target).wrap('<p class="fr-p-wrap">');var d=this.$element.find("p.fr-p-wrap").removeAttr("class");this.setSelection(d.get(0))}},this)),this.$element.on("keyup",b.proxy(function(d){var c=d.which;8===c&&(this.$element.find("span:not(.fr-verified)").attr("data-fr-verified",!0),this.no_verify=!1),13===c&&(this.add_br=!0)},this))},b.Editable.prototype.fixIME=function(){this.$element.get(0).msGetInputContext&&(this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowShow",b.proxy(function(){this.ime=!0},this)),this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowHide",b.proxy(function(){this.ime=!1,this.$element.trigger("keydown"),this.oldHTML=""},this)))}}(jQuery),function(b){"function"==typeof define&&define.amd?define(["jquery"],b):b(jQuery)}(function(aG,aF){function aE(g){function f(){i?(j(),T(f),h=!0,i=!1):h=!1}var j=g,i=!1,h=!1;this.kick=function(){i=!0,h||f()},this.end=function(d){var c=j;d&&(h?(j=i?function(){c(),d()}:d,i=!0):d())}}function aD(){return !0}function aC(){return !1}function aB(b){b.preventDefault()}function aA(b){S[b.target.tagName.toLowerCase()]||b.preventDefault()}function az(b){return 1===b.which&&!b.ctrlKey&&!b.altKey}function ay(f,e){var h,g;if(f.identifiedTouch){return f.identifiedTouch(e)}for(h=-1,g=f.length;++h<g;){if(f[h].identifier===e){return f[h]}}}function ax(e,d){var f=ay(e.changedTouches,d.identifier);if(f&&(f.pageX!==d.pageX||f.pageY!==d.pageY)){return f}}function aw(d){var c;az(d)&&(c={target:d.target,startX:d.pageX,startY:d.pageY,timeStamp:d.timeStamp},W(document,R.move,av,c),W(document,R.cancel,au,c))}function av(d){var c=d.data;an(d,c,d,at)}function au(){at()}function at(){V(document,R.move,av),V(document,R.cancel,au)}function ar(e){var d,f;S[e.target.tagName.toLowerCase()]||(d=e.changedTouches[0],f={target:d.target,startX:d.pageX,startY:d.pageY,timeStamp:e.timeStamp,identifier:d.identifier},W(document,Q.move+"."+d.identifier,aq,f),W(document,Q.cancel+"."+d.identifier,ap,f))}function aq(e){var d=e.data,f=ax(e,d);f&&an(e,d,f,ao)}function ap(e){var d=e.data,f=ay(e.changedTouches,d.identifier);f&&ao(d.identifier)}function ao(b){V(document,"."+b,aq),V(document,"."+b,ap)}function an(h,g,l,k){var j=l.pageX-g.startX,i=l.pageY-g.startY;X*X>j*j+i*i||ak(h,g,l,j,i,k)}function am(){return this._handled=aD,!1}function al(d){try{d._handled()}catch(c){return !1}}function ak(j,i,p,o,n,m){var l,k;i.target;l=j.targetTouches,k=j.timeStamp-i.timeStamp,i.type="movestart",i.distX=o,i.distY=n,i.deltaX=o,i.deltaY=n,i.pageX=p.pageX,i.pageY=p.pageY,i.velocityX=o/k,i.velocityY=n/k,i.targetTouches=l,i.finger=l?l.length:1,i._handled=am,i._preventTouchmoveDefault=function(){j.preventDefault()},U(i.target,i),m(i.identifier)}function aj(d){var c=d.data.timer;d.data.touch=d,d.data.timeStamp=d.timeStamp,c.kick()}function ai(e){var d=e.data.event,f=e.data.timer;ah(),ac(d,f,function(){setTimeout(function(){V(d.target,"click",aC)},0)})}function ah(){V(document,R.move,aj),V(document,R.end,ai)}function ag(f){var e=f.data.event,h=f.data.timer,g=ax(f,e);g&&(f.preventDefault(),e.targetTouches=f.targetTouches,f.data.touch=g,f.data.timeStamp=f.timeStamp,h.kick())}function af(f){var e=f.data.event,h=f.data.timer,g=ay(f.changedTouches,e.identifier);g&&(ae(e),ac(e,h))}function ae(b){V(document,"."+b.identifier,ag),V(document,"."+b.identifier,af)}function ad(f,e,h){var g=h-f.timeStamp;f.type="move",f.distX=e.pageX-f.startX,f.distY=e.pageY-f.startY,f.deltaX=e.pageX-f.pageX,f.deltaY=e.pageY-f.pageY,f.velocityX=0.3*f.velocityX+0.7*f.deltaX/g,f.velocityY=0.3*f.velocityY+0.7*f.deltaY/g,f.pageX=e.pageX,f.pageY=e.pageY}function ac(e,d,f){d.end(function(){return e.type="moveend",U(e.target,e),f&&f()})}function ab(){return W(this,"movestart.move",al),!0}function aa(){return V(this,"dragstart drag",aB),V(this,"mousedown touchstart",aA),V(this,"movestart",al),!0}function Z(b){"move"!==b.namespace&&"moveend"!==b.namespace&&(W(this,"dragstart."+b.guid+" drag."+b.guid,aB,aF,b.selector),W(this,"mousedown."+b.guid,aA,aF,b.selector))}function Y(b){"move"!==b.namespace&&"moveend"!==b.namespace&&(V(this,"dragstart."+b.guid+" drag."+b.guid),V(this,"mousedown."+b.guid))}var X=6,W=aG.event.add,V=aG.event.remove,U=function(a,f,e){aG.event.trigger(f,e,a)},T=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){return window.setTimeout(function(){b()},25)}}(),S={textarea:!0,input:!0,select:!0,button:!0},R={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},Q={move:"touchmove",cancel:"touchend",end:"touchend"};aG.event.special.movestart={setup:ab,teardown:aa,add:Z,remove:Y,_default:function(b){function h(){ad(e,c.touch,c.timeStamp),U(b.target,e)}var e,c;b._handled()&&(e={target:b.target,startX:b.startX,startY:b.startY,pageX:b.pageX,pageY:b.pageY,distX:b.distX,distY:b.distY,deltaX:b.deltaX,deltaY:b.deltaY,velocityX:b.velocityX,velocityY:b.velocityY,timeStamp:b.timeStamp,identifier:b.identifier,targetTouches:b.targetTouches,finger:b.finger},c={event:e,timer:new aE(h),touch:aF,timeStamp:aF},b.identifier===aF?(W(b.target,"click",aC),W(document,R.move,aj,c),W(document,R.end,ai,c)):(b._preventTouchmoveDefault(),W(document,Q.move+"."+b.identifier,ag,c),W(document,Q.end+"."+b.identifier,af,c)))}},aG.event.special.move={setup:function(){W(this,"movestart.move",aG.noop)},teardown:function(){V(this,"movestart.move",aG.noop)}},aG.event.special.moveend={setup:function(){W(this,"movestart.moveend",aG.noop)},teardown:function(){V(this,"movestart.moveend",aG.noop)}},W(document,"mousedown.move",aw),W(document,"touchstart.move",ar),"function"==typeof Array.prototype.indexOf&&!function(e){for(var d=["changedTouches","targetTouches"],f=d.length;f--;){-1===e.event.props.indexOf(d[f])&&e.event.props.push(d[f])}}(aG)}),window.WYSIWYGModernizr=function(R,Q,P){function O(b){E.cssText=b}function N(d,c){return typeof d===c}var M,L,K,J="2.7.1",I={},H=Q.documentElement,G="modernizr",F=Q.createElement(G),E=F.style,D=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),C={},B=[],A=B.slice,z=function(v,u,t,s){var r,q,p,o,l=Q.createElement("div"),k=Q.body,b=k||Q.createElement("body");if(parseInt(t,10)){for(;t--;){p=Q.createElement("div"),p.id=s?s[t]:G+(t+1),l.appendChild(p)}}return r=["&#173;",'<style id="s',G,'">',v,"</style>"].join(""),l.id=G,(k?l:b).innerHTML+=r,b.appendChild(l),k||(b.style.background="",b.style.overflow="hidden",o=H.style.overflow,H.style.overflow="hidden",H.appendChild(b)),q=u(l,v),k?l.parentNode.removeChild(l):(b.parentNode.removeChild(b),H.style.overflow=o),!!q},y=function(a){var f=R.matchMedia||R.msMatchMedia;if(f){return f(a).matches}var e;return z("@media "+a+" { #"+G+" { position: absolute; } }",function(c){e="absolute"==(R.getComputedStyle?getComputedStyle(c,null):c.currentStyle).position}),e},x={}.hasOwnProperty;K=N(x,"undefined")||N(x.call,"undefined")?function(d,c){return c in d&&N(d.constructor.prototype[c],"undefined")}:function(d,c){return x.call(d,c)},Function.prototype.bind||(Function.prototype.bind=function(f){var e=this;if("function"!=typeof e){throw new TypeError}var h=A.call(arguments,1),g=function(){if(this instanceof g){var c=function(){};c.prototype=e.prototype;var b=new c,a=e.apply(b,h.concat(A.call(arguments)));return Object(a)===a?a:b}return e.apply(f,h.concat(A.call(arguments)))};return g}),C.touch=function(){var a;return"ontouchstart" in R||R.DocumentTouch&&Q instanceof DocumentTouch?a=!0:z(["@media (",D.join("touch-enabled),("),G,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(b){a=9===b.offsetTop}),a};for(var w in C){K(C,w)&&(L=w.toLowerCase(),I[L]=C[w](),B.push((I[L]?"":"no-")+L))}return I.addTest=function(e,c){if("object"==typeof e){for(var f in e){K(e,f)&&I.addTest(f,e[f])}}else{if(e=e.toLowerCase(),I[e]!==P){return I}c="function"==typeof c?c():c,"undefined"!=typeof enableClasses&&enableClasses&&(H.className+=" "+(c?"":"no-")+e),I[e]=c}return I},O(""),F=M=null,I._version=J,I._prefixes=D,I.mq=y,I.testStyles=z,I}(this,this.document),!function(b){b.Editable.DEFAULTS=b.extend(b.Editable.DEFAULTS,{allowedEmptyTags:["table","thead","tbody","tfoot","tr","th","td","a","span","iframe","div","object","param","embed","video","source","i"],selfClosingTags:["br","button","input","img","hr","param","!--","source","embed"]}),b.Editable.TAG_ORDER=["main","section","header","footer","article","details","legend","summary","table","thead","tbody","tfoot","tr","th","td","ul","ol","li","h1","h2","h3","h4","h5","h6","pre","blockquote","p","a","strong","em","strike","u","span","iframe","object","param","video","source","embed"],b.Editable.prototype.isClosingTag=function(c){return c?null!==c.match(/^<\/([a-zA-Z0-9]+)([^<]+)*>$/gi):!1},b.Editable.prototype.tagName=function(c){return c.replace(/^<\/?([a-zA-Z0-9-!]+)([^<]+)*>$/gi,"$1").toLowerCase()},b.Editable.SELF_CLOSING_AFTER=["source"],b.Editable.prototype.isSelfClosingTag=function(d){var c=this.tagName(d);return this.options.selfClosingTags.indexOf(c.toLowerCase())>=0},b.Editable.prototype.tagKey=function(c){return c.type+(c.attrs||[]).sort().join("|")},b.Editable.prototype.extendedKey=function(c){return this.tagKey(c)+JSON.stringify(c.style)},b.Editable.prototype.mergeStyle=function(a,l){for(var k={},j=b.Editable.uniq(b.merge(Object.keys(a.style),Object.keys(l.style))),i=0;i<j.length;i++){var h=j[i];k[h]=null!=l.style[h]?l.style[h]:a.style[h]}return k},b.Editable.prototype.mapDOM=function(ah,ag){void 0===ag&&(ag=!0);var af,ae,ad,ac,ab=0,aa=0,Z=[],Y="",X=[],W={},V={},U=!1;ag&&(ah=ah.replace(/\u200B/gi,""));for(var T=0;T<ah.length;T++){if(af=ah.charAt(T),"<"==af){var R=ah.indexOf(">",T+1);if(-1!==R){if(aa++,ae=ah.substring(T,R+1),ac=this.tagName(ae),this.isSelfClosingTag(ae)){V[ab]||(V[ab]=[]),V[ab].push({i:aa,content:ae}),T=R;continue}var P=null,N=ae.replace(/^<[\S\s]* style=("[^"]+"|'[^']+')[\S\s]*>$/gi,"$1"),L={};if(N!=ae&&(N=N.substring(1,N.length-1),matches=N.match(/([^:]*):([^:;]*;|$)/gi))){for(var J=0;J<matches.length;J++){var I=matches[J].split(":"),H=I.slice(1).join(":").trim();";"==H[H.length-1]&&(H=H.substr(0,H.length-1)),L[I[0].trim()]=H}}P=ae.match(/([\w\-]*)=("[^<>"]*"|'[^<>']*'|\w+)/gi);var G=null;if(P){for(var F=0;F<P.length;F++){0===P[F].indexOf("class=")&&(G=P[F]),0===P[F].indexOf("style=")&&P.splice(F,1)}}"b"==ac&&(ac="strong"),"i"==ac&&(!G||G.indexOf("fa-")<0)&&U===!1&&(ac="em");var a=this.isClosingTag(ae);if("i"==ac&&(U=a?!1:!0),a){var S=W[ac].pop();ab==Z[S].start&&this.options.allowedEmptyTags.indexOf(ac.toLowerCase())>=0&&(V[ab]||(V[ab]=[]),V[ab].push({i:Z[S].i,content:Z[S].original}),V[ab].push({i:aa,content:ae}))}else{this.valid_nodes.indexOf(ac.toUpperCase())>=0&&(P?P.push('data-fr-idx="'+T+'"'):P=['data-fr-idx="'+T+'"']),Z.push({type:ac,attrs:P,style:L,start:ab,i:aa,original:ae}),W[ac]||(W[ac]=[]),W[ac].push(Z.length-1)}T=R}}else{Y+=af,X[ab]={};for(ac in W){ad=W[ac];for(var Q=0;Q<ad.length;Q++){ae=Z[ad[Q]];var O=this.tagKey(ae);X[ab][O]?X[ab][O].style=this.mergeStyle(X[ab][O],ae):X[ab][O]=b.extend({},ae)}}ab++}}var M=[];for(T=0;T<X.length;T++){M[T]={};for(var K in X[T]){M[T][this.extendedKey(X[T][K])]=X[T][K]}}return{text:Y,format:M,simple_tags:V}},b.Editable.prototype.froalaDOM=function(a){for(var n,m=[],l={},k=0;k<a.length;k++){var j=a[k];for(n in l){j[n]||(l[n].end=k,m.push(b.extend({},l[n])),delete l[n])}for(var i in j){l[i]||(j[i].start=k,l[i]=j[i])}}for(n in l){l[n].end=a.length,m.push(l[n])}return m},b.Editable.prototype.sortNodes=function(a,d){return b.Editable.TAG_ORDER.indexOf(a.type)-b.Editable.TAG_ORDER.indexOf(d.type)},b.Editable.prototype.sortSimpleTags=function(d,c){return d.i-c.i},b.Editable.prototype.openTag=function(g){var f="<"+g.type;if(g.attrs){g.attrs.sort();for(var j=0;j<g.attrs.length;j++){f+=" "+g.attrs[j]}}var i="";for(var h in g.style){null!=g.style[h]&&(i+=h.replace("_","-")+": "+g.style[h]+"; ")}return""!==i&&(f+=' style="'+i.trim()+'"'),f+=">"},b.Editable.prototype.cleanOutput=function(F,E){var D,C,B,A,z=this.mapDOM(F,E),y=this.froalaDOM(z.format),x=z.simple_tags,w=z.text,v={};for(C=0;C<y.length;C++){D=y[C],v[D.start]||(v[D.start]=[]),v[D.start].push(D)}var u={};for(F="",C=0;C<=w.length;C++){var t=[];if(u[C]){for(var s in u){if(s>C){for(B=0;B<u[s].length;B++){var r=u[s][B];r.start>=u[C][u[C].length-1].start&&b.Editable.TAG_ORDER.indexOf(r.type)>b.Editable.TAG_ORDER.indexOf(u[C][u[C].length-1].type)&&this.valid_nodes.indexOf(r.type.toUpperCase())<0&&(F+="</"+r.type+">",t.push(r),u[s].splice(B,1))}}}for(B=0;B<u[C].length;B++){F+="</"+u[C][B].type+">"}}for(v[C]||(v[C]=[]);t.length>0;){var a=t.pop();a.start=C,v[C].push(a)}if(v[C]){for(v[C]=v[C].sort(this.sortNodes),B=0;B<v[C].length;B++){D=v[C][B],u[D.end]||(u[D.end]=[]),u[D.end].push(D),F+=this.openTag(D)}}if(x[C]){for(x[C]=x[C].sort(this.sortSimpleTags),A=0;A<x[C].length;A++){F+=x[C][A].content}}C!=w.length&&(F+=w[C])}return F},b.Editable.prototype.cleanify=function(a,n){var m;if(this.isHTML){return !1}void 0===a&&(a=!0),this.no_verify=!0,this.saveSelectionByMarkers(),m=a?this.getSelectionElements():this.$element.find(this.valid_nodes.join(","));var l,k;if(m[0]!=this.$element.get(0)){for(var j=0;j<m.length;j++){var i=b(m[j]);0===i.find(this.valid_nodes.join(",")).length&&(l=i.html(),k=this.cleanOutput(l,n),k!==l&&i.html(k))}}else{0===this.$element.find(this.valid_nodes.join(",")).length&&(l=this.$element.html(),k=this.cleanOutput(l,n),k!==l&&this.$element.html(k))}this.$element.find("[data-fr-idx]").removeAttr("data-fr-idx"),this.restoreSelectionByMarkers(),this.focus(),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1}}(jQuery);