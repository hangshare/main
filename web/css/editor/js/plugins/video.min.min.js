/*!
 * froala_editor v1.2.8 (https://www.froala.com/wysiwyg-editor)
 * License https://www.froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(b){b.Editable.DEFAULTS=b.extend(b.Editable.DEFAULTS,{videoAllowedAttrs:["src","width","height","frameborder","allowfullscreen","webkitallowfullscreen","mozallowfullscreen","href","target","id","controls","value","name"],videoAllowedTags:["iframe","object","param","video","source","embed"],defaultVideoAlignment:"center",textNearVideo:!0}),b.Editable.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?(.+)/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/(videos-for-you|popular)?\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],b.Editable.video_commands={floatVideoLeft:{title:"Float Left",icon:{type:"font",value:"fa fa-align-left"}},floatVideoNone:{title:"Float None",icon:{type:"font",value:"fa fa-align-justify"}},floatVideoRight:{title:"Float Right",icon:{type:"font",value:"fa fa-align-right"}},removeVideo:{title:"Remove Video",icon:{type:"font",value:"fa fa-trash-o"}}},b.Editable.DEFAULTS=b.extend(b.Editable.DEFAULTS,{videoButtons:["floatVideoLeft","floatVideoNone","floatVideoRight","removeVideo"]}),b.Editable.commands=b.extend(b.Editable.commands,{insertVideo:{title:"Insert Video",icon:"fa fa-video-camera",callback:function(){this.insertVideo()},undo:!1}}),b.Editable.prototype.insertVideo=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertVideo")),this.selectionInEditor()&&this.saveSelection(),this.showInsertVideo(),this.$video_wrapper.find("textarea").val("")},b.Editable.prototype.insertVideoHTML=function(){var c='<div class="froala-popup froala-video-popup" style="display: none;"><h4><span data-text="true">Insert Video</span><i title="Cancel" class="fa fa-times" id="f-video-close-'+this._id+'"></i></h4><div class="f-popup-line"><textarea placeholder="Embedded code" id="f-video-textarea-'+this._id+'"></textarea></div><p class="or"><span data-text="true">or</span></p><div class="f-popup-line"><input type="text" placeholder="http://youtube.com/" id="f-video-input-'+this._id+'"/><button data-text="true" class="f-ok f-submit fr-p-bttn" id="f-video-ok-'+this._id+'">OK</button></div></div>';return c},b.Editable.prototype.buildInsertVideo=function(){this.$video_wrapper=b(this.insertVideoHTML()),this.$popup_editor.append(this.$video_wrapper),this.addListener("hidePopups",this.hideVideoWrapper),this.$video_wrapper.on("mouseup touchend",b.proxy(function(c){this.isResizing()||c.stopPropagation()},this)),this.$video_wrapper.on("mouseup keydown","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,b.proxy(function(c){c.stopPropagation()},this));var a=this;this.$video_wrapper.on("change","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,function(){"INPUT"==this.tagName?a.$video_wrapper.find("textarea#f-video-textarea-"+a._id).val(""):"TEXTAREA"==this.tagName&&a.$video_wrapper.find("input#f-video-input-"+a._id).val("")}),this.$video_wrapper.on("click","button#f-video-ok-"+this._id,b.proxy(function(){var d=this.$video_wrapper.find("input#f-video-input-"+this._id),c=this.$video_wrapper.find("textarea#f-video-textarea-"+this._id);""!==d.val()?this.writeVideo(d.val(),!1):""!==c.val()&&this.writeVideo(c.val(),!0)},this)),this.$video_wrapper.on(this.mouseup,"i#f-video-close-"+this._id,b.proxy(function(){this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.options.inlineMode&&!this.imageMode&&0===this.options.buttons.length&&this.hide(),this.restoreSelection(),this.focus(),this.options.inlineMode||this.hide()},this)),this.$video_wrapper.on("click",function(c){c.stopPropagation()}),this.$video_wrapper.on("click","*",function(c){c.stopPropagation()}),this.$window.on("keydown."+this._id,b.proxy(function(d){if(this.$element.find(".f-video-editor.active").length>0){var e=d.which;if(46==e||8==e){return d.stopPropagation(),d.preventDefault(),setTimeout(b.proxy(function(){this.removeVideo()},this),0),!1}}},this))},b.Editable.prototype.destroyVideo=function(){this.$video_wrapper.html("").removeData().remove()},b.Editable.prototype.initVideo=function(){this.buildInsertVideo(),this.addVideoControls(),this.addListener("destroy",this.destroyVideo)},b.Editable.initializers.push(b.Editable.prototype.initVideo),b.Editable.prototype.hideVideoEditorPopup=function(){this.$video_editor&&(this.$video_editor.hide(),b("span.f-video-editor").removeClass("active"),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0))},b.Editable.prototype.showVideoEditorPopup=function(){this.hidePopups(),this.$video_editor&&this.$video_editor.show(),this.$element.removeAttr("contenteditable")},b.Editable.prototype.addVideoControlsHTML=function(){this.$video_editor=b('<div class="froala-popup froala-video-editor-popup" style="display: none">');for(var a=b('<div class="f-popup-line">').appendTo(this.$video_editor),j=0;j<this.options.videoButtons.length;j++){var i=this.options.videoButtons[j];if(void 0!==b.Editable.video_commands[i]){var h=b.Editable.video_commands[i],g='<button class="fr-bttn" data-callback="'+i+'" data-cmd="'+i+'" title="'+h.title+'">';g+=void 0!==this.options.icons[i]?this.prepareIcon(this.options.icons[i],h.title):this.prepareIcon(h.icon,h.title),g+="</button>",a.append(g)}}this.addListener("hidePopups",this.hideVideoEditorPopup),this.$popup_editor.append(this.$video_editor),this.bindCommandEvents(this.$video_editor)},b.Editable.prototype.floatVideoLeft=function(){b("span.f-video-editor.active").attr("class","f-video-editor active fr-fvl"),this.triggerEvent("videoFloatedLeft"),b("span.f-video-editor.active").click()},b.Editable.prototype.floatVideoRight=function(){b("span.f-video-editor.active").attr("class","f-video-editor active fr-fvr"),this.triggerEvent("videoFloatedRight"),b("span.f-video-editor.active").click()},b.Editable.prototype.floatVideoNone=function(){b("span.f-video-editor.active").attr("class","f-video-editor active fr-fvn"),this.triggerEvent("videoFloatedNone"),b("span.f-video-editor.active").click()},b.Editable.prototype.removeVideo=function(){b("span.f-video-editor.active").remove(),this.hide(),this.triggerEvent("videoRemoved"),this.focus()},b.Editable.prototype.refreshVideo=function(){this.$element.find("iframe, object").each(function(a,j){for(var i=b(j),h=0;h<b.Editable.VIDEO_PROVIDERS.length;h++){var g=b.Editable.VIDEO_PROVIDERS[h];if(g.test_regex.test(i.attr("src"))){0===i.parents(".f-video-editor").length&&i.wrap('<span class="f-video-editor fr-fvn" data-fr-verified="true" contenteditable="false">');break}}}),this.browser.msie&&this.$element.find(".f-video-editor").each(function(){this.oncontrolselect=function(){return !1}}),this.options.textNearVideo||this.$element.find(".f-video-editor").attr("contenteditable",!1).addClass("fr-tnv")},b.Editable.prototype.addVideoControls=function(){this.addVideoControlsHTML(),this.addListener("sync",this.refreshVideo),this.$element.on("mousedown","span.f-video-editor",b.proxy(function(c){c.stopPropagation()},this)),this.$element.on("click touchend","span.f-video-editor",b.proxy(function(a){if(this.isDisabled){return !1}a.preventDefault(),a.stopPropagation();var d=a.currentTarget;this.clearSelection(),this.showVideoEditorPopup(),this.showByCoordinates(b(d).offset().left+b(d).width()/2,b(d).offset().top+b(d).height()+3),b(d).addClass("active"),this.refreshVideoButtons(d)},this))},b.Editable.prototype.refreshVideoButtons=function(a){var d=b(a).attr("class");this.$video_editor.find("[data-cmd]").removeClass("active"),d.indexOf("fr-fvl")>=0?this.$video_editor.find('[data-cmd="floatVideoLeft"]').addClass("active"):d.indexOf("fr-fvr")>=0?this.$video_editor.find('[data-cmd="floatVideoRight"]').addClass("active"):this.$video_editor.find('[data-cmd="floatVideoNone"]').addClass("active")},b.Editable.prototype.writeVideo=function(a,n){var m=null;if(n){m=this.clean(a,!0,!1,this.options.videoAllowedTags,this.options.videoAllowedAttrs)}else{for(var l=0;l<b.Editable.VIDEO_PROVIDERS.length;l++){var k=b.Editable.VIDEO_PROVIDERS[l];if(k.test_regex.test(a)){a=a.replace(k.url_regex,k.url_text),m=k.html.replace(/\{url\}/,a);break}}}if(m){this.restoreSelection(),this.$element.focus();var j="fr-fvn";"left"==this.options.defaultVideoAlignment&&(j="fr-fvl"),"right"==this.options.defaultVideoAlignment&&(j="fr-fvr"),this.textNearVideo||(j+=" fr-tnv");try{this.insertHTML('<span contenteditable="false" class="f-video-editor '+j+'" data-fr-verified="true">'+m+"</span>")}catch(i){}this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.hide(),this.triggerEvent("videoInserted",[m])}else{this.triggerEvent("videoError")}},b.Editable.prototype.showVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.show(),this.$video_wrapper.find(".f-popup-line input").val(""))},b.Editable.prototype.hideVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.hide(),this.$video_wrapper.find("input").blur())},b.Editable.prototype.showInsertVideo=function(){this.hidePopups(),this.showVideoWrapper()}}(jQuery);