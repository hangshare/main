/*!
 * froala_editor v1.2.8 (https://www.froala.com/wysiwyg-editor)
 * License https://www.froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(b){b.Editable.DEFAULTS=b.extend(b.Editable.DEFAULTS,{mediaManager:!0,imagesLoadURL:"http://i.froala.com/images",imagesLoadParams:{}}),b.Editable.prototype.showMediaManager=function(){this.$image_modal.show(),this.$overlay.show(),this.loadImages(),this.$document.find("body").css("overflow","hidden")},b.Editable.prototype.hideMediaManager=function(){this.$image_modal.hide(),this.$overlay.hide(),this.$document.find("body").css("overflow","")},b.Editable.prototype.mediaModalHTML=function(){var c='<div class="froala-modal"><div class="f-modal-wrapper"><h4><span data-text="true">Manage images</span><i title="Cancel" class="fa fa-times" id="f-modal-close-'+this._id+'"></i></h4>';return c+='<img class="f-preloader" id="f-preloader-'+this._id+'" alt="Loading..." src="'+this.options.preloaderSrc+'" style="display: none;">',c+=WYSIWYGModernizr.touch?'<div class="f-image-list f-touch" id="f-image-list-'+this._id+'"></div>':'<div class="f-image-list" id="f-image-list-'+this._id+'"></div>',c+="</div></div>"},b.Editable.prototype.buildMediaManager=function(){this.$image_modal=b(this.mediaModalHTML()).appendTo("body"),this.$preloader=this.$image_modal.find("#f-preloader-"+this._id),this.$media_images=this.$image_modal.find("#f-image-list-"+this._id),this.$overlay=b('<div class="froala-overlay">').appendTo("body"),this.$overlay.on("mouseup",b.proxy(function(c){this.isResizing()||c.stopPropagation()},this)),this.$image_modal.on("mouseup",b.proxy(function(c){this.isResizing()||c.stopPropagation()},this)),this.$image_modal.find("i#f-modal-close-"+this._id).click(b.proxy(function(){this.hideMediaManager()},this)),this.$media_images.on(this.mouseup,"img",b.proxy(function(a){a.stopPropagation();var d=a.currentTarget;this.writeImage(b(d).attr("src")),this.hideMediaManager()},this)),this.$media_images.on(this.mouseup,".f-delete-img",b.proxy(function(a){a.stopPropagation();var f=b(a.currentTarget).prev(),e="Are you sure? Image will be deleted.";b.Editable.LANGS[this.options.language]&&(e=b.Editable.LANGS[this.options.language].translation[e]),confirm(e)&&this.triggerEvent("beforeDeleteImage",[b(f)],!1)!==!1&&(b(f).parent().addClass("f-img-deleting"),this.deleteImage(b(f)))},this)),this.options.mediaManager&&(this.$image_wrapper.on("click","#f-browser-"+this._id,b.proxy(function(){this.showMediaManager()},this)).on("click","#f-browser-"+this._id+" i",b.proxy(function(){this.showMediaManager()},this)),this.$image_wrapper.find("#f-browser-"+this._id).show()),this.hideMediaManager()},b.Editable.prototype.destroyMediaManager=function(){this.hideMediaManager(),this.$overlay.html("").removeData().remove(),this.$image_modal.html("").removeData().remove()},b.Editable.prototype.initMediaManager=function(){return this.options.mediaManager?(this.buildMediaManager(),void this.addListener("destroy",this.destroyMediaManager)):!1},b.Editable.initializers.push(b.Editable.prototype.initMediaManager),b.Editable.prototype.processLoadedImages=function(e){try{if(e.error){this.throwImagesLoadErrorWithMessage(e.error)}else{this.$media_images.empty();for(var d=0;d<e.length;d++){e[d].src?this.loadImage(e[d].src,e[d].info):this.loadImage(e[d])}}}catch(f){this.throwLoadImagesError(4)}},b.Editable.prototype.throwImagesLoadErrorWithMessage=function(c){this.triggerEvent("imagesLoadError",[{message:c,code:0}],!1),this.hideImageLoader()},b.Editable.prototype.loadImages=function(){this.$preloader.show(),this.$media_images.empty(),this.options.imagesLoadURL?(b.support.cors=!0,b.getJSON(this.options.imagesLoadURL,this.options.imagesLoadParams,b.proxy(function(c){this.triggerEvent("imagesLoaded",[c],!1),this.processLoadedImages(c),this.$preloader.hide()},this)).fail(b.proxy(function(){this.throwLoadImagesError(2)},this))):this.throwLoadImagesError(3)},b.Editable.prototype.throwLoadImagesError=function(d){void 0===d&&(d=-1);var c="Unknown image upload error.";1==d?c="Bad link.":2==d?c="Error during request.":3==d?c="Missing imagesLoadURL option.":4==d&&(c="Parsing response failed."),this.triggerEvent("imagesLoadError",[{code:d,message:c}],!1),this.$preloader.hide()},b.Editable.prototype.loadImage=function(a,h){var g=new Image,f=b("<div>").addClass("f-empty");g.onload=b.proxy(function(){var i="Delete";b.Editable.LANGS[this.options.language]&&(i=b.Editable.LANGS[this.options.language].translation[i]);var e=b('<img src="'+a+'"/>');for(var c in h){e.attr("data-"+c,h[c])}f.append(e).append('<a class="f-delete-img"><span data-text="true">'+i+"</span></a>"),f.removeClass("f-empty"),this.$media_images.hide(),this.$media_images.show(),this.triggerEvent("imageLoaded",[a],!1)},this),g.onerror=b.proxy(function(){f.remove(),this.throwLoadImagesError(1)},this),g.src=a,this.$media_images.append(f)}}(jQuery);