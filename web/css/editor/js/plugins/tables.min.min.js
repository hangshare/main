/*!
 * froala_editor v1.2.8 (https://www.froala.com/wysiwyg-editor)
 * License https://www.froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(b){b.Editable.commands=b.extend(b.Editable.commands,{table:{title:"Table",icon:"fa fa-table",callback:function(e,d,f){this.table_commands[d]?this.table_commands[d].apply(this,[d,f]):this.table_commands.insertTable.apply(this,[d,f]),this.cleanupTables()}}}),b.Editable.DEFAULTS.buttons[b.Editable.DEFAULTS.buttons.indexOf("insertHorizontalRule")]="table",b.Editable.prototype.table_commands={insertTable:function(d,c){this.insertTable(d,c)},insertRowAbove:function(){this.insertRow("above")},insertRowBelow:function(){this.insertRow("below")},insertColumnBefore:function(){this.insertColumn("before")},insertColumnAfter:function(){this.insertColumn("after")},deleteColumn:function(){this.deleteColumn()},deleteRow:function(){this.deleteRow()},insertCellBefore:function(){this.insertCell("before")},insertCellAfter:function(){this.insertCell("after")},mergeCells:function(){this.mergeCells()},deleteCell:function(){this.deleteCell()},splitVertical:function(){this.splitVertical()},splitHorizontal:function(){this.splitHorizontal()},insertHeader:function(){this.insertHeader()},deleteHeader:function(){this.deleteHeader()},deleteTable:function(){this.deleteTable()}},b.Editable.prototype.command_dispatcher=b.extend(b.Editable.prototype.command_dispatcher,{table:function(e){var d=this.buildDropdownTable(),f=this.buildDropdownButton(e,d,"fr-table");return this.bindTableDropdownEvents(),f}}),b.Editable.prototype.tableTab=function(){var a;this.currentCell&&(a=this.currentCell());var d=b(this.getSelectionElement());return d.parents("ul, ol").length>0?!0:a&&this.nextCell()?(this.setSelection(this.nextCell()),!1):void 0},b.Editable.prototype.tableShiftTab=function(){var a;this.currentCell&&(a=this.currentCell());var d=b(this.getSelectionElement());return d.parents("ul, ol").length>0?!0:a&&this.prevCell()?(this.setSelection(this.prevCell()),!1):void 0},b.Editable.prototype.initTable=function(){var a=this;this.$editor.on("click mouseup touch touchend",".fr-table a",function(d){d.preventDefault(),d.stopPropagation(),a.android()&&(b(this).parent().siblings().removeClass("hover"),b(this).parent().addClass("hover"))}),this.addListener("tab",this.tableTab),this.addListener("shift+tab",this.tableShiftTab)},b.Editable.initializers.push(b.Editable.prototype.initTable),b.Editable.prototype.buildDropdownTable=function(){var g='<ul class="fr-dropdown-menu fr-table">';g+='<li> <a href="#"><span data-text="true">Insert table</span> <i class="fa fa-chevron-right"></i></a><div class="select-table"> ',g+='<div class="fr-t-info">1 x 1</div>';for(var f=1;10>=f;f++){for(var j=1;10>=j;j++){var i="inline-block";(f>5||j>5)&&(i="none");var h="fr-bttn ";1==f&&1==j&&(h+=" hover"),g+='<span class="'+h+'" data-cmd="table" data-val="'+f+'" data-param="'+j+'" style="display: '+i+';"><span></span></span>'}g+='<div class="new-line"></div>'}return g+="</div> </li>",g+='<li><a href="#"><span data-text="true">Cell</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertCellBefore"><a href="#" data-text="true">Insert cell before</a></li><li data-cmd="table" data-val="insertCellAfter"><a href="#" data-text="true">Insert cell after</a></li><li data-cmd="table" data-val="deleteCell"><a href="#" data-text="true">Delete cell</a></li><li data-cmd="table" data-val="mergeCells"><a href="#" data-text="true">Merge cells</a></li><li data-cmd="table" data-val="splitHorizontal"><a href="#" data-text="true">Horizontal split</a></li><li data-cmd="table" data-val="splitVertical"><a href="#" data-text="true">Vertical split</a></li></ul></li>',g+='<li><a href="#"><span data-text="true">Row</span> <i class="fa fa-chevron-right"></i></a> <ul><li data-cmd="table" data-val="insertRowAbove"><a href="#" data-text="true">Insert row above</a></li><li data-cmd="table" data-val="insertRowBelow"><a href="#" data-text="true">Insert row below</a></li><li data-cmd="table" data-val="deleteRow"><a href="#" data-text="true">Delete row</a></li></ul></li>',g+='<li><a href="#"><span data-text="true">Column</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertColumnBefore"><a href="#" data-text="true">Insert column before</a></li> <li data-cmd="table" data-val="insertColumnAfter"><a href="#" data-text="true">Insert column after</a></li> <li data-cmd="table" data-val="deleteColumn"><a href="#" data-text="true">Delete column</a></li> </ul></li>',g+='<li data-cmd="table" data-val="deleteTable"><a href="#" data-text="true">Delete table</a></li>',g+="</ul>"},b.Editable.prototype.bindTableDropdownEvents=function(){var a=this;this.$bttn_wrapper.on("mouseenter",".fr-table .select-table > span",function(){var l=b(this).data("val"),k=b(this).data("param");a.$bttn_wrapper.find(".fr-table .select-table .fr-t-info").text(l+" x "+k),a.$bttn_wrapper.find(".fr-table .select-table > span").removeClass("hover");for(var j=1;10>=j;j++){for(var i=0;10>=i;i++){var h=a.$bttn_wrapper.find('.fr-table .select-table > span[data-val="'+j+'"][data-param="'+i+'"]');l>=j&&k>=i?h.addClass("hover"):(l+1>=j||5>=j)&&(k+1>=i||5>=i)?h.css("display","inline-block"):(j>5||i>5)&&h.css("display","none")}}}),this.$bttn_wrapper.on("mouseleave",".fr-table .select-table",function(){a.$bttn_wrapper.find('.fr-table .select-table > span[data-val="1"][data-param="1"]').trigger("mouseenter")}),this.android()&&this.$bttn_wrapper.on("touchend",".fr-table .fr-trigger",function(){b(this).parents(".fr-table").find(".hover").removeClass("hover")})},b.Editable.prototype.tableMap=function(){var a=this.currentTable(),d=[];return a&&a.find("tr:not(:empty)").each(function(c,i){var h=b(i),g=0;h.find("th, td").each(function(q,p){for(var o=b(p),n=parseInt(o.attr("colspan"),10)||1,m=parseInt(o.attr("rowspan"),10)||1,l=c;c+m>l;l++){for(var f=g;g+n>f;f++){d[l]||(d[l]=[]),d[l][f]?g++:d[l][f]=p}}g+=n})}),d},b.Editable.prototype.cellOrigin=function(f,e){for(var h=0;h<e.length;h++){for(var g=0;g<e[h].length;g++){if(e[h][g]==f){return{row:h,col:g}}}}},b.Editable.prototype.canMergeCells=function(){var x=this.getSelectionCells();if(x.length<2){return !1}for(var w=this.tableMap(),v=0,u=32000,t=0,s=32000,r=0,q=0;q<x.length;q++){var p=b(x[q]),o=parseInt(p.attr("colspan"),10)||1,n=parseInt(p.attr("rowspan"),10)||1,a=this.cellOrigin(x[q],w);v+=o*n,u=Math.min(u,a.col),t=Math.max(t,a.col+o),s=Math.min(s,a.row),r=Math.max(r,a.row+n)}return v==(t-u)*(r-s)?{row:s,col:u,colspan:t-u,rowspan:r-s,map:w,cells:x}:null},b.Editable.prototype.getSelectionCells=function(){var t,s=[];if(this.browser.webkit||this.browser.msie){var r=this.getSelectionElements();for(t=0;t<r.length;t++){("TD"==r[t].tagName||"TH"==r[t].tagName)&&s.push(r[t])}}else{var q=this.getRanges();for(t=0;t<q.length;t++){var p=q[t],o=!1;if("TD"==p.startContainer.tagName||"TH"==p.startContainer.tagName){s.push(p.startContainer),o=!0}else{var n=p.startContainer.childNodes,m=p.startOffset;if(n.length>m&&m>=0){var l=n[m];("TD"==l.tagName||"TH"==l.tagName)&&(s.push(l),o=!0)}}if(o===!1){var a=b(p.startContainer).parents("td:first, th:first");a.length>0&&s.push(a.get(0))}}}return s},b.Editable.prototype.currentCell=function(){var c=this.getSelectionCells();return c.length>0?c[0]:null},b.Editable.prototype.prevCell=function(){var a=this.currentCell();if(a){if(b(a).prev("td").length){return b(a).prev("td").get(0)}if(b(a).parent().prev("tr").find("td").length){return b(a).parent().prev("tr").find("td:last").get(0)}}return null},b.Editable.prototype.nextCell=function(){var a=this.currentCell();if(a){if(b(a).next("td").length){return b(a).next("td").get(0)}if(b(a).parent().next("tr").find("td").length){return b(a).parent().next("tr").find("td").get(0)}}return null},b.Editable.prototype.currentTable=function(){for(var a=b(this.getSelectionElement());a.get(0)!=this.$element.get(0)&&a.get(0)!=this.$document.find("body").get(0)&&"TABLE"!=a.get(0).tagName;){a=a.parent()}return a.get(0)!=this.$element.get(0)?a:null},b.Editable.prototype.focusOnTable=function(){var d=this.currentTable();if(d){var c=d.find("td:first");this.setSelection(c.get(0))}},b.Editable.prototype.insertCell=function(a){for(var h=this.getSelectionCells(),g=0;g<h.length;g++){var f=b(h[g]);"before"==a?f.before(f.clone().removeAttr("colspan").removeAttr("rowspan").html(b.Editable.INVISIBLE_SPACE)):"after"==a&&f.after(f.clone().removeAttr("colspan").removeAttr("rowspan").html(b.Editable.INVISIBLE_SPACE))}"before"==a?this.triggerEvent("cellInsertedBefore"):"after"==a&&this.triggerEvent("cellInsertedAfter")},b.Editable.prototype.mergeCells=function(){var a=this.canMergeCells();if(a){var j=b(a.map[a.row][a.col]);j.attr("colspan",a.colspan),j.attr("rowspan",a.rowspan);for(var i=0;i<a.cells.length;i++){var h=a.cells[i];if(j.get(0)!=h){var g=b(h);j.append(g.html()),g.remove()}}this.setSelection(j.get(0))}this.hide(),this.triggerEvent("cellsMerged")},b.Editable.prototype.deleteCell=function(){for(var a=this.getSelectionCells(),f=0;f<a.length;f++){var e=b(a[f]);e.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("cellDeleted")},b.Editable.prototype.insertHeader=function(){var c=this.currentTable();c&&c.find(" > thead").length>0&&this.triggerEvent("headerInserted")},b.Editable.prototype.deleteHeader=function(){},b.Editable.prototype.insertColumn=function(v){var u=this.currentCell();if(u){for(var t=b(u),s=this.tableMap(),r=this.cellOrigin(t.get(0),s),q=0;q<s.length;q++){var p=s[q][r.col],o=parseInt(b(p).attr("colspan"),10)||1,n=parseInt(b(p).attr("rowspan"),10)||1;if("before"==v){var m=s[q][r.col-1];m?m==p?b(m).attr("colspan",o+1):n>1?b(m).after("<"+m.tagName+">"+b.Editable.INVISIBLE_SPACE+"</"+m.tagName+">"):b(p).before("<"+p.tagName+">"+b.Editable.INVISIBLE_SPACE+"</"+p.tagName+">"):b(p).before("<"+p.tagName+">"+b.Editable.INVISIBLE_SPACE+"</"+p.tagName+">")}else{if("after"==v){var a=s[q][r.col+1];a?a==p?b(a).attr("colspan",o+1):n>1?b(a).before("<"+a.tagName+">"+b.Editable.INVISIBLE_SPACE+"</"+a.tagName+">"):b(p).after("<"+p.tagName+">"+b.Editable.INVISIBLE_SPACE+"</"+p.tagName+">"):b(p).after("<"+p.tagName+">"+b.Editable.INVISIBLE_SPACE+"</"+p.tagName+">")}}}}this.hide(),"before"==v?this.triggerEvent("columnInsertedBefore"):"after"==v&&this.triggerEvent("columnInsertedAfter")},b.Editable.prototype.deleteColumn=function(){for(var a=this.getSelectionCells(),p=0;p<a.length;p++){for(var o=b(a[p]),n=this.tableMap(),m=this.cellOrigin(o.get(0),n),l=0;l<n.length;l++){var k=n[l][m.col],j=parseInt(b(k).attr("colspan"),10)||1;1==j?b(k).remove():b(k).attr("colspan",j-1)}}this.focusOnTable(),this.hide(),this.triggerEvent("columnDeleted")},b.Editable.prototype.insertRow=function(z){var y,x=this.currentCell();if(x){var w=b(x),v=this.tableMap(),u=this.cellOrigin(w.get(0),v),t=0,s=null;for(y=0;y<v[u.row].length;y++){var r=v[u.row][y],q=parseInt(b(r).attr("rowspan"),10)||1;if("above"==z){if(0===u.row){t++}else{var p=v[u.row-1][y];p==r&&s!=r?b(r).attr("rowspan",q+1):t++}}else{if("below"==z){if(u.row==v.length-1){t++}else{var o=v[u.row+1][y];o==r&&s!=r?b(r).attr("rowspan",q+1):t++}}}s=v[u.row][y]}var a="<tr>";for(y=0;t>y;y++){a+="<td>"+b.Editable.INVISIBLE_SPACE+"</td>"}a+="</tr>","below"==z?w.closest("tr").after(a):"above"==z&&w.closest("tr").before(a)}this.hide(),"below"==z?this.triggerEvent("rowInsertedBelow"):"above"==z&&this.triggerEvent("rowInsertedAbove")},b.Editable.prototype.deleteRow=function(){for(var v=this.getSelectionCells(),u=0;u<v.length;u++){var t=b(v[u]),s=this.tableMap(),r=this.cellOrigin(t.get(0),s),q=t.parents("tr:first");if(r){for(var p=0;p<s[r.row].length;p++){var o=s[r.row][p],n=parseInt(b(o).attr("rowspan"),10)||1;if(1==n){b(o).remove()}else{var m=this.cellOrigin(o,s);if(b(o).attr("rowspan",n-1),m.row==r.row){var a=s[r.row+1];a&&a[p-1]&&(b(a[p-1]).after(b(o).clone()),b(o).remove())}}}}q.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("rowDeleted")},b.Editable.prototype.splitVertical=function(){for(var D=this.getSelectionCells(),C=0;C<D.length;C++){var B=b(D[C]),A=this.tableMap(),z=this.cellOrigin(B.get(0),A),y=parseInt(B.attr("colspan"),10)||1,x=parseInt(B.attr("rowspan"),10)||1;if(x>1){var w=Math.floor(x/2),v=z.row+(x-w),u=A[v][z.col-1];u||(u=A[v][z.col+y]),u?b(u).before(B.clone().attr("rowspan",w).html(b.Editable.INVISIBLE_SPACE)):B.parents("tr:first").after(b("<tr>").append(B.clone().attr("rowspan",w).html(b.Editable.INVISIBLE_SPACE))),B.attr("rowspan",x-w)}else{for(var t=b("<tr>").append(B.clone().html(b.Editable.INVISIBLE_SPACE)),s=null,r=0;r<A[z.row].length;r++){var q=A[z.row][r],a=parseInt(b(q).attr("rowspan"),10)||1;s!=q&&q!=B.get(0)&&b(q).attr("rowspan",a+1),s=q}B.parents("tr:first").after(t)}}this.hide(),this.triggerEvent("cellVerticalSplit")},b.Editable.prototype.splitHorizontal=function(){for(var v=this.getSelectionCells(),u=0;u<v.length;u++){var t=b(v[u]),s=this.tableMap(),r=this.cellOrigin(t.get(0),s),q=parseInt(t.attr("colspan"),10)||1;if(q>1){var p=Math.floor(q/2);t.after(t.clone().attr("colspan",p).html(b.Editable.INVISIBLE_SPACE)),t.attr("colspan",q-p)}else{for(var o=null,n=0;n<s.length;n++){var m=s[n][r.col],a=parseInt(b(m).attr("colspan"),10)||1;o!=m&&m!=t.get(0)&&b(m).attr("colspan",a+1),o=m}t.after(t.clone().html(b.Editable.INVISIBLE_SPACE))}}this.hide(),this.triggerEvent("cellHorizontalSplit")},b.Editable.prototype.insertTable=function(a,n){for(var m='<table data-last-table="true" width="100%">',l=0;a>l;l++){m+="<tr>";for(var k=0;n>k;k++){m+="<td>"+b.Editable.INVISIBLE_SPACE+"</td>"}m+="</tr>"}m+="</table>",this.focus();var j=this.getSelectionElement();this.breakHTML(m,this.parents(b(j),"li").length<0);var i=this.$element.find('table[data-last-table="true"]');i.removeAttr("data-last-table"),this.setSelection(i.find("td:first").get(0)),this.hide(),this.triggerEvent("tableInserted")},b.Editable.prototype.deleteTable=function(){var c=this.currentTable();c&&(c.remove(),this.focus(),this.hide(),this.triggerEvent("tableDeleted"))},b.Editable.prototype.cleanupTables=function(){this.$element.find('td[colspan="1"], th[colspan="1"]').each(function(){b(this).removeAttr("colspan")}),this.$element.find('td[rowspan="1"], th[rowspan="1"]').each(function(){b(this).removeAttr("rowspan")})}}(jQuery);